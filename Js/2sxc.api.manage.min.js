/*! ToSic_ToSxc 2015-08-14 */

$2sxc.getManageController=function(a){var b=$(".DnnModule-"+a),c=$.parseJSON(b.find(".Mod2sxcC, .Mod2sxcappC").attr("data-2sxc")).manage,d=c.config;d.returnUrl=window.location.href;var e=c.isEditMode,f=($.ServicesFramework(a),{"default":{icon:"glyphicon-fire",hideFirst:!0,action:function(a,b){alert("not implemented yet")}},edit:{title:"Edit",icon:"glyphicon-pencil",lightbox:!0,hideFirst:!1,action:function(a,b){g._openDialog(a)}},editinline:{title:"Edit inline",icon:"glyphicon-pencil",lightbox:!1,action:function(a,b){alert("not implemented yet")}},"new":{title:"New",icon:"glyphicon-plus",lightbox:!0,hideFirst:!1,action:function(a,b){g._openDialog($.extend({},a,{sortOrder:a.sortOrder+1}))}},add:{title:"Add",icon:"glyphicon-plus",lightbox:!1,hideFirst:!0,action:function(a,b){g._getSelectorScope().addItem(a.sortOrder+1)}},replace:{title:"Replace",icon:"glyphicon-random",lightbox:!1,hideFirst:!0,action:function(a,b){g._openDialog(a)}},publish:{title:"Published",icon:"glyphicon-eye-open disabled",icon2:"glyphicon-eye-close disabled",lightbox:!1,hideFirst:!0,disabled:!0,action:function(a,b){alert("Status: "+(a.isPublished?"published":"not published"))}},moveup:{title:"Move up",icon:"glyphicon-arrow-up",icon2:"glyphicon-arrow-up",lightbox:!1,hideFirst:!0,disabled:!1,action:function(a,b){g._getSelectorScope().changeOrder(a.sortOrder,Math.max(a.sortOrder-1,0))}},movedown:{title:"Move down",icon:"glyphicon-arrow-down",icon2:"glyphicon-arrow-down",lightbox:!1,hideFirst:!0,disabled:!1,action:function(a,b){g._getSelectorScope().changeOrder(a.sortOrder,a.sortOrder+1)}},remove:{title:"remove",icon:"glyphicon-remove-circle",lightbox:!1,hideFirst:!0,disabled:!0,action:function(a,b){confirm("This will remove this content-item from this list, but not delete it (so you can add it again later). \nSee 2sxc.org/help for more. \n\nOk to remove?")&&g._getSelectorScope().removeFromList(a.sortOrder)}},more:{title:"More",icon:"glyphicon-option-horizontal",icon2:"glyphicon-option-vertical",borlightboxder:!1,hideFirst:!1,action:function(a,b){$(b.target).toggleClass(this.icon).toggleClass(this.icon2).closest("ul.sc-menu").toggleClass("showAll")}}}),g={isEditMode:function(){return e},_toolbarConfig:d,_manageInfo:c,getLink:function(a){a=$.extend({},d,a);var b={ctl:"editcontentgroup",mid:a.moduleId,returnUrl:a.returnUrl};return a.cultureDimension&&null!=a.cultureDimension&&(b.cultureDimension=a.cultureDimension),"new"==a.action&&(b.editMode="New"),a.useModuleList?(b.sortOrder=a.sortOrder,b.contentGroupId=a.contentGroupId):("new"!=a.action&&(b.entityId=a.entityId),(a.contentType||a.attributeSetName)&&(b.attributeSetName=a.contentType||a.attributeSetName)),"replace"==a.action&&(b.ctl="settingswrapper",b.ItemType=-1!=a.sortOrder?"Content":"ListContent"),a.prefill&&(b.prefill=JSON.stringify(a.prefill)),a.dialogUrl+(-1==a.dialogUrl.indexOf("?")?"?":"&")+$.param(b)},_openDialog:function(a){var b=g.getLink(a);window.dnnModal&&dnnModal.show?(b+=(-1==b.indexOf("?")?"?":"&")+"popUp=true",dnnModal.show(b,!0,550,950,!0,"")):window.location=b},action:function(a,b){var c=b||window.event,d=f[a.action]||f["default"];g._getSelectorScope().saveTemplateId().then(function(){d.action(a,c)})},getButton:function(b){b.entity&&b.entity._2sxcEditInformation&&(b.entity._2sxcEditInformation.entityId&&(b.entityId=b.entity._2sxcEditInformation.entityId),null!=b.entity._2sxcEditInformation.sortOrder&&(b.sortOrder=b.entity._2sxcEditInformation.sortOrder,b.useModuleList=!0),delete b.entity);var c=f[b.action]||f["default"],d=$("<a />",{"class":"sc-"+b.action+" "+(b.hideFirst||c.hideFirst?"hideFirst":"")+" "+(c.lightbox?"box":""),onclick:"javascript:$2sxc("+a+").manage.action("+JSON.stringify(b)+", event);",title:c.title}),e=$('<span class="glyphicon '+c.icon+'" aria-hidden="true"></span>');return"publish"==b.action&&0==b.isPublished&&(d.toggleClass("hideFirst",!1).attr("title","Unpublished"),e.toggleClass(c.icon,!1).toggleClass(c.icon2,!0)),d.html(e),d[0].outerHTML},getToolbar:function(a){var b=[];a.action?b=[a]:$.isArray(a)?b=a:(b.push($.extend({},a,{action:"edit"})),d.isList&&-1!=a.sortOrder&&(b.push($.extend({},a,{action:"new"})),a.useModuleList&&(b.push($.extend({},a,{action:"add"})),0!=a.sortOrder&&b.push($.extend({},a,{action:"moveup"})),b.push($.extend({},a,{action:"movedown"})))),b.push($.extend({},a,{action:"publish"})),d.isList&&(b.push($.extend({},a,{action:"replace"})),b.push($.extend({},a,{action:"remove"}))),b.push($.extend({},a,{action:"more"})));for(var c="sc-menu"+(-1==a.sortOrder?" listContent":""),e=$("<ul />",{"class":c,onclick:"javascript: var e = arguments[0] || window.event; e.stopPropagation();"}),f=0;f<b.length;f++)e.append($("<li />").append($(g.getButton(b[f]))));return e[0].outerHTML},_processToolbars:function(){$(".sc-menu[data-toolbar]",$(".DnnModule-"+a)).each(function(){var b=$.parseJSON($(this).attr("data-toolbar"));$(this).replaceWith($2sxc(a).manage.getToolbar(b))})},_getSelectorScope:function(){var b=document.querySelector(".DnnModule-"+a+" .sc-selector-wrapper");return angular.element(b).scope().vm}};return g};
//# sourceMappingURL=2sxc.api.manage.min.js.map