"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_metadata_metadata_component_ts","projects_eav-ui_src_app_shared_directives_click-stop-propagation_directive_ts"],{8812:(U,x,a)=>{a.d(x,{l:()=>F});var s=a(7400),d=a(2673),g=a(635),f=a(898),l=a(2847),m=a(9934),h=a(5368),C=a(3184),O=a(8784),Z=a(2425);let F=(()=>{class c{constructor(p,_,I){this.http=p,this.context=_,this.dnnContext=I}getAll(p){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(l.PS),{params:{appId:this.context.appId.toString(),contentType:p}})}getColumns(p){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(f.jt),{params:{appId:this.context.appId.toString(),staticName:p}})}importItem(p){return(0,s.D)((0,m.s)(p)).pipe((0,d.w)(_=>this.http.post(this.dnnContext.$2sxc.http.apiUrl(l.Uo+"upload"),{AppId:this.context.appId.toString(),ContentBase64:_})),(0,g.U)(_=>({Success:_,Messages:[]})))}}return c.\u0275fac=function(p){return new(p||c)(C.LFG(O.eN),C.LFG(h._),C.LFG(Z._y))},c.\u0275prov=C.Yz7({token:c,factory:c.\u0275fac}),c})()},9756:(U,x,a)=>{a.r(x),a.d(x,{MetadataComponent:()=>yt});var s=a(2977),d=a(6317),g=a(7714),f=a(6562),l=a(635),m=a(9337),h=a(116),C=a(4874),O=a(679),Z=a(8812),F=a(4272),c=a(2925),v=a(2087),p=a(4153),_=a(941),I=a(2225),M=a(5758),t=a(3184),y=a(6362),A=a(7317),P=a(1555);function Y(n,r){if(1&n&&(t._UZ(0,"div",5),t.ALo(1,"safeHtml")),2&n){const e=t.oxw();t.Q6J("innerHtml",t.lcZ(1,1,e.dialogData.message),t.oJD)}}let w=(()=>{class n{constructor(e,o){this.dialogData=e,this.dialogRef=o,this.hostClass="dialog-component"}closeDialog(e){this.dialogRef.close(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(M.WI),t.Y36(M.so))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-confirm-delete-dialog"]],hostVars:1,hostBindings:function(e,o){2&e&&t.Ikx("className",o.hostClass)},decls:9,vars:3,consts:[["mat-dialog-title",""],[1,"dialog-title-box"],["class","dialog-component-content fancy-scrollbar-light",3,"innerHtml",4,"ngIf"],[1,"dialog-component-actions"],["mat-raised-button","",3,"click"],[1,"dialog-component-content","fancy-scrollbar-light",3,"innerHtml"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2),t.qZA()(),t.YNc(3,Y,2,3,"div",2),t.TgZ(4,"div",3)(5,"button",4),t.NdJ("click",function(){return o.closeDialog()}),t._uU(6,"Cancel"),t.qZA(),t.TgZ(7,"button",4),t.NdJ("click",function(){return o.closeDialog(!0)}),t._uU(8,"Delete"),t.qZA()()),2&e&&(t.xp6(2),t.AsE("Delete ",o.dialogData.entityTitle," (",o.dialogData.entityId,")?"),t.xp6(1),t.Q6J("ngIf",o.dialogData.message))},directives:[M.uh,y.O5,A.lW],pipes:[P.z],styles:[".dialog-component-content[_ngcontent-%COMP%]{font-size:14px}"]}),n})();var $=a(1130),N=a(6190),S=a(5590);let B=(()=>{class n{agInit(e){this.params=e}refresh(e){return!0}deleteMetadata(){this.params.onDelete(this.params.data)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-metadata-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"like-button","highlight",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.NdJ("click",function(){return o.deleteMetadata()}),t.TgZ(2,"mat-icon"),t._uU(3,"delete"),t.qZA()()())},directives:[$.wG,N.$,S.Hw],styles:[""]}),n})(),H=(()=>{class n{agInit(e){this.value=e.value,this.metadata=e.data}refresh(e){return!0}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-metadata-content-type"]],decls:2,vars:3,consts:[[1,"container",3,"tippy","tippyDisabled"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t._uU(1),t.qZA()),2&e&&(t.Q6J("tippy",o.metadata._Type.Description)("tippyDisabled",!o.metadata._Type.Description),t.xp6(1),t.hij(" ",o.value,"\n"))},directives:[N.$],styles:[".container[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content}"]}),n})();var T=a(587),G=a(8977),L=a(4536),Q=a(2270),k=a(4770),W=a(1434),j=a(8352),V=a(7294),K=a(4683),X=a(6623);function z(n,r){if(1&n&&(t.TgZ(0,"mat-option",21),t._uU(1),t.qZA()),2&n){const e=r.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.name," ")}}function q(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-form-field",7)(2,"mat-label"),t._uU(3,"Scope"),t.qZA(),t.TgZ(4,"mat-select",19),t.YNc(5,z,2,2,"mat-option",20),t.TgZ(6,"mat-option",21),t._uU(7,"Other..."),t.qZA()()(),t.TgZ(8,"app-field-hint"),t._uU(9," The scope should almost never be changed - "),t.TgZ(10,"a",22),t._uU(11,"see help"),t.qZA()(),t.BQk()),2&n){const e=t.oxw().ngIf,o=t.oxw();t.xp6(4),t.Q6J("placeholder",e.scopeOptions.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",e.scopeOptions),t.xp6(1),t.Q6J("value",o.dropdownInsertValue)}}function tt(n,r){if(1&n&&(t.TgZ(0,"mat-option",21),t._uU(1),t.qZA()),2&n){const e=r.$implicit;t.Q6J("value",e.StaticName),t.xp6(1),t.hij(" ",e.Label," ")}}function et(n,r){if(1&n&&(t.TgZ(0,"mat-select",23),t.YNc(1,tt,2,2,"mat-option",20),t.qZA()),2&n){const e=t.oxw().ngIf;t.Q6J("placeholder",e.contentTypes.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",e.contentTypes)}}function nt(n,r){1&n&&t._UZ(0,"input",24)}function ot(n,r){1&n&&(t.TgZ(0,"app-field-hint",25),t._uU(1," This field is required "),t.qZA()),2&n&&t.Q6J("isError",!0)}const R=function(n){return{active:n}};function at(n,r){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",1)(2,"div",2),t._uU(3,"Create Metadata"),t.qZA()(),t.TgZ(4,"p",3),t._uU(5," This is a special operation to add an item which is metadata for another item, see "),t.TgZ(6,"a",4),t._uU(7,"docs"),t.qZA(),t._uU(8,". "),t.qZA(),t.TgZ(9,"form",5)(10,"div",6),t.YNc(11,q,12,3,"ng-container",0),t.TgZ(12,"mat-form-field",7)(13,"mat-label"),t._uU(14,"Content Type"),t.qZA(),t.YNc(15,et,2,2,"mat-select",8),t.YNc(16,nt,1,0,"input",9),t.TgZ(17,"div",10)(18,"button",11),t.NdJ("click",function(){return t.CHM(e),t.oxw().toggleGuidedContentType(!0)}),t.TgZ(19,"mat-icon"),t._uU(20,"search"),t.qZA()(),t.TgZ(21,"button",12),t.NdJ("click",function(){return t.CHM(e),t.oxw().toggleGuidedContentType(!1)}),t.TgZ(22,"mat-icon"),t._uU(23,"text_fields"),t.qZA()()()(),t.YNc(24,ot,2,1,"app-field-hint",13),t.qZA(),t.TgZ(25,"div",14)(26,"mat-slide-toggle",15),t.NdJ("change",function(i){return t.CHM(e),t.oxw().toggleAdvancedMode(i)}),t._uU(27),t.qZA(),t._UZ(28,"div",16),t.TgZ(29,"button",17),t.NdJ("click",function(){return t.CHM(e),t.oxw().closeDialog()}),t._uU(30,"Cancel"),t.qZA(),t.TgZ(31,"button",18),t.NdJ("click",function(){return t.CHM(e),t.oxw().confirm()}),t._uU(32," Confirm "),t.qZA()()(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(9),t.Q6J("formGroup",e.form),t.xp6(2),t.Q6J("ngIf",e.advancedMode&&e.guidedContentType),t.xp6(4),t.Q6J("ngIf",e.guidedContentType),t.xp6(1),t.Q6J("ngIf",!e.guidedContentType),t.xp6(2),t.Q6J("ngClass",t.VKq(10,R,e.guidedContentType)),t.xp6(3),t.Q6J("ngClass",t.VKq(12,R,!e.guidedContentType)),t.xp6(3),t.Q6J("ngIf",e.form.controls.contentType.touched&&(null==e.form.controls.contentType.errors?null:e.form.controls.contentType.errors.required)),t.xp6(2),t.Q6J("checked",e.advancedMode),t.xp6(1),t.hij(" ",e.advancedMode?"Advanced":"Simple"," "),t.xp6(4),t.Q6J("disabled",!e.form.valid)}}let it=(()=>{class n{constructor(e,o){this.dialogRef=e,this.contentTypesService=o,this.hostClass="dialog-component",this.dropdownInsertValue=Q.G,this.guidedContentType=!0,this.advancedMode=!1}ngOnInit(){this.contentTypes$=new d.X([]),this.scopeOptions$=new d.X([]),this.buildForm(),this.fetchScopes(),this.templateVars$=(0,f.a)([this.contentTypes$,this.scopeOptions$]).pipe((0,l.U)(([e,o])=>({contentTypes:e,scopeOptions:o})))}ngOnDestroy(){this.contentTypes$.complete(),this.scopeOptions$.complete()}closeDialog(e){this.dialogRef.close(e)}toggleGuidedContentType(e){this.guidedContentType=e}toggleAdvancedMode(e){this.advancedMode=e.checked}confirm(){const e=this.form.getRawValue();this.closeDialog(e.contentType)}buildForm(){this.form=new T.cw({}),this.form.addControl("contentType",new T.NI(null,[T.kI.required])),this.form.addControl("scope",new T.NI(_.Z.scopes.default.value)),this.form.controls.scope.valueChanges.pipe((0,C.O)(this.form.controls.scope.value),(0,G.x)()).subscribe(e=>{null!=this.form.controls.contentType.value&&this.form.controls.contentType.patchValue(null),e===Q.G?(e=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||_.Z.scopes.default.value,this.scopeOptions$.value.some(o=>o.value===e)||this.scopeOptions$.next([{name:e,value:e},...this.scopeOptions$.value]),this.form.controls.scope.patchValue(e)):this.fetchContentTypes(e)})}fetchContentTypes(e){this.contentTypesService.retrieveContentTypes(e).subscribe(o=>{this.contentTypes$.next(o)})}fetchScopes(){this.contentTypesService.getScopes().subscribe(e=>{this.scopeOptions$.next(e)})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(M.so),t.Y36(L.sF))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-metadata-save-dialog"]],hostVars:1,hostBindings:function(e,o){2&e&&t.Ikx("className",o.hostClass)},decls:2,vars:3,consts:[[4,"ngIf"],["mat-dialog-title",""],[1,"dialog-title-box"],[1,"dialog-description"],["href","http://r.2sxc.org/metadata","target","_blank"],[1,"dialog-form",3,"formGroup"],[1,"dialog-form-content","fancy-scrollbar-light"],["appearance","standard","color","accent"],["formControlName","contentType","required","",3,"placeholder",4,"ngIf"],["matInput","","type","text","formControlName","contentType","required","",4,"ngIf"],["matSuffix","",1,"selection-suffix"],["mat-icon-button","","type","button","tippy","Pick existing value",3,"ngClass","click"],["mat-icon-button","","type","button","tippy","Manual entry",3,"ngClass","click"],[3,"isError",4,"ngIf"],[1,"dialog-form-actions"],["color","accent",3,"checked","change"],[1,"spacer"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],["formControlName","scope",3,"placeholder"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],["formControlName","contentType","required","",3,"placeholder"],["matInput","","type","text","formControlName","contentType","required",""],[3,"isError"]],template:function(e,o){1&e&&(t.YNc(0,at,33,14,"ng-container",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,o.templateVars$))},directives:[y.O5,M.uh,T._Y,T.JL,T.sg,k.KE,k.hX,W.gD,T.JJ,T.u,y.sg,$.ey,j.Y,V.E,T.Q7,K.Nt,T.Fj,k.R9,A.lW,N.$,y.mk,S.Hw,X.Rr],pipes:[y.Ov],styles:[".dialog-form-content[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]:not(:first-of-type){margin-top:8px}"]}),n})();var st=a(2528),rt=a(1350),E=a(7465);function ct(n,r){1&n&&(t.ynx(0),t._uU(1,"This item is not metadata for anything else."),t.BQk())}function lt(n,r){if(1&n&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&n){const e=t.oxw(2).ngIf;t.xp6(2),t.hij("Number: ",e.itemFor.Number,"")}}function pt(n,r){if(1&n&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&n){const e=t.oxw(2).ngIf;t.xp6(2),t.hij("Guid: ",e.itemFor.Guid,"")}}function dt(n,r){if(1&n&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&n){const e=t.oxw(2).ngIf;t.xp6(2),t.hij("String: ",e.itemFor.String,"")}}function mt(n,r){if(1&n&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&n){const e=t.oxw(2).ngIf;t.xp6(2),t.hij("Title: ",e.itemFor.String,"")}}function gt(n,r){if(1&n&&(t.ynx(0),t._uU(1," This item is metadata for: "),t._UZ(2,"br"),t._uU(3),t._UZ(4,"br"),t._uU(5),t.YNc(6,lt,3,1,"ng-container",0),t.YNc(7,pt,3,1,"ng-container",0),t.YNc(8,dt,3,1,"ng-container",0),t.YNc(9,mt,3,1,"ng-container",0),t.BQk()),2&n){const e=t.oxw().ngIf;t.xp6(3),t.hij("Target: ",e.itemFor.Target," "),t.xp6(2),t.hij("TargetType: ",e.itemFor.TargetType," "),t.xp6(1),t.Q6J("ngIf",e.itemFor.Number),t.xp6(1),t.Q6J("ngIf",e.itemFor.Guid),t.xp6(1),t.Q6J("ngIf",e.itemFor.String),t.xp6(1),t.Q6J("ngIf",e.itemFor.Title)}}function _t(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).createMetadata()}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA()()}}function ft(n,r){1&n&&t._UZ(0,"div")}function ut(n,r){if(1&n&&(t._UZ(0,"div",22),t.ALo(1,"safeHtml")),2&n){const e=t.oxw().$implicit;t.Q6J("innerHTML",t.lcZ(1,1,e.Icon),t.oJD)}}function ht(n,r){1&n&&(t.TgZ(0,"mat-icon"),t._uU(1,"add"),t.qZA())}function Ct(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){const u=t.CHM(e).$implicit;return t.oxw(3).createMetadata(u)}),t.YNc(1,ft,1,0,"div",19),t.YNc(2,ut,2,3,"ng-template",null,20,t.W1O),t.YNc(4,ht,2,0,"ng-template",null,21,t.W1O),t.qZA()}if(2&n){const e=r.$implicit,o=t.MAs(3),i=t.MAs(5);t.uIk("label",e.Title),t.xp6(1),t.Q6J("ngIf",e.Icon)("ngIfThen",o)("ngIfElse",i)}}const vt=function(n){return{"fab-opened":n}};function Tt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"eco-fab-speed-dial",12),t.NdJ("openChange",function(i){return t.CHM(e),t.oxw(2).openChange(i)}),t.TgZ(1,"eco-fab-speed-dial-trigger",13)(2,"button",14)(3,"mat-icon",15),t._uU(4),t.qZA()()(),t.TgZ(5,"eco-fab-speed-dial-actions")(6,"button",16),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).createMetadata()}),t.TgZ(7,"mat-icon"),t._uU(8,"search"),t.qZA()(),t.YNc(9,Ct,6,4,"button",17),t.qZA()()}if(2&n){const e=t.oxw().ngIf;t.Q6J("ngClass",t.VKq(4,vt,e.fabOpen)),t.xp6(1),t.Q6J("spin",!0),t.xp6(3),t.Oqu(e.fabOpen?"close":"add"),t.xp6(5),t.Q6J("ngForOf",e.recommendations)}}function xt(n,r){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"div"),t._uU(5),t.qZA(),t.TgZ(6,"button",4),t.NdJ("click",function(){return t.CHM(e),t.oxw().closeDialog()}),t.TgZ(7,"mat-icon"),t._uU(8,"close"),t.qZA()()()(),t.TgZ(9,"p",5),t.YNc(10,ct,2,0,"ng-container",0),t.YNc(11,gt,10,6,"ng-container",0),t.qZA(),t._UZ(12,"router-outlet"),t.TgZ(13,"div",6),t._UZ(14,"ag-grid-angular",7)(15,"div",8),t.YNc(16,_t,3,0,"button",9),t.YNc(17,Tt,10,6,"eco-fab-speed-dial",10),t.qZA()(),t.BQk()}if(2&n){const e=r.ngIf,o=t.oxw();t.xp6(5),t.Oqu(o.title||"Metadata"),t.xp6(5),t.Q6J("ngIf",!e.itemFor),t.xp6(1),t.Q6J("ngIf",e.itemFor),t.xp6(3),t.Q6J("rowData",e.metadata)("gridOptions",o.gridOptions),t.xp6(2),t.Q6J("ngIf",0===e.recommendations.length),t.xp6(1),t.Q6J("ngIf",e.recommendations.length>0)}}let yt=(()=>{class n{constructor(e,o,i,u,b,D,Mt,bt,It,Dt){var J;this.dialogRef=e,this.router=o,this.route=i,this.metadataService=u,this.snackBar=b,this.entitiesService=D,this.contentItemsService=Mt,this.dialog=bt,this.viewContainerRef=It,this.changeDetectorRef=Dt,this.gridOptions=this.buildGridOptions(),this.metadata$=new d.X([]),this.recommendations$=new d.X([]),this.itemFor$=new d.X(void 0),this.fabOpen$=new d.X(!1),this.subscription=new g.w0,this.targetType=parseInt(this.route.snapshot.paramMap.get("targetType"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.title=decodeURIComponent(null!==(J=this.route.snapshot.paramMap.get("title"))&&void 0!==J?J:""),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName")}ngOnInit(){this.fetchFor(),this.fetchMetadata(),this.refreshOnChildClosed();const e=(0,f.a)([this.metadata$,this.recommendations$]).pipe((0,l.U)(([o,i])=>i.filter(u=>o.filter(b=>b._Type.Id===u.Id).length<u.Count)));this.templateVars$=(0,f.a)([this.metadata$,e,this.itemFor$,this.fabOpen$]).pipe((0,l.U)(([o,i,u,b])=>({metadata:o,recommendations:i,itemFor:u,fabOpen:b})))}ngOnDestroy(){this.metadata$.complete(),this.recommendations$.complete(),this.itemFor$.complete(),this.fabOpen$.complete(),this.subscription.unsubscribe()}closeDialog(){this.dialogRef.close()}openChange(e){this.fabOpen$.next(e)}createMetadata(e){e?e.CreateEmpty?(this.snackBar.open(`Creating ${e.Name}...`),this.entitiesService.create(e.Id,{For:this.calculateItemFor()}).subscribe({error:()=>{this.snackBar.open(`Creating ${e.Name} failed. Please check console for more info`,void 0,{duration:3e3}),this.fetchMetadata()},next:()=>{this.snackBar.open(`Created ${e.Name}`,void 0,{duration:3e3}),this.fetchMetadata()}})):this.createMetadataForm(e.Id):this.dialog.open(it,{autoFocus:!1,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(i=>{null!=i&&this.createMetadataForm(i)})}createMetadataForm(e){const o={items:[{ContentTypeName:e,For:this.calculateItemFor()}]},i=(0,I.f)(o);this.router.navigate([`edit/${i}`],{relativeTo:this.route}),this.changeDetectorRef.markForCheck()}calculateItemFor(){var e,o;return Object.assign(Object.assign(Object.assign({Target:null!==(o=null===(e=Object.values(_.Z.metadata).find(u=>u.targetType===this.targetType))||void 0===e?void 0:e.target)&&void 0!==o?o:this.targetType.toString(),TargetType:this.targetType},this.keyType===_.Z.keyTypes.guid&&{Guid:this.key}),this.keyType===_.Z.keyTypes.number&&{Number:parseInt(this.key,10)}),this.keyType===_.Z.keyTypes.string&&{String:this.key})}fetchFor(){!this.contentTypeStaticName||this.contentItemsService.getAll(this.contentTypeStaticName).subscribe(e=>{const o=e.find(i=>i.Guid===this.key);(null==o?void 0:o.For)&&this.itemFor$.next(o.For)})}fetchMetadata(){this.metadataService.getMetadata(this.targetType,this.keyType,this.key).pipe((0,l.U)(e=>(e.Recommendations.forEach(o=>{o.Icon.startsWith("base64:")&&(o.Icon=o.Icon.replace("base64:",""),o.Icon=window.atob(o.Icon))}),e)),(0,m.b)(e=>{this.metadata$.next(e.Items),this.recommendations$.next(e.Recommendations)})).subscribe()}editMetadata(e){const i=(0,I.f)({items:[{EntityId:e.Id}]});this.router.navigate([`edit/${i}`],{relativeTo:this.route})}deleteMetadata(e,o=!1){var i;if(o)this.snackBar.open("Deleting..."),this.entitiesService.delete(e._Type.Id,e.Id,!1).subscribe({next:()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchMetadata()},error:()=>{this.snackBar.open("Delete failed. Please check console for more information",null,{duration:3e3})}});else{const u={entityId:e.Id,entityTitle:e.Title,message:null===(i=this.recommendations$.value.find(D=>D.Id===e._Type.Id))||void 0===i?void 0:i.DeleteWarning};this.dialog.open(w,{autoFocus:!1,data:u,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(D=>{D&&this.deleteMetadata(e,!0)})}}refreshOnChildClosed(){this.subscription.add(this.router.events.pipe((0,h.h)(e=>e instanceof s.m2),(0,C.O)(!!this.route.snapshot.firstChild),(0,l.U)(()=>!!this.route.snapshot.firstChild),(0,O.G)(),(0,h.h)(([e,o])=>e&&!o)).subscribe(()=>{this.fetchMetadata()}))}buildGridOptions(){return Object.assign(Object.assign({},p.f),{columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline".split(" "),sortable:!0,filter:"agNumberColumnFilter",valueGetter:o=>o.data.Id,cellRenderer:v.m,cellRendererParams:{tooltipGetter:i=>`ID: ${i.Id}\nGUID: ${i.Guid}`}},{field:"Title",flex:2,minWidth:250,cellClass:"primary-action highlight".split(" "),sortable:!0,sort:"asc",filter:"agTextColumnFilter",valueGetter:o=>o.data.Title,onCellClicked:o=>{this.editMetadata(o.data)}},{headerName:"Content Type",field:"ContentType",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:o=>{const i=o.data;return`${i._Type.Name}${i._Type.Title!==i._Type.Name?` (${i._Type.Title})`:""}`},cellRenderer:H},{width:42,cellClass:"secondary-action no-padding".split(" "),pinned:"right",cellRenderer:B,cellRendererParams:(()=>({onDelete:i=>this.deleteMetadata(i)}))()}]})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(M.so),t.Y36(s.F0),t.Y36(s.gz),t.Y36(c.Do),t.Y36(st.ux),t.Y36(F.g),t.Y36(Z.l),t.Y36(M.uw),t.Y36(t.s_b),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-metadata"]],decls:2,vars:3,consts:[[4,"ngIf"],[1,"nav-component-wrapper"],["mat-dialog-title",""],[1,"dialog-title-box"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"dialog-description"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],[1,"grid-more-actions-box"],["mat-fab","","mat-elevation-z24","","class","grid-fab","tippy","Create a new metadata for this item",3,"click",4,"ngIf"],["class","grid-fab",3,"ngClass","openChange",4,"ngIf"],["mat-fab","","mat-elevation-z24","","tippy","Create a new metadata for this item",1,"grid-fab",3,"click"],[1,"grid-fab",3,"ngClass","openChange"],[3,"spin"],["mat-fab",""],[1,"spin180"],["mat-mini-fab","","label","Other Content Type",3,"click"],["mat-mini-fab","",3,"click",4,"ngFor","ngForOf"],["mat-mini-fab","",3,"click"],[4,"ngIf","ngIfThen","ngIfElse"],["svgIcon",""],["matIcon",""],[3,"innerHTML"]],template:function(e,o){1&e&&(t.YNc(0,xt,18,7,"ng-container",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,o.templateVars$))},directives:[y.O5,M.uh,A.lW,N.$,S.Hw,s.lC,rt.N8,E.W7,y.mk,E.YI,E.Lp,y.sg],pipes:[y.Ov,P.z],styles:["[_nghost-%COMP%]     .mat-button-wrapper div svg *:not([fill]){fill:#fff}"]}),n})()},8352:(U,x,a)=>{a.d(x,{Y:()=>F});var s=a(3184),d=a(6362),g=a(4770);function f(c,v){1&c&&s.GkF(0)}function l(c,v){if(1&c&&(s.TgZ(0,"mat-hint"),s.YNc(1,f,1,0,"ng-container",3),s.qZA()),2&c){s.oxw();const p=s.MAs(4);s.xp6(1),s.Q6J("ngTemplateOutlet",p)}}function m(c,v){1&c&&s.GkF(0)}function h(c,v){if(1&c&&(s.TgZ(0,"mat-error"),s.YNc(1,m,1,0,"ng-container",3),s.qZA()),2&c){s.oxw();const p=s.MAs(4);s.xp6(1),s.Q6J("ngTemplateOutlet",p)}}function C(c,v){1&c&&s.Hsn(0)}const O=function(c){return{"hint-box__short":c}},Z=["*"];let F=(()=>{class c{constructor(){this.isError=!1,this.isShort=!0}toggleIsShort(){this.isShort=!this.isShort}}return c.\u0275fac=function(p){return new(p||c)},c.\u0275cmp=s.Xpm({type:c,selectors:[["app-field-hint"]],inputs:{isError:"isError"},ngContentSelectors:Z,decls:5,vars:6,consts:[[1,"hint-box",3,"ngClass","ngSwitch","click"],[4,"ngSwitchCase"],["content",""],[4,"ngTemplateOutlet"]],template:function(p,_){1&p&&(s.F$t(),s.TgZ(0,"div",0),s.NdJ("click",function(){return _.toggleIsShort()}),s.YNc(1,l,2,1,"mat-hint",1),s.YNc(2,h,2,1,"mat-error",1),s.qZA(),s.YNc(3,C,1,0,"ng-template",null,2,s.W1O)),2&p&&(s.Q6J("ngClass",s.VKq(4,O,_.isShort))("ngSwitch",_.isError),s.xp6(1),s.Q6J("ngSwitchCase",!1),s.xp6(1),s.Q6J("ngSwitchCase",!0))},directives:[d.mk,d.RF,d.n9,g.bx,d.tP,g.TO],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]}),c})()},7294:(U,x,a)=>{a.d(x,{E:()=>d});var s=a(3184);let d=(()=>{class g{onClick(l){l.stopPropagation()}}return g.\u0275fac=function(l){return new(l||g)},g.\u0275dir=s.lG2({type:g,selectors:[["","appClickStopPropagation",""]],hostBindings:function(l,m){1&l&&s.NdJ("click",function(C){return m.onClick(C)})}}),g})()},9934:(U,x,a)=>{function s(g){return new Promise((f,l)=>{const m=new FileReader;m.readAsDataURL(g),m.onload=()=>{f(m.result.split(",")[1])},m.onerror=h=>{l(h)}})}function d(g){return new Promise((f,l)=>{const m=new FileReader;m.readAsText(g),m.onload=()=>{f(m.result)},m.onerror=h=>{l(h)}})}a.d(x,{B:()=>d,s:()=>s})}}]);
//# sourceMappingURL=https://sources.2sxc.org/14.12.00/ng-edit/projects_eav-ui_src_app_metadata_metadata_component_ts.6aaf03636c07f2cc.js.map