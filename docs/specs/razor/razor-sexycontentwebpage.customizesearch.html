<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Event CustomizeSearch() on the Razor Page | 2sxc and EAV 10 </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Event CustomizeSearch() on the Razor Page | 2sxc and EAV 10 ">
    <meta name="generator" content="docfx 2.46.0.0">
    
    <link rel="shortcut icon" href="../../images/logos/favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../images/logos/2sxc-10-50.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
                
                <ul class="nav level1 navbar-nav">
                      <li>
                          <a href="../../articles/intro.html" title="Articles">Articles</a>
                      </li>
                      <li>
                          <a href="../../specs/index.html" title="Specs">Specs</a>
                      </li>
                      <li>
                          <a href="../../api/dot-net/index.html" title=".net API">.net API</a>
                      </li>
                </ul>    </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div>
              <div class="sidefilter">
                <form class="toc-filter">
                  <span class="glyphicon glyphicon-filter filter-icon"></span>
                  <input type="text" id="toc_filter_input" placeholder="Enter here to filter..." onkeypress="if(event.keyCode==13) {return false;}">
                </form>
              </div>
              <div class="sidetoc">
                <div class="toc" id="toc">
                  
                  <ul class="nav level1">
                    <li class="">
                      <a href="../index.html" title="Introduction" class="">Introduction</a>
                    </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">EAV Internals</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="../architecture/architecture.html" title="Architecture" class="">Architecture</a>
                          </li>
                          <li class="">
                            <a href="../architecture/eav-core-data.html" title="EAV Data Models" class="">EAV Data Models</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">EAV DataSources</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="../datasources/datasource.html" title="DataSource Basics" class="">DataSource Basics</a>
                          </li>
                          <li class="">
                            <a href="../datasources/datastream.html" title="DataStream Basics" class="">DataStream Basics</a>
                          </li>
                          <li class="">
                            <a href="../datasources/list-all.html" title="All DataSources" class="">All DataSources</a>
                          </li>
                          <li class="">
                            <a href="../datasources/create-custom.html" title="Create Custom DataSource" class="">Create Custom DataSource</a>
                          </li>
                          <li class="">
                            <a href="../datasources/configuration.html" title="Configuration System" class="">Configuration System</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Data & Input Types</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="../data-types/_overview.html" title="Data Types" class="">Data Types</a>
                          </li>
                          <li class="">
                            <a href="../input-types/_inputs-overview.html" title="Input Types" class="">Input Types</a>
                          </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="../data-formats/format-json-v1.html" title="Json Format" class="">Json Format</a>
                              
                              <ul class="nav level3">
                                <li class="">
                                  <a href="../data-formats/format-json-v1-entity.html" title="Json Entity" class="">Json Entity</a>
                                </li>
                                <li class="">
                                  <a href="../data-formats/format-json-v1-content-type.html" title="Json ContentType" class="">Json ContentType</a>
                                </li>
                              </ul>  </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Razor</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a class="">Todo all</a>
                          </li>
                        </ul>  </li>
                  </ul>        </div>
              </div>
            </div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="event-customizesearch-on-the-razor-page">Event <em>CustomizeSearch()</em> on the Razor Page</h1>

<h2 id="purpose--description">Purpose / Description</h2>
<p>This event is called by the view-engine <em>after</em> calling <a href="Razor-SexyContentWebPage.CustomizeData">CustomizeData</a> and before passing the <code>Data</code> object to the DNN Search Indexer. </p>
<p>You can override this event to change how data is presented to the search, for example by bundling items together, or by giving items different URLs so that search knows that they are to appear on a sub-page. </p>
<h2 id="how-to-use">How to use</h2>
<p>In your razor page (.cshtml file) you can add a script block implementing this, as follows:</p>
<pre><code class="lang-c#">@functions
{
    // this method is optional - your code wouldn&#39;t need it, but it&#39;s in here to show how it would work together
    // the CustomizeData would be called first, and potentially modify what is in the Data-object
    public override void CustomizeData()
    {
        // Don&#39;t customize anything, nothing to customize in this case
    }

    /// &lt;summary&gt;
    /// Populate the search - ensure that each entity has an own url/page
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;searchInfos&quot;&gt;&lt;/param&gt;
    /// &lt;param name=&quot;moduleInfo&quot;&gt;&lt;/param&gt;
    /// &lt;param name=&quot;startDate&quot;&gt;&lt;/param&gt;
    public override void CustomizeSearch(Dictionary&lt;string, List&lt;ToSic.SexyContent.Search.ISearchInfo&gt;&gt; searchInfos, DotNetNuke.Entities.Modules.ModuleInfo moduleInfo, DateTime startDate)
    {
        foreach (var si in searchInfos[&quot;Default&quot;])
        {
            si.QueryString = &quot;mid=&quot;+ moduleInfo.ModuleID + &quot;&amp;feature=&quot; + si.Entity.EntityId;
        }
    }
}
</code></pre><p>The code above will skip customizing any data (but often you would want that too), then CustomizeSearch modifies the list of search-items before they are indexed. </p>
<h2 id="how-it-works">How it works</h2>
<p>In general everything will work automatically. This is what happens:</p>
<ol>
<li>2sxc will retrieve the data added to this module</li>
<li>2sxc will call the <a href="Razor-SexyContentWebPage.CustomizeData">CustomizeData()</a> event if the template has such an event. In this event, your code can add more data to the module as needed.<ol>
<li>Note that during the search index, no Request-variables exist.</li>
<li>So your method will cause an error if it does something like var x = Request[&quot;Category&quot;].</li>
<li>In case of an error, the index will still continue to work, but your changes to the data will fail</li>
<li>To help you with this, a new property called InstancePurpose was added. It tells you if this view/template was created for displaying or for indexing.</li>
</ol>
</li>
<li>2sxc will then use the data and create SearchItems, ready to index.<ol>
<li>Each entity will be turned into a SearchItem</li>
<li>Each Content-Type will have an own list (so you can differentiate between all the SearchItems for the Categories and the SearchItems for the Questions)</li>
<li>Multi-Language is handled correctly, so the English index will contain the English content, etc.</li>
</ol>
</li>
<li>2sxc will then call a CustomizeSearch() event, so your code could provide changes.<ol>
<li>A common scenario is to say that each entity (say each question) has a different URL (say a details-page).</li>
<li>So even though all entities belong to the module (and DNN only knows of this one module), the module can say that each entity has an own details page.</li>
</ol>
</li>
<li>One this is done, the SearchItems are converted to official SearchDocument-objects and handed over to DNN</li>
</ol>
<h2 id="read-also">Read also</h2>
<ul>
<li><a href="Razor-SexyContentWebPage.InstancePurpose">InstancePurpose</a> - which tells you why the current code is running so you could change the data added</li>
<li><a href="Razor-SexyContentWebPage.CustomizeData">CustomizeData</a></li>
</ul>
<h2 id="demo-app-and-further-links">Demo App and further links</h2>
<p>You should find some code examples in this demo App</p>
<ul>
<li><a href="http://2sxc.org/en/apps/app/faq-with-categories-and-6-views">FAQ with Categories</a></li>
</ul>
<p>More links: <a href="http://2sxc.org/en/Docs-Manuals/Feature/feature/2683">Description of the feature on 2sxc docs</a></p>
<h2 id="history">History</h2>
<ol>
<li>Introduced in 2sxc 6.2</li>
<li>Added support for newer DNN versions at a later time - not sure when</li>
</ol>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/2sic/2sxc/blob/docs-wiki/ToSIC_SexyContent/Docs-Generator/specs/razor/razor-sexycontentwebpage.customizesearch.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
