/*! tosic.eav 2015-10-27 08:32 */

!function(){"use strict";var a=angular.module("ToSicEavCustomGps",["uiGmapgoogle-maps"]);a.config(["formlyConfigProvider","defaultFieldWrappers",function(a,b){a.setType({name:"custom-gps",templateUrl:"fields/custom-gps/custom-gps.html",wrapper:b,controller:"FieldTemplate-CustomGpsController"})}]),a.config(["uiGmapGoogleMapApiProvider",function(a){a.configure({})}]),a.controller("FieldTemplate-CustomGpsController",["$scope","$filter","$modal","appId","debugState","eavAdminDialogs","addtemplatestocache",function(a,b,c,d,e,f,g){var h,i,j=a.to.settings["custom-gps"];j&&(h=j.LatField||null,i=j.LongField||null);var k=!j||!j.AddressMask||""===j.AdressMask,l={latitude:47.1747363,longitude:9.4671813};a.position=angular.extend({},l),a.$watch("position",function(){a.value&&(a.value.Value=JSON.stringify(a.position))}),a.map={center:angular.extend({},l),zoom:15},a.marker={position:a.position,options:{draggable:!0},events:{dragend:function(b){h&&a.model.hasOwnProperty(h)&&null!==a.model[h]&&(a.model[h]._currentValue.Value=a.marker.position.latitude),i&&a.model.hasOwnProperty(i)&&null!==a.model[i]&&(a.model[i]._currentValue.Value=a.marker.position.longitude)}}},h&&a.$watch('model["'+h+'"]._currentValue.Value',function(b,c){a.marker.position.latitude=b,a.map.center.latitude=b}),i&&a.$watch('model["'+i+'"]._currentValue.Value',function(b,c){a.marker.position.longitude=b,a.map.center.longitude=b}),a.formattedAddress=function(){return k?j.AddressMask:""},a.autoSelect=function(){k&&alert(j.AddressMask)},a.debug=e}]),a.service("addtemplatestocache",["$templateCache",function(a){a.put("fields/custom-gps/custom-gps.html","<div><a class='btn btn-default' ng-click='autoSelect'>Auto-select from address</a><ui-gmap-google-map center='map.center' zoom='map.zoom'><ui-gmap-marker idkey='\"mapMarker1\"' coords='marker.position' options='marker.options' events='marker.events'></ui-gmap-marker></ui-gmap-google-map><div><div ng-if=\"debug.on\"><h4>debug info</h4><div>lat field name: '{{latField}}' lng field name: '{{longField}}'<br><pre>{{value | json}}</pre></div></div></div></div>")}])}();
//# sourceMappingURL=custom-gps.min.js.map