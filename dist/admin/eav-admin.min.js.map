{"version":3,"sources":["/source/eav-admin.min.js","eav-admin.min.js"],"names":["angular","get","contentExportController","appId","contentType","contentExportService","eavAdminDialogs","eavConfig","languages","$modalInstance","$filter","$translate","vm","this","formValues","formFields","key","type","defaultValue","defaultLanguage","expressionProperties","templateOptions.label","templateOptions.options","options","name","instant","value","forEach","lang","langCode","push","templateOptions.disabled","RecordExport","exportContent","close","dismiss","$inject","module","controller","$http","args","url","getUrlPrefix","window","open","AppId","Language","DefaultLanguage","ContentType","ResourcesReferences","LanguageReferences","srvc","factory","config","formlyConfigProvider","formly","setType","template","wrapper","filter","str","length","substring","toLowerCase","toUpperCase","contentImportController","contentImportService","debugState","debug","templateOptions","required","viewStates","Waiting","Default","Evaluated","Imported","viewStateSelected","evaluationResult","importResult","evaluateContent","then","result","data","importContent","reset","back","post","ContentBase64","File","base64","ClearEntities","EditContentItemController","mode","entityId","TestMessage","history","openItemHistory","contentItemsListController","contentItemsSvc","$q","$modalStack","activate","svc","all","setRowData","getColumns","success","columnDefs","getColumnDefs","gridOptions","api","setColumnDefs","bodyWidth","gridPanel","eBodyContainer","clientWidth","viewportWidth","eBodyViewport","setModalWidth","width","modalDomEl","getTop","modalDialog","children","css","add","openItemNew","openEditDialog","params","openItemEditWithEntityId","Id","sortModel","filterModel","getSortModel","getFilterModel","liveListSourceRead","setSortModel","setFilterModel","eavAttributes","staticColumns","eavAttribute","IsTitle","colDef","headerName","StaticName","field","cellRenderer","cellRendererDefault","filterParams","cellRendererDefaultFilter","Type","allowMultiValue","Metadata","Entity","AllowMultiValue","e","cellRendererEntity","valueGetter","valueGetterEntityField","useTimePicker","DateTime","UseTimePicker","valueGetterDateTime","valueGetterBoolean","rawValue","map","item","Title","valueGetterStatusField","IsPublished","substr","replace","toString","encodedValue","htmlEncode","text","Array","isArray","join","tryToDelete","confirm","RepositoryId","openDuplicate","items","ContentTypeName","DuplicateEntity","openEditItems","liveListReload","extend","enableSorting","enableFilter","rowHeight","colWidth","headerHeight","angularCompileRows","refresh","cellClass","onCellClicked","suppressSorting","suppressMenu","ContentItemsListController","maxDynamicColumns","edit","liveList","dynamicColumns","cols","c","HistoryController","historySvc","$modal","details","animation","templateUrl","controllerAs","resolve","changeId","ChangeId","dataSvc","HistoryDetailsController","alert","getVersionDetails","constant","createdBy","license","contentTypeEditController","contentTypeSvc","ChangeStaticName","NewStaticName","ok","save","contentTypeFieldEditController","types","allInputTypes","getInputTypesList","resetSubTypes","InputType","updateInputType","contentTypeFieldsAddController","nw","newItem","newList","addMany","contentTypeFieldListController","contentTypeFieldSvc","size","inputTypeTooltip","inputType","moveUp","moveDown","setTitle","target","translations","msg","createOrEditMetadata","metadataType","createItemDefinition","title","undefined","EntityId","Key","KeyType","TargetType","metadataOfAttribute","Prefill","Name","contentTypeListController","openContentTypeEdit","createGhost","sourceName","prompt","editFields","openContentTypeFields","editItems","openContentItems","addItem","liveEval","admin","inp","eval","changeScope","setScope","isGuid","txtToTest","patt","RegExp","test","permissions","openPermissionsForGuid","openExport","openContentExport","openImport","openContentImport","directive","restrict","transclude","link","scope","elem","attrs","icn","icon","addClass","element","attr","stopEvent","bind","stopPropagation","permissionListController","permissionsSvc","targetGuid","openMetadataNew","PermissionTargetGuid","ctName","$timeout","makeDataSource","dataSource","$last","$emit","input","format","globalParts","match","classFullName","getElementOffset","de","document","documentElement","box","getBoundingClientRect","top","pageYOffset","clientTop","left","pageXOffset","clientLeft","pipelineId","$scope","pipelineService","$location","ctrlS","toastrWithHttpErrorHandling","$log","saveShortcut","savePipeline","toastr","waitMsg","info","readOnly","dataSourcesCount","dataSourceIdPrefix","PipelineEntityId","setAppId","findDataSourceOfElement","guid","attributes","list","pipelineData","DataSources","found","EntityGuid","getPipeline","Pipeline","AllowEdit","clear","autoDismiss","initNewPipeline","reason","error","jsPlumb","ready","jsPlumbInstance","getInstance","Connector","curviness","HoverPaintStyle","lineWidth","strokeStyle","outlineWidth","outlineColor","PaintStyle","joinstyle","Container","targetId","fixedEndpoints","Definition","In","label","targetEndpoint","getOverlay","indexOf","deleteEndpoint","connectionsInitialized","repeatCount","endpointHandling","endpoint","getLabel","labelPrompt","id","canvas","hasClass","targetEndpointHavingSameLabel","promptMessage","endpointLabel","setLabel","endpoints","getEndpoints","getEndpointOverlays","isSource","location","cssClass","events","dblclick","labelOverlay","newLabel","sourceEndpoint","paintStyle","fillStyle","radius","maxConnections","anchor","faces","overlays","isTarget","dropOptions","hoverClass","activeClass","batch","draggable","grid","drag","dataSourceDrag","dataSourceDefinition","Out","addEndpoint","targetEndpointUnlimited","makeTarget","makeSource","isIn","message","selector","console","log","uuid","enabled","ReadOnly","endPoint","$on","initWirings","StreamWiring","repaint","streamWiring","wire","sourceElementId","From","fromUuid","targetElementId","To","toUuid","getEndpoint","getSelector","connect","uuids","from","to","templateForNew","pipelineDesigner","defaultPipeline","dataSources","addDataSource","partAssemblyAndType","visualDesignerData","entityGuid","initWiringsListener","autoSave","addDataSourceType","PartAssemblyAndType","Top","Left","newDataSource","VisualDesignerData","Description","getNewDataSource","remove","index","elementId","selectEndpoints","splice","editName","newName","trim","editDescription","newDescription","draggedWrapper","offset","el","$apply","Math","round","configureDataSource","dataSourceIsPersisted","editDataSourcePart","showEndpointOverlays","toggleEndpointOverlays","showOverlays","hideOverlays","editPipelineEntity","unbind","pipelineSaved","rebind","syncPipelineData","connectionInfos","getAllConnections","connection","sourceId","streamsOut","each","StreamsOut","successHandler","deferred","defer","reject","promise","search","postProcessDataSources","repaintEverything","toogleDebug","queryPipeline","query","CreateResolve","testParams","TestParameters","OpenModal","showEntityCountOnStreams","Streams","stream","Source","Target","SourceOut","TargetIn","streamFound","connections","getUuid","Count","clonePipeline","clone","getClonePipeline","pipelines","getPipelines","pipeline","deletePipeline","Guid","testParameters","design","editPipeline","split","timeUsed","QueryTimer","Milliseconds","ticksUsed","Ticks","Query","sources","Sources","streams","entitiesSvc","metadataSvc","svcCreator","implementLiveList","appid","staticName","defaultScope","retrieveContentTypes","getDetails","contentTypeName","contentTypeStaticName","Scope","newScope","sourceStaticName","typeListRetrieve","_inputTypesList","addToList","dataType","Label","description","getFields","i","fld","md","allMd","All","typeMd","inputMd","merged","merge","contentTypeId","attributeId","direction","count","newItemCount","ContentTypeId","SortOrder","$window","createSave","action","_event","_action","_isbound","detectCtrlSAndExcecute","keyCode","navigator","platform","metaKey","ctrlKey","preventDefault","addEventListener","removeEventListener","on","toggle","toast","timeOut","autoEnableAsNeeded","event","ctrlPressed","alreadySwitchedDebugState","body","classList","itemId","closeCallback","openContentTypeFieldsOfItems","getManyForEditing","Header","svcForThis","result2","targetType","metadata","metadataOfEntity","derivedUrl","dialog","varsToReplace","href","prop","hasOwnProperty","replaceOrAddOneParam","original","param","rule","newText","_attachCallbacks","callbacks","notify","resolveValues","foundAs","contAs","modalInstance","fns","arguments","_create1Resolve","$locationProvider","html5Mode","requireBase","service","iconPrefix","defaultIcon","checkImgRegEx","extensions","doc","docx","xls","xlsx","ppt","pptx","pdf","mp3","avi","mpg","mpeg","mov","mp4","zip","rar","txt","html","xml","xsl","vcf","getExtension","filename","lastIndexOf","getIconClass","isKnownType","isImage","VirtualVersion","$translateProvider","$translatePartialLoaderProvider","preferredLanguage","currentLanguage","useSanitizeValueStrategy","fallbackLanguage","useLoader","urlTemplate","i18nRoot","useLoaderCache","addPart","run","$rootScope","getParameterByName","$2sxc","urlParams","getParameterByNameDuplicate","searchRx","results","exec","hashRx","hash","matches","pathname","reverse","decodeURIComponent","latinMap","Á","Ă","Ắ","Ặ","Ằ","Ẳ","Ẵ","Ǎ","Â","Ấ","Ậ","Ầ","Ẩ","Ẫ","Ä","Ǟ","Ȧ","Ǡ","Ạ","Ȁ","À","Ả","Ȃ","Ā","Ą","Å","Ǻ","Ḁ","Ⱥ","Ã","Ꜳ","Æ","Ǽ","Ǣ","Ꜵ","Ꜷ","Ꜹ","Ꜻ","Ꜽ","Ḃ","Ḅ","Ɓ","Ḇ","Ƀ","Ƃ","Ć","Č","Ç","Ḉ","Ĉ","Ċ","Ƈ","Ȼ","Ď","Ḑ","Ḓ","Ḋ","Ḍ","Ɗ","Ḏ","ǲ","ǅ","Đ","Ƌ","Ǳ","Ǆ","É","Ĕ","Ě","Ȩ","Ḝ","Ê","Ế","Ệ","Ề","Ể","Ễ","Ḙ","Ë","Ė","Ẹ","Ȅ","È","Ẻ","Ȇ","Ē","Ḗ","Ḕ","Ę","Ɇ","Ẽ","Ḛ","Ꝫ","Ḟ","Ƒ","Ǵ","Ğ","Ǧ","Ģ","Ĝ","Ġ","Ɠ","Ḡ","Ǥ","Ḫ","Ȟ","Ḩ","Ĥ","Ⱨ","Ḧ","Ḣ","Ḥ","Ħ","Í","Ĭ","Ǐ","Î","Ï","Ḯ","İ","Ị","Ȉ","Ì","Ỉ","Ȋ","Ī","Į","Ɨ","Ĩ","Ḭ","Ꝺ","Ꝼ","Ᵹ","Ꞃ","Ꞅ","Ꞇ","Ꝭ","Ĵ","Ɉ","Ḱ","Ǩ","Ķ","Ⱪ","Ꝃ","Ḳ","Ƙ","Ḵ","Ꝁ","Ꝅ","Ĺ","Ƚ","Ľ","Ļ","Ḽ","Ḷ","Ḹ","Ⱡ","Ꝉ","Ḻ","Ŀ","Ɫ","ǈ","Ł","Ǉ","Ḿ","Ṁ","Ṃ","Ɱ","Ń","Ň","Ņ","Ṋ","Ṅ","Ṇ","Ǹ","Ɲ","Ṉ","Ƞ","ǋ","Ñ","Ǌ","Ó","Ŏ","Ǒ","Ô","Ố","Ộ","Ồ","Ổ","Ỗ","Öe","Ȫ","Ȯ","Ȱ","Ọ","Ő","Ȍ","Ò","Ỏ","Ơ","Ớ","Ợ","Ờ","Ở","Ỡ","Ȏ","Ꝋ","Ꝍ","Ō","Ṓ","Ṑ","Ɵ","Ǫ","Ǭ","Ø","Ǿ","Õ","Ṍ","Ṏ","Ȭ","Ƣ","Ꝏ","Ɛ","Ɔ","Ȣ","Ṕ","Ṗ","Ꝓ","Ƥ","Ꝕ","Ᵽ","Ꝑ","Ꝙ","Ꝗ","Ŕ","Ř","Ŗ","Ṙ","Ṛ","Ṝ","Ȑ","Ȓ","Ṟ","Ɍ","Ɽ","Ꜿ","Ǝ","Ś","Ṥ","Š","Ṧ","Ş","Ŝ","Ș","Ṡ","Ṣ","Ṩ","Ť","Ţ","Ṱ","Ț","Ⱦ","Ṫ","Ṭ","Ƭ","Ṯ","Ʈ","Ŧ","Ɐ","Ꞁ","Ɯ","Ʌ","Ꜩ","Ú","Ŭ","Ǔ","Û","Ṷ","Ü","Ǘ","Ǚ","Ǜ","Ǖ","Ṳ","Ụ","Ű","Ȕ","Ù","Ủ","Ư","Ứ","Ự","Ừ","Ử","Ữ","Ȗ","Ū","Ṻ","Ų","Ů","Ũ","Ṹ","Ṵ","Ꝟ","Ṿ","Ʋ","Ṽ","Ꝡ","Ẃ","Ŵ","Ẅ","Ẇ","Ẉ","Ẁ","Ⱳ","Ẍ","Ẋ","Ý","Ŷ","Ÿ","Ẏ","Ỵ","Ỳ","Ƴ","Ỷ","Ỿ","Ȳ","Ɏ","Ỹ","Ź","Ž","Ẑ","Ⱬ","Ż","Ẓ","Ȥ","Ẕ","Ƶ","Ĳ","Œ","ᴀ","ᴁ","ʙ","ᴃ","ᴄ","ᴅ","ᴇ","ꜰ","ɢ","ʛ","ʜ","ɪ","ʁ","ᴊ","ᴋ","ʟ","ᴌ","ᴍ","ɴ","ᴏ","ɶ","ᴐ","ᴕ","ᴘ","ʀ","ᴎ","ᴙ","ꜱ","ᴛ","ⱻ","ᴚ","ᴜ","ᴠ","ᴡ","ʏ","ᴢ","á","ă","ắ","ặ","ằ","ẳ","ẵ","ǎ","â","ấ","ậ","ầ","ẩ","ẫ","ä","ǟ","ȧ","ǡ","ạ","ȁ","à","ả","ȃ","ā","ą","ᶏ","ẚ","å","ǻ","ḁ","ⱥ","ã","ꜳ","æ","ǽ","ǣ","ꜵ","ꜷ","ꜹ","ꜻ","ꜽ","ḃ","ḅ","ɓ","ḇ","ᵬ","ᶀ","ƀ","ƃ","ɵ","ć","č","ç","ḉ","ĉ","ɕ","ċ","ƈ","ȼ","ď","ḑ","ḓ","ȡ","ḋ","ḍ","ɗ","ᶑ","ḏ","ᵭ","ᶁ","đ","ɖ","ƌ","ı","ȷ","ɟ","ʄ","ǳ","ǆ","é","ĕ","ě","ȩ","ḝ","ê","ế","ệ","ề","ể","ễ","ḙ","ë","ė","ẹ","ȅ","è","ẻ","ȇ","ē","ḗ","ḕ","ⱸ","ę","ᶒ","ɇ","ẽ","ḛ","ꝫ","ḟ","ƒ","ᵮ","ᶂ","ǵ","ğ","ǧ","ģ","ĝ","ġ","ɠ","ḡ","ᶃ","ǥ","ḫ","ȟ","ḩ","ĥ","ⱨ","ḧ","ḣ","ḥ","ɦ","ẖ","ħ","ƕ","í","ĭ","ǐ","î","ï","ḯ","ị","ȉ","ì","ỉ","ȋ","ī","į","ᶖ","ɨ","ĩ","ḭ","ꝺ","ꝼ","ᵹ","ꞃ","ꞅ","ꞇ","ꝭ","ǰ","ĵ","ʝ","ɉ","ḱ","ǩ","ķ","ⱪ","ꝃ","ḳ","ƙ","ḵ","ᶄ","ꝁ","ꝅ","ĺ","ƚ","ɬ","ľ","ļ","ḽ","ȴ","ḷ","ḹ","ⱡ","ꝉ","ḻ","ŀ","ɫ","ᶅ","ɭ","ł","ǉ","ſ","ẜ","ẛ","ẝ","ḿ","ṁ","ṃ","ɱ","ᵯ","ᶆ","ń","ň","ņ","ṋ","ȵ","ṅ","ṇ","ǹ","ɲ","ṉ","ƞ","ᵰ","ᶇ","ɳ","ñ","ǌ","ó","ŏ","ǒ","ô","ố","ộ","ồ","ổ","ỗ","ö","ȫ","ȯ","ȱ","ọ","ő","ȍ","ò","ỏ","ơ","ớ","ợ","ờ","ở","ỡ","ȏ","ꝋ","ꝍ","ⱺ","ō","ṓ","ṑ","ǫ","ǭ","ø","ǿ","õ","ṍ","ṏ","ȭ","ƣ","ꝏ","ɛ","ᶓ","ɔ","ᶗ","ȣ","ṕ","ṗ","ꝓ","ƥ","ᵱ","ᶈ","ꝕ","ᵽ","ꝑ","ꝙ","ʠ","ɋ","ꝗ","ŕ","ř","ŗ","ṙ","ṛ","ṝ","ȑ","ɾ","ᵳ","ȓ","ṟ","ɼ","ᵲ","ᶉ","ɍ","ɽ","ↄ","ꜿ","ɘ","ɿ","ß","ś","ṥ","š","ṧ","ş","ŝ","ș","ṡ","ṣ","ṩ","ʂ","ᵴ","ᶊ","ȿ","ɡ","ᴑ","ᴓ","ᴝ","ť","ţ","ṱ","ț","ȶ","ẗ","ⱦ","ṫ","ṭ","ƭ","ṯ","ᵵ","ƫ","ʈ","ŧ","ᵺ","ɐ","ᴂ","ǝ","ᵷ","ɥ","ʮ","ʯ","ᴉ","ʞ","ꞁ","ɯ","ɰ","ᴔ","ɹ","ɻ","ɺ","ⱹ","ʇ","ʌ","ʍ","ʎ","ꜩ","ú","ŭ","ǔ","û","ṷ","ü","ǘ","ǚ","ǜ","ǖ","ṳ","ụ","ű","ȕ","ù","ủ","ư","ứ","ự","ừ","ử","ữ","ȗ","ū","ṻ","ų","ᶙ","ů","ũ","ṹ","ṵ","ᵫ","ꝸ","ⱴ","ꝟ","ṿ","ʋ","ᶌ","ⱱ","ṽ","ꝡ","ẃ","ŵ","ẅ","ẇ","ẉ","ẁ","ⱳ","ẘ","ẍ","ẋ","ᶍ","ý","ŷ","ÿ","ẏ","ỵ","ỳ","ƴ","ỷ","ỿ","ȳ","ẙ","ɏ","ỹ","ź","ž","ẑ","ʑ","ⱬ","ż","ẓ","ȥ","ẕ","ᵶ","ᶎ","ʐ","ƶ","ɀ","ﬀ","ﬃ","ﬄ","ﬁ","ﬂ","ĳ","œ","ﬆ","ₐ","ₑ","ᵢ","ⱼ","ₒ","ᵣ","ᵤ","ᵥ","ₓ","a","getMetadata","assignedToId","keyGuid","assignmentObjectTypeId","keyType","eavConf","permissionTargetGuid","ctId","EntityAssignment","ctSvc","updateLiveAll","$resource","pipelineResource","entitiesResource","getDataSourceDefinitionProperty","model","definition","InstalledDataSources","d","outDataSource","className","pipelineEntityId","getInstalledDataSources","$promise","JSON","parse","toJson","ClassName","allowNew","dataSourceBase","dataSourcesPrepared","dataSourceClone","copy","dataSourceFullName","newAppId","creator","getLiveList","disableToastr","t","liveListCache","isLoaded","_liveListUpdateWithResult","isOpened","liveListReset","toastrConfig","containerId","maxOpened","newestOnTop","positionClass","preventDuplicates","preventOpenDuplicates","originalError","messageOrHttpError","optionsOverride","Message","ExceptionMessage","saveWithToaster","saving","keyInfo","keyOk","keyError","durInfo","durOk","durError","$templateCache","put"],"mappings":"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,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,KAAM,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,KAAMC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,KAAMC,IAAK,KAAMC,IAAK,KAAMC,IAAK,KAAMC,IAAK,KAAMC,IAAK,KAAMC,IAAK,KAAMC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAAMC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,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","file":"eav-admin.min.js","sourcesContent":["(function () {\r\n    angular.module(\"ContentExportApp\", [\r\n        \"EavAdminUi\",\r\n        \"EavDirectives\",\r\n        \"EavConfiguration\",\r\n        \"EavServices\",\r\n        \"ContentHelperFilters\",\r\n        \"ContentFormlyTypes\"\r\n    ]);\r\n}());\n(function () {\r\n\r\n    contentExportController.$inject = [\"appId\", \"contentType\", \"contentExportService\", \"eavAdminDialogs\", \"eavConfig\", \"languages\", \"$modalInstance\", \"$filter\", \"$translate\"];\r\n    angular.module(\"ContentExportApp\")\r\n        .controller(\"ContentExport\", contentExportController);\r\n\r\n    function contentExportController(appId, contentType, contentExportService, eavAdminDialogs, eavConfig, languages, $modalInstance, $filter, $translate) {\r\n\r\n        var vm = this;\r\n\r\n        vm.formValues = {};\r\n\r\n        vm.formFields = [{\r\n            // Content type\r\n            key: \"AppId\",\r\n            type: \"hidden\",\r\n            defaultValue: appId\r\n        }, {\r\n            // Default / fallback language\r\n            key: \"DefaultLanguage\",\r\n            type: \"hidden\",\r\n            defaultValue: $filter(\"isoLangCode\")(languages.defaultLanguage)\r\n        }, {\r\n            // Content type\r\n            key: \"ContentType\",\r\n            type: \"hidden\",\r\n            defaultValue: contentType\r\n        }, {\r\n            key: \"Language\",\r\n            type: \"select\",\r\n            expressionProperties: {\r\n                \"templateOptions.label\": \"'Content.Export.Fields.Language.Label' | translate\",\r\n                \"templateOptions.options\": function () {\r\n                    var options = [{\r\n                        \"name\": $translate.instant(\"Content.Export.Fields.Language.Options.All\"),\r\n                        \"value\": \"\"\r\n                    }];\r\n                    angular.forEach(languages.languages, function (lang) {\r\n                        var langCode = $filter(\"isoLangCode\")(lang.key);\r\n                        options.push({ \"name\": langCode, \"value\": langCode });\r\n                    });\r\n                    return options;\r\n                }\r\n            },\r\n            defaultValue: \"\"\r\n        }, {\r\n            key: \"RecordExport\",\r\n            type: \"radio\",\r\n            expressionProperties: {\r\n                \"templateOptions.label\": \"'Content.Export.Fields.RecordExport.Label' | translate\",\r\n                \"templateOptions.options\": function () {\r\n                    return [{\r\n                        \"name\": $translate.instant(\"Content.Export.Fields.RecordExport.Options.Blank\"),\r\n                        \"value\": \"Blank\"\r\n                    }, {\r\n                        \"name\": $translate.instant(\"Content.Export.Fields.RecordExport.Options.All\"),\r\n                        \"value\": \"All\"\r\n                    }];\r\n                }\r\n            },\r\n            defaultValue: \"All\"\r\n        }, {\r\n            // Language references\r\n            key: \"LanguageReferences\",\r\n            type: \"radio\",\r\n            expressionProperties: {\r\n                \"templateOptions.label\": \"'Content.Export.Fields.LanguageReferences.Label' | translate\",\r\n                \"templateOptions.disabled\": function () {\r\n                    return vm.formValues.RecordExport == \"Blank\";\r\n                },\r\n                \"templateOptions.options\": function () {\r\n                    return [{\r\n                        \"name\": $translate.instant(\"Content.Export.Fields.LanguageReferences.Options.Link\"),\r\n                        \"value\": \"Link\"\r\n                    }, {\r\n                        \"name\": $translate.instant(\"Content.Export.Fields.LanguageReferences.Options.Resolve\"),\r\n                        \"value\": \"Resolve\"\r\n                    }];\r\n                }\r\n            },\r\n            defaultValue: \"Link\"\r\n        }, {\r\n            // File / page references\r\n            key: \"ResourcesReferences\",\r\n            type: \"radio\",\r\n            expressionProperties: {\r\n                \"templateOptions.label\": \"'Content.Export.Fields.ResourcesReferences.Label' | translate\",\r\n                \"templateOptions.disabled\": function () {\r\n                    return vm.formValues.RecordExport == \"Blank\";\r\n                },\r\n                \"templateOptions.options\": function () {\r\n                    return [{\r\n                        \"name\": $translate.instant(\"Content.Export.Fields.ResourcesReferences.Options.Link\"),\r\n                        \"value\": \"Link\"\r\n                    }, {\r\n                        \"name\": $translate.instant(\"Content.Export.Fields.ResourcesReferences.Options.Resolve\"),\r\n                        \"value\": \"Resolve\"\r\n                    }];\r\n                }\r\n            },\r\n            defaultValue: \"Link\"\r\n        }];\r\n\r\n\r\n        vm.exportContent = function exportContent() {\r\n            contentExportService.exportContent(vm.formValues);\r\n        };\r\n\r\n        vm.close = function close() {\r\n            $modalInstance.dismiss(\"cancel\");\r\n        };\r\n    }\r\n}());\n(function () {\r\n\r\n    contentExportService.$inject = [\"$http\", \"eavConfig\"];\r\n    angular.module(\"ContentExportApp\")\r\n         .factory(\"contentExportService\", contentExportService);\r\n\r\n\r\n    function contentExportService($http, eavConfig) {\r\n        var srvc = {\r\n            exportContent: exportContent,\r\n        };\r\n        return srvc;\r\n\r\n        function exportContent(args) {\r\n            var url = eavConfig.getUrlPrefix(\"api\") + \"/eav/ContentExport/ExportContent\";\r\n            window.open(url + \"?appId=\" + args.AppId + \"&language=\" + args.Language + \"&defaultLanguage=\" + args.DefaultLanguage + \"&contentType=\" + args.ContentType + \"&recordExport=\" + args.RecordExport + \"&resourcesReferences=\" + args.ResourcesReferences + \"&languageReferences=\" + args.LanguageReferences, \"_self\", \"\");\r\n        }\r\n    }\r\n}());\n(function () {\r\n    angular.module(\"ContentFormlyTypes\", [\r\n        \"naif.base64\",\r\n        \"formly\",\r\n        \"formlyBootstrap\",\r\n        \"ui.bootstrap\"\r\n    ]);\r\n}());\n(function () {\r\n\r\n    angular.module(\"ContentFormlyTypes\")\r\n\r\n        .config([\"formlyConfigProvider\", function (formlyConfigProvider) {\r\n            var formly = formlyConfigProvider;\r\n\r\n            formly.setType({\r\n                name: \"file\",\r\n                template: \"<span class='btn btn-default btn-square btn-file'><span class='glyphicon glyphicon-open'></span><input type='file' ng-model='model[options.key]' base-sixty-four-input /></span> <span ng-if='model[options.key]'>{{model[options.key].filename}}</span>\",\r\n                wrapper: [\"bootstrapLabel\", \"bootstrapHasError\"]\r\n            });\r\n\r\n            formly.setType({\r\n                name: \"hidden\",\r\n                template: \"<input style='display:none' ng-model='model[options.key]' />\",\r\n                wrapper: [\"bootstrapLabel\", \"bootstrapHasError\"]\r\n            });\r\n    }]);\r\n}());\n(function () {\r\n    angular.module(\"ContentHelperFilters\", []);\r\n\r\n\r\n    angular.module(\"ContentHelperFilters\").filter(\"isoLangCode\", function () {\r\n        return function (str) {\r\n            if (str.length != 5)\r\n                return str;\r\n            return str.substring(0, 2).toLowerCase() + \"-\" + str.substring(3, 5).toUpperCase();\r\n        };\r\n    });\r\n}());\n(function () {\r\n    angular.module(\"ContentImportApp\", [\r\n        \"EavAdminUi\",\r\n        \"EavDirectives\",\r\n        \"EavConfiguration\",\r\n        \"EavServices\",\r\n        \"ContentHelperFilters\",\r\n        \"ContentFormlyTypes\"\r\n    ]);\r\n}());\n(function () {\r\n\r\n    contentImportController.$inject = [\"appId\", \"contentType\", \"contentImportService\", \"eavAdminDialogs\", \"eavConfig\", \"languages\", \"debugState\", \"$modalInstance\", \"$filter\", \"$translate\"];\r\n    angular.module(\"ContentImportApp\")\r\n        .controller(\"ContentImport\", contentImportController);\r\n\r\n    function contentImportController(appId, contentType, contentImportService, eavAdminDialogs, eavConfig, languages, debugState, $modalInstance, $filter, $translate) {\r\n\r\n        var vm = this;\r\n        vm.debug = debugState;\r\n\r\n        vm.formValues = {};\r\n\r\n        vm.formFields = [{\r\n            // Content type\r\n            key: \"AppId\",\r\n            type: \"hidden\",\r\n            defaultValue: appId\r\n        }, {\r\n            // Default / fallback language\r\n            key: \"DefaultLanguage\",\r\n            type: \"hidden\",\r\n            defaultValue: $filter(\"isoLangCode\")(languages.defaultLanguage)\r\n        }, {\r\n            // Content type\r\n            key: \"ContentType\",\r\n            type: \"hidden\",\r\n            defaultValue: contentType\r\n        }, {\r\n            // File\r\n            key: \"File\",\r\n            type: \"file\",\r\n            templateOptions: {\r\n                required: true\r\n            },\r\n            expressionProperties: {\r\n                \"templateOptions.label\": \"'Content.Import.Fields.File.Label' | translate\"\r\n            }\r\n        }, {\r\n            // File / page references\r\n            key: \"ResourcesReferences\",\r\n            type: \"radio\",\r\n            expressionProperties: {\r\n                \"templateOptions.label\": \"'Content.Import.Fields.ResourcesReferences.Label' | translate\",\r\n                \"templateOptions.options\": function () {\r\n                    return [{\r\n                        \"name\": $translate.instant(\"Content.Import.Fields.ResourcesReferences.Options.Keep\"),\r\n                        \"value\": \"Keep\"\r\n                    }, {\r\n                        \"name\": $translate.instant(\"Content.Import.Fields.ResourcesReferences.Options.Resolve\"),\r\n                        \"value\": \"Resolve\"\r\n                    }];\r\n                }\r\n            },\r\n            defaultValue: \"Keep\"\r\n        }, {\r\n            // Clear entities\r\n            key: \"ClearEntities\",\r\n            type: \"radio\",\r\n            expressionProperties: {\r\n                \"templateOptions.label\": \"'Content.Import.Fields.ClearEntities.Label' | translate\",\r\n                \"templateOptions.options\": function () {\r\n                    return [{\r\n                        \"name\": $translate.instant(\"Content.Import.Fields.ClearEntities.Options.None\"),\r\n                        \"value\": \"None\"\r\n                    }, {\r\n                        \"name\": $translate.instant(\"Content.Import.Fields.ClearEntities.Options.All\"),\r\n                        \"value\": \"All\"\r\n                    }];\r\n                }\r\n            },\r\n            defaultValue: \"None\"\r\n        }];\r\n\r\n        vm.viewStates = {\r\n            \"Waiting\":   0,\r\n            \"Default\":   1,\r\n            \"Evaluated\": 2,\r\n            \"Imported\":  3\r\n        };\r\n\r\n        vm.viewStateSelected = vm.viewStates.Default;\r\n\r\n\r\n        vm.evaluationResult = { };\r\n\r\n        vm.importResult = { };\r\n\r\n\r\n        vm.evaluateContent = function evaluateContent() {\r\n            vm.viewStateSelected = vm.viewStates.Waiting;\r\n            return contentImportService.evaluateContent(vm.formValues).then(function (result) {\r\n                vm.evaluationResult = result.data;\r\n                vm.viewStateSelected = vm.viewStates.Evaluated;\r\n            });\r\n        };\r\n\r\n        vm.importContent = function importContent() {\r\n            vm.viewStateSelected = vm.viewStates.Waiting;\r\n            return contentImportService.importContent(vm.formValues).then(function (result) {\r\n                vm.importResult = result.data;\r\n                vm.viewStateSelected = vm.viewStates.Imported;\r\n            });\r\n        };\r\n\r\n        vm.reset = function reset() {\r\n            vm.formValues = { };\r\n            vm.evaluationResult = { };\r\n            vm.importResult = { };\r\n        };\r\n\r\n        vm.back = function back() {\r\n            vm.viewStateSelected = vm.viewStates.Default;\r\n        };\r\n\r\n        vm.close = function close() {\r\n            vm.viewStateSelected = vm.viewStates.Default;\r\n            $modalInstance.dismiss(\"cancel\");\r\n        };\r\n    }\r\n}());\n(function () {\r\n\r\n    contentImportService.$inject = [\"$http\"];\r\n    angular.module(\"ContentImportApp\")\r\n         .factory(\"contentImportService\", contentImportService);\r\n\r\n\r\n    function contentImportService($http) {\r\n        var srvc = {\r\n            evaluateContent: evaluateContent,\r\n            importContent: importContent\r\n        };\r\n        return srvc;\r\n\r\n        function evaluateContent(args) {\r\n            return $http.post(\"eav/ContentImport/EvaluateContent\", { AppId: args.AppId, DefaultLanguage: args.DefaultLanguage, ContentType: args.ContentType, ContentBase64: args.File.base64, ResourcesReferences: args.ResourcesReferences, ClearEntities: args.ClearEntities });\r\n        }\r\n\r\n        function importContent(args) {\r\n            return $http.post(\"eav/ContentImport/ImportContent\", { AppId: args.AppId, DefaultLanguage: args.DefaultLanguage, ContentType: args.ContentType, ContentBase64: args.File.base64, ResourcesReferences: args.ResourcesReferences, ClearEntities: args.ClearEntities });\r\n        }\r\n    }\r\n}());\n(function () { \r\n\r\n    EditContentItemController.$inject = [\"mode\", \"entityId\", \"contentType\", \"eavAdminDialogs\", \"$modalInstance\"];\r\n    angular.module(\"ContentEditApp\", [\r\n        \"EavServices\",\r\n        \"EavAdminUi\"\r\n    ])\r\n        .controller(\"EditContentItem\", EditContentItemController)\r\n        ;\r\n\r\n    function EditContentItemController(mode, entityId, contentType, eavAdminDialogs, $modalInstance) { //}, contentTypeId, eavAdminDialogs) {\r\n        var vm = this;\r\n        vm.mode = mode;\r\n        vm.entityId = entityId;\r\n        vm.contentType = contentType;\r\n        vm.TestMessage = \"Test message the controller is binding correctly...\";\r\n\r\n        vm.history = function history() {\r\n            return eavAdminDialogs.openItemHistory(vm.entityId);\r\n        };\r\n\r\n        vm.close = function () { $modalInstance.dismiss(\"cancel\"); };\r\n    }\r\n\r\n} ());\n(function () {\r\n\t'use strict';\r\n\r\n\tcontentItemsListController.$inject = [\"contentItemsSvc\", \"eavConfig\", \"appId\", \"contentType\", \"eavAdminDialogs\", \"debugState\", \"$modalInstance\", \"$q\", \"$modalStack\"];\r\n\tangular.module(\"ContentItemsAppAgnostic\", [\r\n        \"EavConfiguration\",\r\n        \"EavAdminUi\",\r\n        \"EavServices\",\r\n\t\t// \"agGrid\" // needs this, but can't hardwire the dependency as it would cause problems with lazy-loading\r\n\t])\r\n        .controller(\"ContentItemsList\", contentItemsListController)\r\n\t;\r\n\r\n\tfunction contentItemsListController(contentItemsSvc, eavConfig, appId, contentType, eavAdminDialogs, debugState, $modalInstance, $q, $modalStack) {\r\n\t\t/* jshint validthis:true */\r\n\t\tvar vm = angular.extend(this, {\r\n\t\t\tdebug: debugState,\r\n\t\t\tgridOptions: {\r\n\t\t\t\tenableSorting: true,\r\n\t\t\t\tenableFilter: true,\r\n\t\t\t\trowHeight: 39,\r\n\t\t\t\tcolWidth: 155,\r\n\t\t\t\theaderHeight: 38,\r\n\t\t\t\tangularCompileRows: true\r\n\t\t\t},\r\n\t\t\tadd: add,\r\n\t\t\trefresh: setRowData,\r\n\t\t\ttryToDelete: tryToDelete,\r\n\t\t\topenDuplicate: openDuplicate,\r\n\t\t\tclose: close\r\n\t\t});\r\n\t\tvar svc;\r\n\r\n\t\tvar staticColumns = [\r\n\t\t\t{\r\n\t\t\t\theaderName: \"ID\",\r\n\t\t\t\tfield: \"Id\",\r\n\t\t\t\twidth: 50,\r\n\t\t\t\ttemplate: '<span tooltip-append-to-body=\"true\" tooltip=\"Id: {{data.Id}}\\nRepoId: {{data.RepositoryId}}\\nGuid: {{data.Guid}}\" ng-bind=\"data.Id\"></span>',\r\n\t\t\t\tcellClass: \"clickable\",\r\n\t\t\t\tfilter: 'number',\r\n\t\t\t\tonCellClicked: openEditDialog\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\theaderName: \"Status\",\r\n\t\t\t\tfield: \"IsPublished\",\r\n\t\t\t\twidth: 75,\r\n\t\t\t\tsuppressSorting: true,\r\n\t\t\t\ttemplate: '<span class=\"glyphicon\" ng-class=\"{\\'glyphicon-eye-open\\': data.IsPublished, \\'glyphicon-eye-close\\' : !data.IsPublished}\" tooltip-append-to-body=\"true\" tooltip=\"{{ \\'Content.Publish.\\' + (data.IsPublished ? \\'PnV\\': data.Published ? \\'DoP\\' : \\'D\\') | translate }}\"></span> <span icon=\"{{ data.Draft ? \\'link\\' : data.Published ? \\'link\\' : \\'\\' }}\" tooltip-append-to-body=\"true\" tooltip=\"{{ (data.Draft ? \\'Content.Publish.HD\\' :\\'\\') | translate:\\'{ id: data.Draft.RepositoryId}\\' }}\\n{{ (data.Published ? \\'Content.Publish.HP\\' :\\'\\') | translate }} #{{ data.Published.RepositoryId }}\"></span> <span ng-if=\"data.Metadata\" tooltip-append-to-body=\"true\" tooltip=\"Metadata for type {{ data.Metadata.TargetType}}, id {{ data.Metadata.KeyNumber }}{{ data.Metadata.KeyString }}{{ data.Metadata.KeyGuid }}\" icon=\"tag\"></span>',\r\n\t\t\t\tvalueGetter: valueGetterStatusField\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\theaderName: \"Title\",\r\n\t\t\t\tfield: \"Title\",\r\n\t\t\t\twidth: 216,\r\n\t\t\t\tcellClass: \"clickable\",\r\n\t\t\t\ttemplate: '<span tooltip-append-to-body=\"true\" tooltip=\"{{data.Title}}\" ng-bind=\"data.Title + \\' \\' + ((!data.Title ? \\'Content.Manage.NoTitle\\':\\'\\') | translate)\"></span>',\r\n\t\t\t\tfilter: 'text',\r\n\t\t\t\tonCellClicked: openEditDialog\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\theaderName: \"\",\r\n\t\t\t\twidth: 70,\r\n\t\t\t\tsuppressSorting: true,\r\n\t\t\t\tsuppressMenu: true,\r\n\t\t\t\ttemplate: '<button type=\"button\" class=\"btn btn-xs btn-square\" ng-click=\"vm.openDuplicate(data)\" tooltip-append-to-body=\"true\" tooltip=\"{{ \\'General.Buttons.Copy\\' | translate }}\"><i icon=\"duplicate\"></i></button> <button type=\"button\" class=\"btn btn-xs btn-square\" ng-click=\"vm.tryToDelete(data)\" tooltip-append-to-body=\"true\" tooltip=\"{{ \\'General.Buttons.Delete\\' | translate }}\"><i icon=\"remove\"></i> </button>'\r\n\t\t\t}\r\n\t\t];\r\n\r\n\t\tactivate();\r\n\r\n\t\tfunction activate() {\r\n\t\t\tsvc = contentItemsSvc(appId, contentType);\r\n\r\n\t\t\t// set RowData an Column Definitions\r\n\t\t\t$q.all([setRowData(), svc.getColumns()])\r\n\t\t\t\t.then(function (success) {\r\n\t\t\t\t\tvar columnDefs = getColumnDefs(success[1].data);\r\n\t\t\t\t\tvm.gridOptions.api.setColumnDefs(columnDefs);\r\n\r\n\t\t\t\t\t// resize outer modal (if needed)\r\n\t\t\t\t\tvar bodyWidth = vm.gridOptions.api.gridPanel.eBodyContainer.clientWidth;\r\n\t\t\t\t\tvar viewportWidth = vm.gridOptions.api.gridPanel.eBodyViewport.clientWidth;\r\n\t\t\t\t\tif (bodyWidth < viewportWidth)\r\n\t\t\t\t\t\tsetModalWidth(bodyWidth);\r\n\t\t\t\t});\r\n\t\t}\r\n\r\n\t\t// set width of outer angular-ui-modal. This is a quick and dirty solution because there's no official way to do this.\r\n\t\t// $modalStack.getTop() might get a wrong modal Instance\r\n\t\t// setting the width with inline css in a controller should be avoided\r\n\t\tfunction setModalWidth(width) {\r\n\t\t\tvar modalDomEl = $modalStack.getTop().value.modalDomEl;\r\n\t\t\tvar modalDialog = modalDomEl.children();\r\n\t\t\tmodalDialog.css(\"width\", (width + 47) + \"px\");\t// add some pixels for padding and scrollbars\r\n\t\t}\r\n\r\n\t\tfunction add() {\r\n\t\t\teavAdminDialogs.openItemNew(contentType, setRowData);\r\n\t\t}\r\n\r\n\t\tfunction openEditDialog(params) {\r\n\t\t\teavAdminDialogs.openItemEditWithEntityId(params.data.Id, setRowData);\r\n\t\t}\r\n\r\n\t\t// Get/Update Grid Row-Data\r\n\t\tfunction setRowData() {\r\n\t\t\tvar sortModel = {};\r\n\t\t\tvar filterModel = {};\r\n\t\t\tif (vm.gridOptions.api) {\r\n\t\t\t\tsortModel = vm.gridOptions.api.getSortModel();\r\n\t\t\t\tfilterModel = vm.gridOptions.api.getFilterModel();\r\n\t\t\t}\r\n\r\n\t\t\treturn svc.liveListSourceRead().then(function (success) {\r\n\t\t\t\tvm.gridOptions.api.setRowData(success.data);\r\n\t\t\t\tvm.gridOptions.api.setSortModel(sortModel);\r\n\t\t\t\tvm.gridOptions.api.setFilterModel(filterModel);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// get Grid Column-Definitions from an Array of EAV-Attributes\r\n\t\tfunction getColumnDefs(eavAttributes) {\r\n\t\t\tvar columnDefs = staticColumns;\r\n\r\n\t\t\tangular.forEach(eavAttributes, function (eavAttribute) {\r\n\t\t\t\tif (eavAttribute.IsTitle) {\r\n\t\t\t\t\tstaticColumns[2].eavAttribute = eavAttribute;\r\n\t\t\t\t\treturn;\t// don't add Title-Field twice\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar colDef = {\r\n\t\t\t\t\teavAttribute: eavAttribute,\r\n\t\t\t\t\theaderName: eavAttribute.StaticName,\r\n\t\t\t\t\tfield: eavAttribute.StaticName,\r\n\t\t\t\t\tcellRenderer: cellRendererDefault,\r\n\t\t\t\t\tfilterParams: { cellRenderer: cellRendererDefaultFilter }\r\n\t\t\t\t};\r\n\r\n\r\n\t\t\t\tswitch (eavAttribute.Type) {\r\n\t\t\t\t\tcase \"Entity\":\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tcolDef.allowMultiValue = eavAttribute.Metadata.Entity.AllowMultiValue;\r\n\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\tcolDef.allowMultiValue = true;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tcolDef.cellRenderer = cellRendererEntity;\r\n\t\t\t\t\t\tcolDef.valueGetter = valueGetterEntityField;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"DateTime\":\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tcolDef.useTimePicker = eavAttribute.Metadata.DateTime.UseTimePicker;\r\n\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\tcolDef.useTimePicker = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcolDef.valueGetter = valueGetterDateTime;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Boolean\":\r\n\t\t\t\t\t\tcolDef.valueGetter = valueGetterBoolean;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Number\":\r\n\t\t\t\t\t\tcolDef.filter = 'number';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcolumnDefs.push(colDef);\r\n\t\t\t});\r\n\r\n\t\t\treturn columnDefs;\r\n\t\t}\r\n\r\n\t\t//#region Column Value-Getter and Cell Renderer\r\n\t\tfunction valueGetterEntityField(params) {\r\n\t\t\tvar rawValue = params.data[params.colDef.field];\r\n\t\t\tif (rawValue.length === 0)\r\n\t\t\t\treturn null;\r\n\r\n\t\t\treturn rawValue.map(function (item) {\r\n\t\t\t\treturn item.Title;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfunction valueGetterStatusField(params) {\r\n\t\t\treturn [\r\n\t\t\t\tparams.data.IsPublished ? \"is published\" : \"is not published\",\r\n\t\t\t\tparams.data.Metadata ? \"is metadata\" : \"is not metadata\"\r\n\t\t\t];\r\n\t\t}\r\n\r\n\t\tfunction valueGetterDateTime(params) {\r\n\t\t\tvar rawValue = params.data[params.colDef.field];\r\n\t\t\tif (!rawValue)\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t// remove 'Z' and replace 'T'\r\n\t\t\treturn params.colDef.useTimePicker ? rawValue.substr(0, 19).replace('T', ' ') : rawValue.substr(0, 10);\r\n\t\t}\r\n\r\n\t\tfunction valueGetterBoolean(params) {\r\n\t\t\tvar rawValue = params.data[params.colDef.field];\r\n\t\t\tif (typeof rawValue != \"boolean\")\r\n\t\t\t\treturn null;\r\n\r\n\t\t\treturn rawValue.toString();\r\n\t\t}\r\n\r\n\t\tfunction cellRendererDefault(params) {\r\n\t\t\tif (typeof (params.value) != \"string\" || params.value === null)\r\n\t\t\t\treturn params.value;\r\n\r\n\t\t\tvar encodedValue = htmlEncode(params.value);\r\n\t\t\treturn '<span title=\"' + encodedValue + '\">' + encodedValue + '</span>';\r\n\t\t}\r\n\r\n\t\tfunction cellRendererDefaultFilter(params) {\r\n\t\t\treturn cellRendererDefault(params) || \"(empty)\";\r\n\t\t}\r\n\r\n\t\t// htmlencode strings (source: http://stackoverflow.com/a/7124052)\r\n\t\tfunction htmlEncode(text) {\r\n\t\t\treturn text.replace(/&/g, '&amp;').replace(/\"/g, '&quot;').replace(/'/g, '&#39;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n\t\t}\r\n\r\n\t\tfunction cellRendererEntity(params) {\r\n\t\t\tif (!Array.isArray(params.value))\r\n\t\t\t\treturn null;\r\n\r\n\t\t\tvar encodedValue = htmlEncode(params.value.join(\", \"));\r\n\t\t\tvar result = '<span title=\"' + encodedValue + '\">';\r\n\t\t\tif (params.colDef.allowMultiValue)\r\n\t\t\t\tresult += '<span class=\"badge badge-primary\">' + params.value.length + '</span> ';\r\n\t\t\tresult += encodedValue + '</span>';\r\n\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\t// #endregion\r\n\r\n\t\tfunction tryToDelete(item) {\r\n\t\t\tif (confirm(\"Delete '\" + item.Title + \"' (\" + item.RepositoryId + \") ?\"))\r\n\t\t\t\tsvc.delete(item.RepositoryId).then(setRowData);\r\n\t\t}\r\n\r\n\t\tfunction openDuplicate(item) {\r\n\t\t\tvar items = [\r\n\t\t        {\r\n\t\t        \tContentTypeName: contentType,\r\n\t\t        \tDuplicateEntity: item.Id\r\n\t\t        }\r\n\t\t\t];\r\n\t\t\teavAdminDialogs.openEditItems(items, svc.liveListReload);\r\n\t\t}\r\n\r\n\t\tfunction close() {\r\n\t\t\t$modalInstance.dismiss(\"cancel\");\r\n\t\t}\r\n\t}\r\n\r\n}());\n(function () { // TN: this is a helper construct, research iife or read https://github.com/johnpapa/angularjs-styleguide#iife\r\n\r\n    ContentItemsListController.$inject = [\"contentItemsSvc\", \"eavConfig\", \"appId\", \"contentType\", \"eavAdminDialogs\", \"debugState\", \"$modalInstance\"];\r\n    angular.module(\"ContentItemsApp\", [\r\n        \"EavConfiguration\",\r\n        \"EavAdminUi\",\r\n        \"EavServices\"\r\n    ])\r\n        .controller(\"ContentItemsList\", ContentItemsListController)\r\n    ;\r\n\r\n    function ContentItemsListController(contentItemsSvc, eavConfig, appId, contentType, eavAdminDialogs, debugState, $modalInstance) {\r\n        var vm = this;\r\n        vm.debug = debugState;\r\n\r\n        var svc = contentItemsSvc(appId, contentType); \r\n\r\n        // config\r\n        vm.maxDynamicColumns = 10;\r\n\r\n        vm.add = function add() {\r\n            eavAdminDialogs.openItemNew(contentType, svc.liveListReload);\r\n        };\r\n\r\n        vm.edit = function(item) {\r\n            eavAdminDialogs.openItemEditWithEntityId(item.Id, svc.liveListReload);\r\n        };\r\n\r\n        vm.refresh = svc.liveListReload;\r\n\r\n        vm.items = svc.liveList();\r\n\r\n        vm.dynamicColumns = [];\r\n        svc.getColumns().then(function (result) {\r\n            var cols = result.data;\r\n            for (var c = 0; c < cols.length && c < vm.maxDynamicColumns; c++) {\r\n                if (!cols[c].IsTitle)\r\n                    vm.dynamicColumns.push(cols[c]);\r\n            }\r\n        });\r\n\r\n        vm.tryToDelete = function tryToDelete(item) {\r\n            if (confirm(\"Delete '\" + \"title-unknown-yet\" + \"' (\" + item.RepositoryId + \") ?\"))\r\n                svc.delete(item.RepositoryId);\r\n        };\r\n\r\n        vm.openDuplicate = function openDuplicate(item) {\r\n            var items = [\r\n                {\r\n                    ContentTypeName: contentType,\r\n                    DuplicateEntity: item.Id\r\n                }\r\n            ];\r\n            eavAdminDialogs.openEditItems(items, svc.liveListReload);\r\n\r\n        };\r\n\r\n        vm.close = function () { $modalInstance.dismiss(\"cancel\"); };\r\n\r\n    }\r\n\r\n} ());\n(function () { // TN: this is a helper construct, research iife or read https://github.com/johnpapa/angularjs-styleguide#iife\r\n\r\n    HistoryController.$inject = [\"appId\", \"entityId\", \"historySvc\", \"$modalInstance\", \"$modal\"];\r\n    HistoryDetailsController.$inject = [\"changeId\", \"dataSvc\", \"$modalInstance\"];\r\n    angular.module(\"HistoryApp\", [\r\n        \"EavServices\",\r\n        \"EavConfiguration\",\r\n        \"eavTemplates\",\r\n    ])\r\n        .controller(\"History\", HistoryController)\r\n        .controller(\"HistoryDetails\", HistoryDetailsController)\r\n        ;\r\n\r\n    function HistoryController(appId, entityId, historySvc, $modalInstance, $modal) {\r\n        var vm = this;\r\n        var svc = historySvc(appId, entityId);\r\n        vm.entityId = entityId;\r\n        vm.items = svc.liveList();\r\n\r\n        vm.close = function () { $modalInstance.dismiss(\"cancel\"); };\r\n\r\n        vm.details = function(item) {\r\n            $modal.open({\r\n                animation: true,\r\n                templateUrl: \"content-items/history-details.html\",\r\n                controller: \"HistoryDetails\",\r\n                controllerAs: \"vm\",\r\n                resolve: {\r\n                    changeId: function() { return item.ChangeId; },\r\n                    dataSvc: function() { return svc; }\r\n                }\r\n            });\r\n        };\r\n    }\r\n\r\n    function HistoryDetailsController(changeId, dataSvc, $modalInstance) {\r\n        var vm = this;\r\n        alert(\"not implemented yet\");\r\n        var svc = dataSvc;\r\n\r\n        svc.getVersionDetails(changeId).then(function(result) {\r\n            alert(result.data);\r\n            vm.items = result.data;\r\n        });\r\n        // vm.items = svc.liveList();\r\n\r\n        vm.close = function () { $modalInstance.dismiss(\"cancel\"); };\r\n    }\r\n} ());\n// This is the main declaration for the app ContentTypesApp\r\n(function () {\r\n\r\n    angular.module(\"ContentTypesApp\", [\r\n        \"EavServices\",\r\n        \"EavAdminUi\",\r\n        \"EavDirectives\"\r\n        ])\r\n        .constant(\"license\", {\r\n            createdBy: \"2sic internet solutions\",\r\n            license: \"MIT\"\r\n            })             \r\n    ;  \r\n}()); \n(function() {\r\n\r\n    contentTypeEditController.$inject = [\"appId\", \"item\", \"contentTypeSvc\", \"debugState\", \"$translate\", \"$modalInstance\"];\r\n    angular.module(\"ContentTypesApp\")\r\n        .controller(\"Edit\", contentTypeEditController);\r\n\r\n    /// Edit or add a content-type\r\n    /// Note that the svc can also be null if you don't already have it, the system will then create its own\r\n    function contentTypeEditController(appId, item, contentTypeSvc, debugState, $translate, $modalInstance) {\r\n        var vm = this;\r\n        var svc = contentTypeSvc(appId);\r\n\r\n        vm.debug = debugState;\r\n\r\n        vm.item = item;\r\n        vm.item.ChangeStaticName = false;\r\n        vm.item.NewStaticName = vm.item.StaticName; // in case you really, really want to change it\r\n\r\n        vm.ok = function () {\r\n            svc.save(item).then(function() {\r\n                $modalInstance.close(vm.item);              \r\n            });\r\n        };\r\n\r\n        vm.close = function () {\r\n            $modalInstance.dismiss(\"cancel\");\r\n        };\r\n    }\r\n\r\n}());\n(function () {\r\n    /*jshint laxbreak:true */\r\n    contentTypeFieldEditController.$inject = [\"appId\", \"svc\", \"item\", \"$filter\", \"$modalInstance\"];\r\n    angular.module(\"ContentTypesApp\")\r\n        .controller(\"FieldEdit\", contentTypeFieldEditController)\r\n    ;\r\n\r\n    /// This is the main controller for adding a field\r\n    /// Add is a standalone dialog, showing 10 lines for new field names / types\r\n    function contentTypeFieldEditController(appId, svc, item, $filter, $modalInstance) {\r\n        var vm = this;\r\n\r\n        vm.items = [item];\r\n\r\n        vm.types = svc.types.liveList();\r\n\r\n        vm.allInputTypes = svc.getInputTypesList();\r\n\r\n        vm.resetSubTypes = function resetSubTypes(item) {\r\n            item.InputType = item.Type.toLowerCase() + \"-default\";\r\n        };\r\n\r\n        vm.ok = function () {\r\n            svc.updateInputType(vm.items[0]);\r\n            $modalInstance.close();\r\n        };\r\n\r\n        vm.close = function() { $modalInstance.dismiss(\"cancel\"); };\r\n    }\r\n}());\n(function () {\r\n    /*jshint laxbreak:true */\r\n    contentTypeFieldsAddController.$inject = [\"appId\", \"svc\", \"$filter\", \"$modalInstance\"];\r\n    angular.module(\"ContentTypesApp\")\r\n        .controller(\"FieldsAdd\", contentTypeFieldsAddController)\r\n    ;\r\n\r\n    /// This is the main controller for adding a field\r\n    /// Add is a standalone dialog, showing 10 lines for new field names / types\r\n    function contentTypeFieldsAddController(appId, svc, $filter, $modalInstance) {\r\n        var vm = this;\r\n\r\n        // prepare empty array of up to 10 new items to be added\r\n        var nw = svc.newItem;\r\n        vm.items = [nw(), nw(), nw(), nw(), nw(), nw(), nw(), nw(), nw(), nw()];\r\n\r\n        vm.item = svc.newItem();\r\n        vm.types = svc.types.liveList();\r\n\r\n        vm.allInputTypes = svc.getInputTypesList();\r\n        //svc.getInputTypes().then(function (result) {\r\n        //    function addToList(value, key) {\r\n        //        var item = {\r\n        //            dataType: value.Type.substring(0, value.Type.indexOf(\"-\")),\r\n        //            inputType: value.Type, \r\n        //            label: value.Label,\r\n        //            description: value.Description\r\n        //        };\r\n        //        vm.allInputTypes.push(item);\r\n        //    }\r\n\r\n        //    angular.forEach(result.data, addToList);\r\n\r\n        //    vm.allInputTypes = $filter(\"orderBy\")(vm.allInputTypes, [\"dataType\", \"inputType\"]);\r\n        //});\r\n\r\n        vm.resetSubTypes = function resetSubTypes(item) {\r\n            item.InputType = item.Type.toLowerCase() + \"-default\";\r\n        };\r\n\r\n        vm.ok = function () {\r\n            var items = vm.items;\r\n            var newList = [];\r\n            for (var c = 0; c < items.length; c++)\r\n                if (items[c].StaticName)\r\n                    newList.push(items[c]);\r\n            svc.addMany(newList, 0);\r\n            $modalInstance.close();\r\n        };\r\n\r\n        vm.close = function() { $modalInstance.dismiss(\"cancel\"); };\r\n    }\r\n}());\n/*jshint laxbreak:true */\r\n(function () {\r\n    contentTypeFieldListController.$inject = [\"appId\", \"contentTypeFieldSvc\", \"contentType\", \"$modalInstance\", \"$modal\", \"eavAdminDialogs\", \"$filter\", \"$translate\", \"eavConfig\"];\r\n    angular.module(\"ContentTypesApp\")\r\n        .controller(\"FieldList\", contentTypeFieldListController)\r\n    ;\r\n\r\n    /// The controller to manage the fields-list\r\n    function contentTypeFieldListController(appId, contentTypeFieldSvc, contentType, $modalInstance, $modal, eavAdminDialogs, $filter, $translate, eavConfig) {\r\n        var vm = this;\r\n        var svc = contentTypeFieldSvc(appId, contentType);\r\n\r\n        // to close this dialog\r\n        vm.close = function () {\r\n            $modalInstance.dismiss(\"cancel\");\r\n        };\r\n\r\n        vm.items = svc.liveList();\r\n\r\n        // Open an add-dialog, and add them if the dialog is closed\r\n        vm.add = function add() {\r\n            $modal.open({\r\n                animation: true,\r\n                templateUrl: \"content-types/content-types-fields-add.html\",\r\n                controller: \"FieldsAdd\",\r\n                controllerAs: \"vm\",\r\n                size: \"lg\",\r\n                resolve: {\r\n                    svc: function() { return svc; }\r\n                }\r\n            });\r\n        };\r\n\r\n        vm.edit = function edit(item) {\r\n            $modal.open({\r\n                animation: true,\r\n                templateUrl: \"content-types/content-types-field-edit.html\",\r\n                controller: \"FieldEdit\",\r\n                controllerAs: \"vm\",\r\n                size: \"lg\",\r\n                resolve: {\r\n                    svc: function() { return svc; },\r\n                    item: function() { return item; }\r\n                }\r\n            });\r\n\r\n        };\r\n\r\n        vm.inputTypeTooltip = function(inputType) {\r\n            if (inputType !== \"unknown\")\r\n                return inputType;\r\n\r\n            return \"unknown means it's using an old definition for input-types - edit it to use the new definition\";\r\n        };\r\n\r\n        // Actions like moveUp, Down, Delete, Title\r\n        vm.moveUp = svc.moveUp;\r\n        vm.moveDown = svc.moveDown;\r\n        vm.setTitle = svc.setTitle;\r\n\r\n        vm.tryToDelete = function tryToDelete(item) {\r\n            if (item.IsTitle) \r\n                return $translate([\"General.Messages.CantDelete\", \"General.Terms.Title\"], {target:\"{0}\"}).then(function (translations) {\r\n                    alert(translations[\"General.Messages.CantDelete\"].replace(\"{0}\", translations[\"General.Terms.Title\"]));\r\n                });\r\n\r\n            $translate(\"General.Questions.Delete\", { target: \"'\" + item.StaticName + \"' (\" + item.Id + \")\" }).then(function(msg) {\r\n                if (confirm(msg))\r\n                    svc.delete(item);\r\n            });\r\n        };\r\n\r\n        // Edit / Add metadata to a specific fields\r\n        vm.createOrEditMetadata = function createOrEditMetadata(item, metadataType) {\r\n            // assemble an array of 2 items for editing\r\n            var items = [vm.createItemDefinition(item, \"All\"),\r\n                vm.createItemDefinition(item, metadataType),\r\n                vm.createItemDefinition(item, item.InputType),\r\n            ];\r\n            eavAdminDialogs.openEditItems(items, svc.liveListReload);\r\n        };\r\n\r\n        vm.createItemDefinition = function createItemDefinition(item, metadataType) {\r\n            var title = metadataType === \"All\" ? $translate.instant(\"DataType.All.Title\") : metadataType; \r\n            return item.Metadata[metadataType] !== undefined\r\n                ? { EntityId: item.Metadata[metadataType].Id, Title: title }  // if defined, return the entity-number to edit\r\n                : {\r\n                    ContentTypeName: \"@\" + metadataType,        // otherwise the content type for new-assegnment\r\n                    Metadata: {\r\n                        Key: item.Id,\r\n                        KeyType: \"number\",\r\n                        TargetType: eavConfig.metadataOfAttribute\r\n                    },\r\n                    Title: title,\r\n                    Prefill: { Name: item.StaticName }\r\n                };      \r\n        };\r\n    }\r\n\r\n}());\n(function() {\r\n\r\n    contentTypeListController.$inject = [\"contentTypeSvc\", \"eavAdminDialogs\", \"appId\", \"debugState\", \"$translate\"];\r\n    angular.module(\"ContentTypesApp\")\r\n        .controller(\"List\", contentTypeListController);\r\n\r\n\r\n    /// Manage the list of content-types\r\n    function contentTypeListController(contentTypeSvc, eavAdminDialogs, appId, debugState, $translate) {\r\n        var vm = this;\r\n        var svc = contentTypeSvc(appId);\r\n\r\n        vm.debug = debugState;\r\n\r\n        vm.items = svc.liveList();\r\n        vm.refresh = svc.liveListReload;\r\n\r\n        vm.tryToDelete = function tryToDelete(item) {\r\n            $translate(\"General.Questions.Delete\", { target: \"'\" + item.Name + \"' (\" + item.Id + \")\"}).then(function(msg) {\r\n                if(confirm(msg))\r\n                    svc.delete(item);\r\n            });\r\n        };\r\n\r\n        vm.edit = function edit(item) {\r\n            if (item === undefined)\r\n                item = svc.newItem();\r\n\r\n            eavAdminDialogs.openContentTypeEdit(item, vm.refresh);\r\n        };\r\n\r\n        vm.createGhost = function createGhost() {\r\n            var sourceName = window.prompt(\"to create a ghost content-type enter source static name / id - this is a very advanced operation - read more about it on 2sxc.org/help?tag=ghost\");\r\n            if (!sourceName)\r\n                return;\r\n            svc.createGhost(sourceName);\r\n        };\r\n\r\n        vm.editFields = function editFields(item) {\r\n            eavAdminDialogs.openContentTypeFields(item, vm.refresh);\r\n        };\r\n\r\n        vm.editItems = function editItems(item) {\r\n            eavAdminDialogs.openContentItems(svc.appId, item.StaticName, item.Id, vm.refresh);\r\n        };\r\n\r\n        vm.addItem = function(contentType) {\r\n            eavAdminDialogs.openItemNew(contentType, vm.refresh);\r\n        };\r\n\r\n\r\n        vm.liveEval = function admin() {\r\n            $translate(\"General.Questions.SystemInput\").then(function (msg) {\r\n                var inp = prompt(msg);\r\n                if(inp)\r\n                    eval(inp); // jshint ignore:line\r\n            });\r\n        };\r\n\r\n        // this is to change the scope of the items being shown\r\n        vm.changeScope = function admin() {\r\n            $translate(\"ContentTypes.Buttons.ChangeScopeQuestion\").then(function (msg) {\r\n                var inp = prompt(msg);\r\n                if (inp)\r\n                    svc.setScope(inp);\r\n            });\r\n        };\r\n\r\n        vm.isGuid = function isGuid(txtToTest) {\r\n            var patt = new RegExp(/[a-f0-9]{8}(?:-[a-f0-9]{4}){3}-[a-f0-9]{12}/i);\r\n            return patt.test(txtToTest); // note: can't use the txtToTest.match because it causes infinite digest cycles\r\n        };\r\n\r\n        vm.permissions = function permissions(item) {\r\n            return eavAdminDialogs.openPermissionsForGuid(svc.appId, item.StaticName, vm.refresh);\r\n        };\r\n\r\n        vm.openExport = function openExport(item) {\r\n            return eavAdminDialogs.openContentExport(svc.appId, item.StaticName, vm.refresh);\r\n        };\r\n\r\n        vm.openImport = function openImport(item) {\r\n            return eavAdminDialogs.openContentImport(svc.appId, item.StaticName, vm.refresh);\r\n        };\r\n\r\n    }\r\n\r\n\r\n}());\n\r\n(function () {\r\n    /* jshint laxbreak:true*/\r\n\r\nangular.module(\"EavDirectives\", [])\r\n    .directive(\"icon\", function() {\r\n        return {\r\n            restrict: \"A\",\r\n            replace: false,\r\n            transclude: false,\r\n            link: function postLink(scope, elem, attrs) {\r\n                var icn = attrs.icon;\r\n                elem.addClass(\"glyphicon glyphicon-\" + icn);\r\n            }\r\n        };\r\n    })\r\n    .directive('stopEvent', function() {\r\n        return {\r\n            restrict: 'A',\r\n            link: function(scope, element, attr) {\r\n                if (attr && attr.stopEvent)\r\n                    element.bind(attr.stopEvent, function(e) {\r\n                        e.stopPropagation();\r\n                    });\r\n            }\r\n        };\r\n    })\r\n    .directive('showDebugAvailability', function() {\r\n        return {\r\n            restrict: 'E',\r\n            template: \"<span class=\\\"low-priority\\\" tooltip=\\\"{{ 'AdvancedMode.Info.Available' | translate }}\\\">\"\r\n                + \"&pi;\" // \"<i icon=\\\"sunglasses\\\"></i>\"\r\n                + \"</span><br/>\"\r\n        };\r\n    })\r\n\r\n    ;\r\n\r\n\r\n})();\n(function () { \r\n\r\n    permissionListController.$inject = [\"permissionsSvc\", \"eavAdminDialogs\", \"eavConfig\", \"appId\", \"targetGuid\", \"$modalInstance\"];\r\n    angular.module(\"PermissionsApp\", [\r\n        \"EavServices\",\r\n        \"EavConfiguration\",\r\n        \"EavAdminUi\"])\r\n        .controller(\"PermissionList\", permissionListController)\r\n        ;\r\n\r\n    function permissionListController(permissionsSvc, eavAdminDialogs, eavConfig, appId, targetGuid, $modalInstance /* $location */) {\r\n        var vm = this;\r\n        var svc = permissionsSvc(appId, targetGuid);\r\n\r\n        vm.edit = function edit(item) {\r\n            eavAdminDialogs.openItemEditWithEntityId(item.Id, svc.liveListReload);\r\n        };\r\n\r\n        vm.add = function add() {\r\n            eavAdminDialogs.openMetadataNew(appId, \"entity\", svc.PermissionTargetGuid, svc.ctName, svc.liveListReload);\r\n        };\r\n\r\n        vm.items = svc.liveList();\r\n        vm.refresh = svc.liveListReload;\r\n        \r\n        vm.tryToDelete = function tryToDelete(item) {\r\n            if (confirm(\"Delete '\" + item.Title + \"' (\" + item.Id + \") ?\"))\r\n                svc.delete(item.Id);\r\n        };\r\n\r\n        vm.close = function () {\r\n            $modalInstance.dismiss(\"cancel\");\r\n        };\r\n    }\r\n\r\n} ());\nangular.module(\"PipelineDesigner\", [\r\n        \"PipelineDesigner.filters\",\r\n        \"ngResource\",\r\n        \"EavConfiguration\",\r\n        \"EavServices\",\r\n        \"eavTemplates\",\r\n        \"eavNgSvcs\",\r\n        \"EavAdminUi\"\r\n    ])\r\n\r\n// datasource directive makes an element a DataSource with jsPlumb\r\n    .directive(\"datasource\", [\"$timeout\", function($timeout) {\r\n        return {\r\n            restrict: \"A\",\r\n            link: function(scope, element) {\r\n                // make this a DataSource when the DOM is ready\r\n                $timeout(function() {\r\n                    scope.makeDataSource(scope.dataSource, element);\r\n                });\r\n                if (scope.$last === true) {\r\n                    $timeout(function() {\r\n                        scope.$emit(\"ngRepeatFinished\");\r\n                    });\r\n                }\r\n            }\r\n        };\r\n    }]);\r\n\r\n// Filters for \"ClassName, AssemblyName\"\r\nangular.module(\"PipelineDesigner.filters\", []).filter(\"typename\", function () {\r\n\treturn function (input, format) {\r\n\t\tvar globalParts = input.match(/[^,\\s]+/g);\r\n\r\n\t\tswitch (format) {\r\n\t\t\tcase \"classFullName\":\r\n\t\t\t\tif (globalParts)\r\n\t\t\t\t    return globalParts[0];\r\n\t\t\t    break;\r\n\t\t\tcase \"className\":\r\n\t\t\t\tif (globalParts) {\r\n\t\t\t\t\tvar classFullName = globalParts[0].match(/[^\\.]+/g);\r\n\t\t\t\t\treturn classFullName[classFullName.length - 1];\r\n\t\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn input;\r\n\t};\r\n});\n// AngularJS Controller for the >>>> Pipeline Designer\r\n\r\n(function () {\r\n    /*jshint laxbreak:true */\r\n\r\n    // helper method because we don't have jQuery any more to find the offset\r\n    function getElementOffset(element) {\r\n        var de = document.documentElement;\r\n        var box = element.getBoundingClientRect();\r\n        var top = box.top + window.pageYOffset - de.clientTop;\r\n        var left = box.left + window.pageXOffset - de.clientLeft;\r\n        return { top: top, left: left };\r\n    }\r\n\r\n    angular.module(\"PipelineDesigner\")\r\n        .controller(\"PipelineDesignerController\",\r\n            [\"appId\", \"pipelineId\", \"$scope\", \"pipelineService\", \"$location\", \"debugState\", \"$timeout\", \"ctrlS\", \"$filter\", \"toastrWithHttpErrorHandling\", \"eavAdminDialogs\", \"$log\", \"eavConfig\", \"$q\", function (appId, pipelineId, $scope, pipelineService, $location, debugState, $timeout, ctrlS, $filter, toastrWithHttpErrorHandling, eavAdminDialogs, $log, eavConfig, $q) {\r\n                \"use strict\";\r\n                var vm = this;\r\n                // Init\r\n                vm.debug = debugState;\r\n                var toastr = toastrWithHttpErrorHandling;\r\n                var waitMsg = toastr.info(\"This shouldn't take long\", \"Please wait...\");\r\n\r\n                function activate() {\r\n                    // add ctrl+s to save\r\n                    vm.saveShortcut = ctrlS(function() { vm.savePipeline(); });\r\n                }\r\n                activate();\r\n\r\n\r\n                $scope.readOnly = true;\r\n                $scope.dataSourcesCount = 0;\r\n                $scope.dataSourceIdPrefix = \"dataSource_\";\r\n                $scope.debug = false;\r\n\r\n                // Load Pipeline Data\r\n                $scope.PipelineEntityId = pipelineId;\r\n\r\n                pipelineService.setAppId(appId);\r\n\r\n                // this will retrieve the dataSource info-object for a DOM element\r\n                $scope.findDataSourceOfElement = function fdsog(element) {\r\n                    var guid = element.attributes.guid.value;\r\n                    var list = $scope.pipelineData.DataSources;\r\n                    var found = $filter(\"filter\")(list, { EntityGuid: guid })[0];\r\n                    return found;\r\n                };\r\n\r\n                // Get Data from PipelineService (Web API)\r\n                pipelineService.getPipeline($scope.PipelineEntityId)\r\n                    .then(function(success) {\r\n                        $scope.pipelineData = success;\r\n\r\n                        // If a new (empty) Pipeline is made, init new Pipeline\r\n                        if (!$scope.PipelineEntityId || $scope.pipelineData.DataSources.length === 1) {\r\n                            $scope.readOnly = false;\r\n                            initNewPipeline();\r\n                        } else {\r\n                            // if read only, show message\r\n                            $scope.readOnly = !success.Pipeline.AllowEdit;\r\n                            toastr.clear(waitMsg);\r\n                            toastr.info($scope.readOnly ? \"This pipeline is read only\" : \"You can now design the Pipeline. \\nNote that there are still a few UI bugs.\\nVisit 2sxc.org/help for more.\",\r\n                                \"Ready\", { autoDismiss: true });\r\n                        }\r\n                    }, function(reason) {\r\n                        toastr.error(reason, \"Loading Pipeline failed\");\r\n                    });\r\n\r\n\r\n                // init new jsPlumb Instance\r\n                jsPlumb.ready(function () {\r\n\r\n                    $scope.jsPlumbInstance = jsPlumb.getInstance({\r\n                        Connector: [\"Bezier\", { curviness: 70 }],\r\n                        HoverPaintStyle: {\r\n                            lineWidth: 4,\r\n                            strokeStyle: \"#216477\",\r\n                            outlineWidth: 2,\r\n                            outlineColor: \"white\"\r\n                        },\r\n                        PaintStyle: {\r\n                            lineWidth: 4,\r\n                            strokeStyle: \"#61B7CF\",\r\n                            joinstyle: \"round\",\r\n                            outlineColor: \"white\",\r\n                            outlineWidth: 2\r\n                        },\r\n                        Container: \"pipelineContainer\"\r\n                    });\r\n\r\n\r\n                    // If connection on Out-DataSource was removed, remove custom Endpoint\r\n                    $scope.jsPlumbInstance.bind(\"connectionDetached\", function(info) {\r\n                        if (info.targetId === $scope.dataSourceIdPrefix + \"Out\") {\r\n                            var element = angular.element(info.target);\r\n                            var fixedEndpoints = $scope.findDataSourceOfElement(element) /* element.scope() */.dataSource.Definition().In;\r\n                            var label = info.targetEndpoint.getOverlay(\"endpointLabel\").label;\r\n                            if (fixedEndpoints.indexOf(label) === -1) {\r\n                                $timeout(function() {\r\n                                    $scope.jsPlumbInstance.deleteEndpoint(info.targetEndpoint);\r\n                                });\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                    // If a new connection is created, ask for a name of the In-Stream\r\n                    $scope.jsPlumbInstance.bind(\"connection\", function(info) {\r\n                        if (!$scope.connectionsInitialized) return;\r\n\r\n                        // Repeat until a valid Stream-Name is provided by the user\r\n                        var repeatCount = 0;\r\n                        var endpointHandling = function(endpoint) {\r\n                            var label = endpoint.getOverlay(\"endpointLabel\").getLabel();\r\n                            if (label === labelPrompt && info.targetEndpoint.id !== endpoint.id && angular.element(endpoint.canvas).hasClass(\"targetEndpoint\"))\r\n                                targetEndpointHavingSameLabel = endpoint;\r\n                        };\r\n                        while (true) {\r\n                            repeatCount++;\r\n\r\n                            var promptMessage = \"Please name the Stream\";\r\n                            if (repeatCount > 1)\r\n                                promptMessage += \". Ensure the name is not used by any other Stream on this DataSource.\";\r\n\r\n                            var endpointLabel = info.targetEndpoint.getOverlay(\"endpointLabel\");\r\n                            var labelPrompt = prompt(promptMessage, endpointLabel.getLabel());\r\n                            if (labelPrompt)\r\n                                endpointLabel.setLabel(labelPrompt);\r\n                            else\r\n                                continue;\r\n\r\n                            // Check if any other Target-Endpoint has the same Stream-Name (Label)\r\n                            var endpoints = $scope.jsPlumbInstance.getEndpoints(info.target.id);\r\n                            var targetEndpointHavingSameLabel = null;\r\n\r\n                            angular.forEach(endpoints, endpointHandling);\r\n                            if (targetEndpointHavingSameLabel)\r\n                                continue;\r\n\r\n                            break;\r\n                        }\r\n                    });\r\n                });\r\n\r\n                // #region jsPlumb Endpoint Definitions\r\n                var getEndpointOverlays = function(isSource) {\r\n                    return [\r\n                        [\r\n                            \"Label\", {\r\n                                id: \"endpointLabel\",\r\n                                location: [0.5, isSource ? -0.5 : 1.5],\r\n                                label: \"Default\",\r\n                                cssClass: isSource ? \"endpointSourceLabel\" : \"endpointTargetLabel\",\r\n                                events: {\r\n                                    dblclick: function(labelOverlay) {\r\n                                        if ($scope.readOnly) return;\r\n\r\n                                        var newLabel = prompt(\"Rename Stream\", labelOverlay.label);\r\n                                        if (newLabel)\r\n                                            labelOverlay.setLabel(newLabel);\r\n                                    }\r\n                                }\r\n                            }\r\n                        ]\r\n                    ];\r\n                };\r\n\r\n                // the definition of source endpoints (the small blue ones)\r\n                var sourceEndpoint = {\r\n                    paintStyle: { fillStyle: \"transparent\", radius: 10, lineWidth: 0 },\r\n                    cssClass: \"sourceEndpoint\",\r\n                    maxConnections: -1,\r\n                    isSource: true,\r\n                    anchor: [\"Continuous\", { faces: [\"top\"] }],\r\n                    overlays: getEndpointOverlays(true)\r\n                };\r\n\r\n                // the definition of target endpoints (will appear when the user drags a connection) \r\n                var targetEndpoint = {\r\n                    paintStyle: { fillStyle: \"transparent\", radius: 10, lineWidth: 0 },\r\n                    cssClass: \"targetEndpoint\",\r\n                    maxConnections: 1,\r\n                    isTarget: true,\r\n                    anchor: [\"Continuous\", { faces: [\"bottom\"] }],\r\n                    overlays: getEndpointOverlays(false),\r\n                    dropOptions: { hoverClass: \"hover\", activeClass: \"active\" }\r\n                };\r\n                // #endregion\r\n\r\n                // make a DataSource with Endpoints, called by the datasource-Directive (which uses a $timeout)\r\n                $scope.makeDataSource = function(dataSource, element) {\r\n                    // suspend drawing and initialise\r\n                \t$scope.jsPlumbInstance.batch(function () {\r\n\r\n                \t\t// make DataSources draggable. Must happen before makeSource()!\r\n                \t\tif (!$scope.readOnly) {\r\n                \t\t\t$scope.jsPlumbInstance.draggable(element, {\r\n                \t\t\t\tgrid: [20, 20],\r\n                \t\t\t\tdrag: $scope.dataSourceDrag\r\n                \t\t\t});\r\n                \t\t}\r\n\r\n                        // Add Out- and In-Endpoints from Definition\r\n                        var dataSourceDefinition = dataSource.Definition();\r\n                        if (dataSourceDefinition !== null) {\r\n                            // Add Out-Endpoints\r\n                            angular.forEach(dataSourceDefinition.Out, function(name) {\r\n                                addEndpoint(element, name, false);\r\n                            });\r\n                            // Add In-Endpoints\r\n                            angular.forEach(dataSourceDefinition.In, function(name) {\r\n                                addEndpoint(element, name, true);\r\n                            });\r\n                            // make the DataSource a Target for new Endpoints (if .In is an Array)\r\n                            if (dataSourceDefinition.In) {\r\n                                var targetEndpointUnlimited = targetEndpoint;\r\n                                targetEndpointUnlimited.maxConnections = -1;\r\n                                $scope.jsPlumbInstance.makeTarget(element, targetEndpointUnlimited);\r\n                            }\r\n\r\n                            $scope.jsPlumbInstance.makeSource(element, sourceEndpoint, { filter: \".ep .glyphicon\" });\r\n                        }\r\n\r\n                        \r\n                    });\r\n\r\n                    $scope.dataSourcesCount++;\r\n                };\r\n\r\n                // Add a jsPlumb Endpoint to an Element\r\n                var addEndpoint = function(element, name, isIn) {\r\n                    if (!element.length) {\r\n                        $log.error({ message: \"Element not found\", selector: element.selector });\r\n                        return;\r\n                    }\r\n                    console.log(element);\r\n\r\n                    var dataSource = $scope.findDataSourceOfElement(element[0]);\r\n\r\n                    var uuid = element[0].id + (isIn ? \"_in_\" : \"_out_\") + name;\r\n                    // old - using jQuery - var uuid = element.attr(\"id\") + (isIn ? \"_in_\" : \"_out_\") + name;\r\n                    var params = {\r\n                        uuid: uuid,\r\n                        enabled: !dataSource.ReadOnly || dataSource.EntityGuid == \"Out\" // Endpoints on Out-DataSource must be always enabled\r\n                    };\r\n                    var endPoint = $scope.jsPlumbInstance.addEndpoint(element, (isIn ? targetEndpoint : sourceEndpoint), params);\r\n                    endPoint.getOverlay(\"endpointLabel\").setLabel(name);\r\n                };\r\n\r\n                // Initialize jsPlumb Connections once after all DataSources were created in the DOM\r\n                $scope.connectionsInitialized = false;\r\n                $scope.$on(\"ngRepeatFinished\", function() {\r\n                    if ($scope.connectionsInitialized) return;\r\n\r\n                    // suspend drawing and initialise\r\n                    $scope.jsPlumbInstance.batch(function() {\r\n                        initWirings($scope.pipelineData.Pipeline.StreamWiring);\r\n                    });\r\n                    $scope.repaint(); // repaint so continuous connections are aligned correctly\r\n\r\n                    $scope.connectionsInitialized = true;\r\n                });\r\n\r\n\r\n                var initWirings = function(streamWiring) {\r\n                    angular.forEach(streamWiring, function(wire) {\r\n                        // read connections from Pipeline\r\n                        var sourceElementId = $scope.dataSourceIdPrefix + wire.From;\r\n                        var fromUuid = sourceElementId + \"_out_\" + wire.Out;\r\n                        var targetElementId = $scope.dataSourceIdPrefix + wire.To;\r\n                        var toUuid = targetElementId + \"_in_\" + wire.In;\r\n\r\n                        // Ensure In- and Out-Endpoint exist\r\n                        if (!$scope.jsPlumbInstance.getEndpoint(fromUuid))\r\n                            addEndpoint(jsPlumb.getSelector(\"#\" + sourceElementId), wire.Out, false);\r\n                        if (!$scope.jsPlumbInstance.getEndpoint(toUuid))\r\n                            addEndpoint(jsPlumb.getSelector(\"#\" + targetElementId), wire.In, true);\r\n\r\n                        try {\r\n                            $scope.jsPlumbInstance.connect({ uuids: [fromUuid, toUuid] });\r\n                        } catch (e) {\r\n                            $log.error({ message: \"Connection failed\", from: fromUuid, to: toUuid });\r\n                        }\r\n                    });\r\n\r\n                    // $scope.jsPlumbInstance.getConnections\r\n\r\n                };\r\n\r\n                // Init a new Pipeline with DataSources and Wirings from Configuration\r\n                var initNewPipeline = function () {\r\n                    var templateForNew = eavConfig.pipelineDesigner.defaultPipeline.dataSources;\r\n                    angular.forEach(templateForNew, function(dataSource) {\r\n                        $scope.addDataSource(dataSource.partAssemblyAndType, dataSource.visualDesignerData, false, dataSource.entityGuid);\r\n                    });\r\n\r\n                    // Wait until all DataSources were created\r\n                    var initWiringsListener = $scope.$on(\"ngRepeatFinished\", function() {\r\n                        $scope.connectionsInitialized = false;\r\n                        initWirings(eavConfig.pipelineDesigner.defaultPipeline.streamWiring);\r\n                        $scope.connectionsInitialized = true;\r\n\r\n                        initWiringsListener(); // unbind the Listener\r\n                    });\r\n                };\r\n\r\n                // Add new DataSource\r\n                $scope.addDataSource = function(partAssemblyAndType, visualDesignerData, autoSave, entityGuid) {\r\n                    if (!partAssemblyAndType) {\r\n                        partAssemblyAndType = $scope.addDataSourceType.PartAssemblyAndType;\r\n                        $scope.addDataSourceType = null;\r\n                    }\r\n                    if (!visualDesignerData)\r\n                        visualDesignerData = { Top: 100, Left: 100 };\r\n\r\n                    var newDataSource = {\r\n                        VisualDesignerData: visualDesignerData,\r\n                        Name: $filter(\"typename\")(partAssemblyAndType, \"className\"),\r\n                        Description: \"\",\r\n                        PartAssemblyAndType: partAssemblyAndType,\r\n                        EntityGuid: entityGuid || \"unsaved\" + ($scope.dataSourcesCount + 1)\r\n                    };\r\n                    // Extend it with a Property to it's Definition\r\n                    newDataSource = angular.extend(newDataSource, pipelineService.getNewDataSource($scope.pipelineData, newDataSource));\r\n\r\n                    $scope.pipelineData.DataSources.push(newDataSource);\r\n\r\n                    if (autoSave !== false)\r\n                        $scope.savePipeline();\r\n                };\r\n\r\n                // Delete a DataSource\r\n                $scope.remove = function(index) {\r\n                    var dataSource = $scope.pipelineData.DataSources[index];\r\n                    if (!confirm(\"Delete DataSource \\\"\" + (dataSource.Name || \"(unnamed)\") + \"\\\"?\")) return;\r\n                    var elementId = $scope.dataSourceIdPrefix + dataSource.EntityGuid;\r\n                    $scope.jsPlumbInstance.selectEndpoints({ element: elementId }).remove();\r\n                    $scope.pipelineData.DataSources.splice(index, 1);\r\n                };\r\n\r\n                // Edit name of a DataSource\r\n                $scope.editName = function(dataSource) {\r\n                    if (dataSource.ReadOnly) return;\r\n\r\n                    var newName = prompt(\"Rename DataSource\", dataSource.Name);\r\n                    if (newName && newName.trim())\r\n                        dataSource.Name = newName.trim();\r\n                };\r\n\r\n                // Edit Description of a DataSource\r\n                $scope.editDescription = function(dataSource) {\r\n                    if (dataSource.ReadOnly) return;\r\n\r\n                    var newDescription = prompt(\"Edit Description\", dataSource.Description);\r\n                    if (newDescription && newDescription.trim())\r\n                        dataSource.Description = newDescription.trim();\r\n                };\r\n\r\n                // Update DataSource Position on Drag\r\n                $scope.dataSourceDrag = function(draggedWrapper) {\r\n                    var offset = getElementOffset(draggedWrapper.el);\r\n                    var dataSource = $scope.findDataSourceOfElement(draggedWrapper.el);\r\n                    $scope.$apply(function() {\r\n                        dataSource.VisualDesignerData.Top = Math.round(offset.top);\r\n                        dataSource.VisualDesignerData.Left = Math.round(offset.left);\r\n                    });\r\n                };\r\n\r\n                // Configure a DataSource\r\n                $scope.configureDataSource = function(dataSource) {\r\n                    if (dataSource.ReadOnly) return;\r\n\r\n                    // Ensure dataSource Entity is saved\r\n                    if (!dataSourceIsPersisted(dataSource)) {\r\n                        $scope.savePipeline();\r\n                        return;\r\n                    }\r\n\r\n                    pipelineService.editDataSourcePart(dataSource);\r\n\r\n                };\r\n\r\n                // Test wether a DataSource is persisted on the Server\r\n                var dataSourceIsPersisted = function(dataSource) {\r\n                    return dataSource.EntityGuid.indexOf(\"unsaved\") === -1;\r\n                };\r\n\r\n                // Show/Hide Endpoint Overlays\r\n                $scope.showEndpointOverlays = true;\r\n                $scope.toggleEndpointOverlays = function() {\r\n                    $scope.showEndpointOverlays = !$scope.showEndpointOverlays;\r\n\r\n                    var endpoints = $scope.jsPlumbInstance.selectEndpoints();\r\n                    if ($scope.showEndpointOverlays)\r\n                        endpoints.showOverlays();\r\n                    else\r\n                        endpoints.hideOverlays();\r\n                };\r\n\r\n                // Edit Pipeline Entity\r\n                $scope.editPipelineEntity = function() {\r\n                    // save Pipeline, then open Edit Dialog\r\n                    $scope.savePipeline().then(function() {\r\n                        vm.saveShortcut.unbind();\r\n                        eavAdminDialogs.openEditItems([{ EntityId: $scope.PipelineEntityId }], function() {\r\n                            pipelineService.getPipeline($scope.PipelineEntityId)\r\n                                .then(pipelineSaved)\r\n                                .then(vm.saveShortcut.rebind);\r\n                        });\r\n\r\n                    });\r\n                };\r\n\r\n                // Sync jsPlumb Connections and StreamsOut to the pipelineData-Object\r\n                var syncPipelineData = function() {\r\n                    var connectionInfos = [];\r\n                    angular.forEach($scope.jsPlumbInstance.getAllConnections(), function(connection) {\r\n                        connectionInfos.push({\r\n                            From: connection.sourceId.substr($scope.dataSourceIdPrefix.length),\r\n                            Out: connection.endpoints[0].getOverlay(\"endpointLabel\").label,\r\n                            To: connection.targetId.substr($scope.dataSourceIdPrefix.length),\r\n                            In: connection.endpoints[1].getOverlay(\"endpointLabel\").label\r\n                        });\r\n                    });\r\n                    $scope.pipelineData.Pipeline.StreamWiring = connectionInfos;\r\n\r\n                    var streamsOut = [];\r\n                    $scope.jsPlumbInstance.selectEndpoints({ target: $scope.dataSourceIdPrefix + \"Out\" }).each(function(endpoint) {\r\n                        streamsOut.push(endpoint.getOverlay(\"endpointLabel\").label);\r\n                    });\r\n                    $scope.pipelineData.Pipeline.StreamsOut = streamsOut.join(\",\");\r\n                };\r\n\r\n                // #region Save Pipeline\r\n                // Save Pipeline\r\n                // returns a Promise about the saving state\r\n                vm.savePipeline = $scope.savePipeline = function (successHandler) {\r\n                    var waitMsg = toastr.info(\"This shouldn't take long\", \"Saving...\");\r\n                    $scope.readOnly = true;\r\n\r\n                    syncPipelineData();\r\n\r\n                    var deferred = $q.defer();\r\n\r\n                    if (typeof successHandler == \"undefined\") // set default success Handler\r\n                        successHandler = pipelineSaved;\r\n\r\n                    pipelineService.savePipeline($scope.pipelineData.Pipeline, $scope.pipelineData.DataSources).then(successHandler, function(reason) {\r\n                        toastr.error(reason, \"Save Pipeline failed\");\r\n                        $scope.readOnly = false;\r\n                        deferred.reject();\r\n                    }).then(function() {\r\n                        deferred.resolve();\r\n                    });\r\n\r\n                    return deferred.promise;\r\n                };\r\n\r\n                // Handle Pipeline Saved, success contains the updated Pipeline Data\r\n                var pipelineSaved = function(success) {\r\n                    // Update PipelineData with data retrieved from the Server\r\n                    $scope.pipelineData.Pipeline = success.Pipeline;\r\n                    $scope.PipelineEntityId = success.Pipeline.EntityId /*EntityId*/;\r\n                    $location.search(\"PipelineId\", success.Pipeline.EntityId /*EntityId*/);\r\n                    $scope.readOnly = !success.Pipeline.AllowEdit;\r\n                    $scope.pipelineData.DataSources = success.DataSources;\r\n                    pipelineService.postProcessDataSources($scope.pipelineData);\r\n\r\n                    toastr.clear();\r\n                    toastr.success(\"Pipeline \" + success.Pipeline.EntityId + \" saved and loaded\", \"Saved\", { autoDismiss: true });\r\n\r\n                    // Reset jsPlumb, re-Init Connections\r\n                    $scope.jsPlumbInstance.reset();\r\n                    $scope.connectionsInitialized = false;\r\n                };\r\n                // #endregion\r\n\r\n                // Repaint jsPlumb\r\n                $scope.repaint = function() {\r\n                    $scope.jsPlumbInstance.repaintEverything();\r\n                };\r\n\r\n                // Show/Hide Debug info\r\n                $scope.toogleDebug = function() {\r\n                    $scope.debug = !$scope.debug;\r\n                };\r\n\r\n                // Query the Pipeline\r\n                $scope.queryPipeline = function() {\r\n                    var query = function() {\r\n                        // Query pipelineService for the result...\r\n                        toastr.info(\"Running Query ...\");\r\n\r\n                        pipelineService.queryPipeline($scope.PipelineEntityId).then(function(success) {\r\n                            // Show Result in a UI-Dialog\r\n                            toastr.clear();\r\n\r\n                            var resolve = eavAdminDialogs.CreateResolve({ testParams: $scope.pipelineData.Pipeline.TestParameters, result: success });\r\n                            eavAdminDialogs.OpenModal(\"pipelines/query-stats.html\", \"QueryStats as vm\", \"lg\", resolve);\r\n\r\n                            $timeout(function() {\r\n                                showEntityCountOnStreams(success);\r\n                            });\r\n                            $log.debug(success);\r\n                        }, function(reason) {\r\n                            toastr.error(reason, \"Query failed\");\r\n                        });\r\n                    };\r\n\r\n\r\n                    var showEntityCountOnStreams = function(result) {\r\n                        angular.forEach(result.Streams, function(stream) {\r\n                            // Find jsPlumb Connection for the current Stream\r\n                            var sourceElementId = $scope.dataSourceIdPrefix + stream.Source;\r\n                            var targetElementId = $scope.dataSourceIdPrefix + stream.Target;\r\n                            if (stream.Target === \"00000000-0000-0000-0000-000000000000\")\r\n                                targetElementId = $scope.dataSourceIdPrefix + \"Out\";\r\n\r\n                            var fromUuid = sourceElementId + \"_out_\" + stream.SourceOut;\r\n                            var toUuid = targetElementId + \"_in_\" + stream.TargetIn;\r\n\r\n                            var sourceEndpoint = $scope.jsPlumbInstance.getEndpoint(fromUuid);\r\n                            var streamFound = false;\r\n                            if (sourceEndpoint) {\r\n                                angular.forEach(sourceEndpoint.connections, function(connection) {\r\n                                    if (connection.endpoints[1].getUuid() === toUuid) {\r\n                                        // when connection found, update it's label with the Entities-Count\r\n                                        connection.setLabel({\r\n                                            label: stream.Count.toString(),\r\n                                            cssClass: \"streamEntitiesCount\"\r\n                                        });\r\n                                        streamFound = true;\r\n                                        return;\r\n                                    }\r\n                                });\r\n                            }\r\n\r\n                            if (!streamFound)\r\n                                $log.error(\"Stream not found\", stream, sourceEndpoint);\r\n                        });\r\n                    };\r\n\r\n                    // Ensure the Pipeline is saved\r\n                    $scope.savePipeline().then(query);\r\n                };\r\n\r\n                // Clone the Pipeline\r\n                $scope.clonePipeline = function() {\r\n                    if (!confirm(\"Clone Pipeline \" + $scope.PipelineEntityId + \"?\")) return;\r\n\r\n                    // Clone and get new PipelineEntityId\r\n                    var clone = function() {\r\n                        return pipelineService.clonePipeline($scope.PipelineEntityId);\r\n                    };\r\n                    // Get the new Pipeline (Pipeline and DataSources)\r\n                    var getClonePipeline = function(success) {\r\n                        return pipelineService.getPipeline(success.EntityId /*EntityId*/);\r\n                    };\r\n\r\n                    // Save, clone, get clone, load clone\r\n                    $scope.savePipeline(null).then(clone).then(getClonePipeline).then(pipelineSaved);\r\n                };\r\n            }]);\r\n})();\n// Config and Controller for the Pipeline Management UI\r\nangular.module(\"PipelineManagement\", [\r\n    \"EavServices\",\r\n    \"EavConfiguration\",\r\n    \"eavNgSvcs\",\r\n    \"EavAdminUi\"\r\n]).\r\n\tcontroller(\"PipelineManagement\", [\"$modalInstance\", \"appId\", \"pipelineService\", \"debugState\", \"eavAdminDialogs\", \"eavConfig\", function ($modalInstance, appId, pipelineService, debugState, eavAdminDialogs, eavConfig) {\r\n\t    var vm = this;\r\n        vm.debug = debugState;\r\n        vm.appId = appId;\r\n\r\n\t    pipelineService.setAppId(appId);\r\n\r\n        // 2016-02-18 2dm - probably not needed\r\n\t    // pipelineService.initContentTypes();\r\n\r\n\t    // 2016-01-14 2dm - commenting out completely, as the getPipelineUrl is probably not used any more\r\n\t    // Make URL-Provider available to the scope\r\n\t    // vm.getPipelineUrl = pipelineService.getPipelineUrl;\r\n\r\n\t    // Refresh List of Pipelines\r\n\t    vm.refresh = function () {\r\n\t        vm.pipelines = pipelineService.getPipelines(appId);\r\n\t    };\r\n\t    vm.refresh();\r\n\r\n\t    // Delete a Pipeline\r\n        vm.delete = function(pipeline) {\r\n            if (!confirm(\"Delete Pipeline \\\"\" + pipeline.Name + \"\\\" (\" + pipeline.Id + \")?\"))\r\n                return;\r\n\r\n            pipelineService.deletePipeline(pipeline.Id).then(function() {\r\n                vm.refresh();\r\n            }, function(reason) {\r\n                alert(reason);\r\n            });\r\n        };\r\n\r\n\t    // Clone a Pipeline\r\n        vm.clone = function(pipeline) {\r\n            pipelineService.clonePipeline(pipeline.Id).then(function() {\r\n                vm.refresh();\r\n            }, function(reason) {\r\n                alert(reason);\r\n            });\r\n        };\r\n\r\n        vm.permissions = function (item) {\r\n            return eavAdminDialogs.openPermissionsForGuid(appId, item.Guid);\r\n        };\r\n\r\n        vm.add = function add() {\r\n            var items = [{\r\n                    ContentTypeName: \"DataPipeline\",\r\n                    Prefill: { TestParameters: eavConfig.pipelineDesigner.testParameters }\r\n                }];\r\n            eavAdminDialogs.openEditItems(items, vm.refresh);\r\n        };\r\n\r\n        vm.edit = function edit(item) {\r\n            eavAdminDialogs.openItemEditWithEntityId(item.Id, vm.refresh);\r\n        }; \r\n\r\n        vm.design = function design(item) {\r\n            return eavAdminDialogs.editPipeline(vm.appId, item.Id, vm.refresh);\r\n        };\r\n        vm.liveEval = function admin() {\r\n            var inp = prompt(\"This is for very advanced operations. Only use this if you know what you're doing. \\n\\n Enter admin commands:\");\r\n            if (inp)\r\n                eval(inp); // jshint ignore:line\r\n        };\r\n        vm.close = function () { $modalInstance.dismiss(\"cancel\"); };\r\n    }]);\n/*jshint laxbreak:true */\r\n(function() {\r\n\r\n    angular.module(\"PipelineDesigner\")\r\n        .controller(\"QueryStats\", [\"testParams\", \"result\", \"$modalInstance\", function (testParams, result, $modalInstance) {\r\n                var vm = this;\r\n                var success = result;\r\n                vm.testParameters = testParams.split(\"\\n\");\r\n                vm.timeUsed = success.QueryTimer.Milliseconds;\r\n                vm.ticksUsed = success.QueryTimer.Ticks;\r\n                vm.result = success.Query;\r\n\r\n                vm.sources = success.Sources;\r\n                vm.streams = success.Streams;\r\n\r\n                vm.connections = \"todo\";\r\n\r\n\r\n                vm.close = function () {\r\n                    $modalInstance.dismiss(\"cancel\");\r\n                };\r\n\r\n            }]\r\n        );\r\n})();\n// Init the main eav services module\r\nangular.module(\"EavServices\", [\r\n    \"ng\",                   // Angular for $http etc.\r\n    \"EavConfiguration\",     // global configuration\r\n    \"pascalprecht.translate\",\r\n    \"ngResource\",           // only needed for the pipeline-service, maybe not necessary any more?\r\n    \"ngAnimate\",\r\n    \"toastr\"\r\n]);\n\r\nangular.module(\"EavServices\")\r\n    .factory(\"contentItemsSvc\", [\"$http\", \"entitiesSvc\", \"metadataSvc\", \"svcCreator\", function($http, entitiesSvc, metadataSvc, svcCreator) {\r\n            return function createContentItemsSvc(appId, contentType) {\r\n                var svc = {};\r\n                svc.contentType = contentType;\r\n\r\n                svc.appId = appId;\r\n\r\n                svc = angular.extend(svc, svcCreator.implementLiveList(function getAll() {\r\n                    return $http.get(\"eav/entities/GetAllOfTypeForAdmin\", { params: { appId: svc.appId, contentType: svc.contentType } });\r\n                }));\r\n                \r\n                // delete, then reload\r\n                svc.delete = function del(id) {\r\n                    return entitiesSvc.delete(svc.contentType, id) // for now must work with get :( - delete doesn't work well in dnn\r\n                        .then(svc.liveListReload);\r\n                };\r\n\r\n                // todo: should use the ContentTypeService instead\r\n                svc.getColumns = function getColumns() {\r\n                    return $http.get(\"eav/contenttype/getfields/\", { params: { \"appid\": svc.appId, \"staticName\": svc.contentType } });\r\n                };\r\n\r\n                return svc;\r\n            };\r\n        }]\r\n    );\n\r\nangular.module(\"EavServices\")\r\n    .factory(\"contentTypeSvc\", [\"$http\", \"eavConfig\", \"svcCreator\", function ($http, eavConfig, svcCreator) {\r\n        return function appSpecificContentTypeSvc(appId, scope) {\r\n            var svc = {};\r\n            svc.scope = scope || eavConfig.contentType.defaultScope;\r\n            svc.appId = appId;\r\n\r\n            svc.retrieveContentTypes = function typeListRetrieve() {\r\n                return $http.get(\"eav/contenttype/get/\", { params: { \"appid\": svc.appId, \"scope\": svc.scope } });\r\n            };\r\n\r\n            svc = angular.extend(svc, svcCreator.implementLiveList(svc.retrieveContentTypes));\r\n\r\n            svc.getDetails = function getDetails(contentTypeName) {\r\n                return $http.get(\"eav/contenttype/GetSingle\", { params: { \"appid\": svc.appId, \"contentTypeStaticName\": contentTypeName } });\r\n            };\r\n\r\n            svc.newItem = function newItem() {\r\n                return {\r\n                    StaticName: \"\",\r\n                    Name: \"\",\r\n                    Description: \"\",\r\n                    Scope: eavConfig.contentType.defaultScope\r\n                };\r\n            };\r\n\r\n            svc.save = function save(item) {\r\n                return $http.post(\"eav/contenttype/save/\", item, { params: { appid: svc.appId } })\r\n                    .then(svc.liveListReload);\r\n            };\r\n\r\n            svc.delete = function del(item) {\r\n                return $http.get(\"eav/contenttype/delete\", { params: { appid: svc.appId, staticName: item.StaticName } })\r\n                    .then(svc.liveListReload);\r\n            };\r\n\r\n            svc.setScope = function setScope(newScope) {\r\n                svc.scope = newScope;\r\n                svc.liveListReload();\r\n            };\r\n\r\n            svc.createGhost = function createGhost(sourceStaticName) {\r\n                return $http.get(\"eav/contenttype/createghost\", { params: { appid: svc.appId, sourceStaticName: sourceStaticName } })\r\n                    .then(svc.liveListReload);\r\n            };\r\n            return svc;\r\n        };\r\n\r\n    }]);\n\r\nangular.module(\"EavServices\")\r\n    .factory(\"contentTypeFieldSvc\", [\"$http\", \"eavConfig\", \"svcCreator\", \"$filter\", function($http, eavConfig, svcCreator, $filter) {\r\n        return function createFieldsSvc(appId, contentType) {\r\n            // start with a basic service which implement the live-list functionality\r\n            var svc = {};\r\n            svc.appId = appId;\r\n            svc.contentType = contentType;\r\n\r\n            svc.typeListRetrieve = function typeListRetrieve() {\r\n                return $http.get(\"eav/contenttype/datatypes/\", { params: { \"appid\": svc.appId } });\r\n            };\r\n\r\n            svc._inputTypesList = [];\r\n            svc.getInputTypesList = function getInputTpes() {\r\n                if (svc._inputTypesList.length > 0)\r\n                    return svc._inputTypesList;\r\n                $http.get(\"eav/contenttype/inputtypes/\", { params: { \"appid\": svc.appId } })\r\n                    .then(function(result) {\r\n                        function addToList(value, key) {\r\n                            var item = {\r\n                                dataType: value.Type.substring(0, value.Type.indexOf(\"-\")),\r\n                                inputType: value.Type,\r\n                                label: value.Label,\r\n                                description: value.Description\r\n                            };\r\n                            svc._inputTypesList.push(item);\r\n                        }\r\n\r\n                        angular.forEach(result.data, addToList);\r\n\r\n                        svc._inputTypesList = $filter(\"orderBy\")(svc._inputTypesList, [\"dataType\", \"inputType\"]);\r\n                    });\r\n                return svc._inputTypesList;\r\n            };\r\n\r\n\t        svc.getFields = function getFields() {\r\n\t            return $http.get(\"eav/contenttype/getfields\", { params: { \"appid\": svc.appId, \"staticName\": svc.contentType.StaticName } })\r\n\t            .then(function(result) {\r\n\t                // merge the settings into one, with correct priority sequence\r\n\t                if (result.data ) {\r\n\t                    for (var i = 0; i < result.data.length; i++) {\r\n\t                        var fld = result.data[i];\r\n\t                        if(!fld.Metadata)\r\n                                continue;\r\n\t                        var md = fld.Metadata;\r\n\t                        var allMd = md.All;\r\n\t                        var typeMd = md[fld.Type];\r\n\t                        var inputMd = md[fld.InputType];\r\n\t                        md.merged = angular.merge({}, allMd, typeMd, inputMd);\r\n\t                    }\r\n\t                }\r\n\t                    return result;\r\n\t                });\r\n\t        };\r\n\r\n            svc = angular.extend(svc, svcCreator.implementLiveList(svc.getFields));\r\n\r\n            svc.types = svcCreator.implementLiveList(svc.typeListRetrieve);\r\n\r\n\r\n            svc.moveUp = function moveUp(item) {\r\n                return $http.get(\"eav/contenttype/reorder\", { params: { appid: svc.appId, contentTypeId: svc.contentType.Id, attributeId: item.Id, direction: \"up\" } })\r\n                    .then(svc.liveListReload);\r\n            };\r\n            svc.moveDown = function moveDown(item) {\r\n                return $http.get(\"eav/contenttype/reorder\", { params: { appid: svc.appId, contentTypeId: svc.contentType.Id, attributeId: item.Id, direction: \"down\" } })\r\n                    .then(svc.liveListReload);\r\n            };\r\n\r\n            svc.delete = function del(item) {\r\n                return $http.get(\"eav/contenttype/delete\", { params: { appid: svc.appId, contentTypeId: svc.contentType.Id, attributeId: item.Id } })\r\n                    .then(svc.liveListReload);\r\n            };\r\n\r\n            svc.addMany = function add(items, count) {\r\n                return $http.get(\"eav/contenttype/addfield/\", { params: items[count] })\r\n                    .then(function() {\r\n                        if (items.length == ++count)\r\n                            svc.liveListReload();\r\n                        else\r\n                            svc.addMany(items, count);\r\n                    });\r\n            };\r\n\r\n            svc.add = function addOne(item) {\r\n                return $http.get(\"eav/contenttype/addfield/\", { params: item })\r\n                    .then(svc.liveListReload);\r\n            };\r\n\r\n            svc.newItemCount = 0;\r\n            svc.newItem = function newItem() {\r\n                return {\r\n                    AppId: svc.appId,\r\n                    ContentTypeId: svc.contentType.Id,\r\n                    Id: 0,\r\n                    Type: \"String\",\r\n                    InputType: \"string-default\",\r\n                    StaticName: \"\",\r\n                    IsTitle: svc.liveList().length === 0,\r\n                    SortOrder: svc.liveList().length + svc.newItemCount++\r\n                };\r\n            };\r\n\r\n\r\n            svc.delete = function del(item) {\r\n                if (item.IsTitle)\r\n                    throw \"Can't delete Title\";\r\n                return $http.get(\"eav/contenttype/deletefield\", { params: { appid: svc.appId, contentTypeId: svc.contentType.Id, attributeId: item.Id } })\r\n                    .then(svc.liveListReload);\r\n            };\r\n\r\n            svc.updateInputType = function updateInputType(item) {\r\n                return $http.get(\"eav/contenttype/updateinputtype\", { params: { appid: svc.appId, attributeId: item.Id, field: item.StaticName, inputType: item.InputType } })\r\n                    .then(svc.liveListReload);\r\n            };\r\n\r\n\r\n            svc.setTitle = function setTitle(item) {\r\n                return $http.get(\"eav/contenttype/setTitle\", { params: { appid: svc.appId, contentTypeId: svc.contentType.Id, attributeId: item.Id } })\r\n                    .then(svc.liveListReload);\r\n            };\r\n\r\n\r\n            return svc;\r\n        };\r\n    }]);\n/* \r\n * \r\n * Simple service which takes care of ctrl+S keyboard shortcuts. \r\n * use it as a service for your controller, then add a line like \r\n         function activate() {\r\n            // add ctrl+s to save\r\n            ctrlS.bind(function() { vm.save(false); });\r\n        }\r\n\r\n */\r\n\r\nangular.module(\"EavServices\")\r\n    .factory(\"ctrlS\", [\"$window\", function ($window) {\r\n\r\n        // Create a capture Ctrl+S and execute action-object\r\n        function createSave(action) {\r\n            var save = {\r\n                _event: null,\r\n                _action: null,\r\n                _isbound: false,\r\n\r\n                // this will be called on each keydown, will check if it was a ctrl+S\r\n                detectCtrlSAndExcecute: function(e) {\r\n                    if (e.keyCode === 83 && (navigator.platform.match(\"Mac\") ? e.metaKey : e.ctrlKey)) {\r\n                        if (save._action === null)\r\n                            return console.log(\"can't do anything on ctrl+S, no action registered\");\r\n                        e.preventDefault();\r\n                        save._action();\r\n                    }\r\n                },\r\n\r\n                bind: function bind(action) {\r\n                    save._action = action;\r\n                    save._isbound = true;\r\n                    save._event = $window.addEventListener(\"keydown\", save.detectCtrlSAndExcecute, false);\r\n\r\n                },\r\n\r\n                unbind: function unbind() {\r\n                    $window.removeEventListener(\"keydown\", save.detectCtrlSAndExcecute);\r\n                    save._isbound = false;\r\n                },\r\n\r\n                // re-attach Ctrl+S if it had already been attached previously\r\n                rebind: function rebind() {\r\n                    if (save._action === null)\r\n                        throw \"can't rebind, as it was never initially bound\";\r\n                    if (!save._isbound)\r\n                        throw \"can't rebind, as it's still bound\";\r\n                    save.bind(save._action);\r\n                }\r\n            };\r\n\r\n            save.bind(action);\r\n\r\n            return save;\r\n        }\r\n\r\n        return createSave;\r\n    }]);\n/* shared debugState = advancedMode\r\n * \r\n * vm.debug -> shows if in debug mode - bind ng-ifs to this\r\n * vm.maybeEnableDebug - a method which checks for ctrl+shift-click and if yes, changes debug state\r\n *\r\n * How to use\r\n * 1. add uiDebug to your controller dependencies like:    contentImportController(appId, ..., debugState, $modalInstance, $filter)\r\n * 2. add a line after creating your vm-object like:       vm.debug = debugState;\r\n * 3. add a click event as far out as possible on html:    <div ng-click=\"vm.debug.autoEnableAsNeeded($event)\">\r\n * 4. wrap your hidden stuff in an ng-if:                  <div ng-if=\"vm.debug.on\">\r\n *\r\n * Note that if you're using it in a directive you'll use $scope instead of vm, so the binding is different.\r\n * For example, instead of <div ng-if=\"vm.debug.on\"> you would write <div ng-if=\"debug.on\">\r\n */\r\n\r\nangular.module(\"EavServices\")\r\n    .factory(\"debugState\", [\"$translate\", \"toastr\", function ($translate, toastr) {\r\n        var svc = {\r\n            on: false\r\n        };\r\n\r\n        svc.toggle = function toggle() {\r\n            svc.on = !svc.on;\r\n            toastr.clear(svc.toast);\r\n            svc.toast = toastr.info($translate.instant(\"AdvancedMode.Info.Turn\" + (svc.on ? \"On\" : \"Off\")), { timeOut: 3000 });\r\n        };\r\n\r\n        svc.autoEnableAsNeeded = function (e) {\r\n            e = window.event || e;\r\n            var ctrlPressed = (navigator.platform.match(\"Mac\") ? e.metaKey : e.ctrlKey);//evt.ctrlKey;\r\n            if (ctrlPressed && !e.alreadySwitchedDebugState) {\r\n                svc.toggle();\r\n                e.alreadySwitchedDebugState = true;\r\n            }\r\n        };\r\n\r\n        return svc;\r\n    }]);\n// This service adds CSS classes to body when something is dragged onto the page\r\nangular.module(\"EavServices\")\r\n    .factory(\"dragClass\", function () {\r\n\r\n        document.addEventListener(\"dragover\", function() {\r\n            if(this === document)\r\n                document.body.classList.add(\"eav-dragging\");\r\n        });\r\n        document.addEventListener(\"dragleave\", function() {\r\n            if(this === document)\r\n                document.body.classList.remove(\"eav-dragging\");\r\n        });\r\n\r\n        return {};\r\n\r\n    });\r\n\n/*  this file contains a service to handle \r\n * How it works\r\n * This service tries to open a modal dialog if it can, otherwise a new window returning a promise to allow\r\n * ...refresh when the window close. \r\n * \r\n * In most cases there is a nice command to open something, like openItemEditWithEntityId(id, callback)\r\n * ...and there is also a more advanced version where you could specify more closely what you wanted\r\n * ...usually ending with an X, so like openItemEditWithEntityIdX(resolve, callbacks)\r\n * \r\n * the simple callback is 1 function (usually to refresh the main list), the complex callbacks have the following structure\r\n * 1. .success (optional)\r\n * 2. .error (optional) \r\n * 3. .notify (optional)\r\n * 4. .close (optional) --> this one is attached to all events if no primary handler is defined \r\n *  \r\n * How to use\r\n * 1. you must already include all js files in your main app - so the controllers you'll need must be preloaded\r\n * 2. Your main app must also  declare the other apps as dependencies, so angular.module('yourname', ['dialog 1', 'diolag 2'])\r\n * 3. your main app must also need this ['EavAdminUI']\r\n * 4. your controller must require eavAdminDialogs\r\n * 5. Then you can call such a dialog\r\n */\r\n\r\n\r\n// Todo\r\n// 1. Import / Export\r\n// 2. Pipeline Designer\r\n\r\n// var contentItemsModule = $eavOnlyHelpers.urlParams.get(\"oldgrid\") ? \"ContentItemsApp\" : \"ContentItemsAppAgnostic\";\r\n\r\nangular.module(\"EavAdminUi\", [\"ng\",\r\n    \"ui.bootstrap\",         // for the $modal etc.\r\n    \"EavServices\",\r\n    \"eavTemplates\",         // Provides all cached templates\r\n    \"PermissionsApp\",       // Permissions dialogs to manage permissions\r\n    \"ContentItemsAppAgnostic\", // contentItemsModule,      // Content-items dialog - not working atm?\r\n    \"PipelineManagement\",   // Manage pipelines\r\n    \"ContentImportApp\",\r\n    \"ContentExportApp\",\r\n    \"HistoryApp\",            // the item-history app\r\n\t\"eavEditEntity\"\t\t\t// the edit-app\r\n])\r\n    .factory(\"eavAdminDialogs\", [\"$modal\", \"eavConfig\", \"$window\", \"entitiesSvc\", \"contentTypeSvc\", \"appId\", function ($modal, eavConfig, $window,\r\n        // these are needed just for simple access to some dialogs\r\n        entitiesSvc,\r\n        contentTypeSvc,\r\n        appId) {\r\n            /*jshint laxbreak:true */\r\n\r\n            var svc = {};\r\n\r\n            //#region List of Content Items dialogs\r\n            svc.openContentItems = function oci(appId, staticName, itemId, closeCallback) {\r\n            \tvar resolve = svc.CreateResolve({ appId: appId, contentType: staticName, contentTypeId: itemId });\r\n            \treturn svc.OpenModal(\"content-items/content-items-agnostic.html\", \"ContentItemsList as vm\", \"fullscreen\", resolve, closeCallback);\r\n            };\r\n            //#endregion\r\n\r\n            //#region content import export\r\n            svc.openContentImport = function ocimp(appId, staticName, closeCallback) {\r\n                var resolve = svc.CreateResolve({ appId: appId, contentType: staticName });\r\n                return svc.OpenModal(\"content-import-export/content-import.html\", \"ContentImport as vm\", \"lg\", resolve, closeCallback);\r\n            };\r\n\r\n            svc.openContentExport = function ocexp(appId, staticName, closeCallback) {\r\n                var resolve = svc.CreateResolve({ appId: appId, contentType: staticName });\r\n                return svc.OpenModal(\"content-import-export/content-export.html\", \"ContentExport as vm\", \"lg\", resolve, closeCallback);\r\n            };\r\n\r\n            //#endregion\r\n\r\n            //#region ContentType dialogs\r\n\r\n            svc.openContentTypeEdit = function octe(item, closeCallback) {\r\n                var resolve = svc.CreateResolve({ item: item });\r\n                return svc.OpenModal(\"content-types/content-types-edit.html\", \"Edit as vm\", \"\", resolve, closeCallback);\r\n            };\r\n\r\n            svc.openContentTypeFields = function octf(item, closeCallback) {\r\n                    var resolve = svc.CreateResolve({ contentType: item });\r\n                    return svc.OpenModal(\"content-types/content-types-fields.html\", \"FieldList as vm\", \"xlg\", resolve, closeCallback);\r\n            };\r\n\r\n            // this one assumes we have a content-item, but must first retrieve content-type-infos\r\n            svc.openContentTypeFieldsOfItems = function octf(item, closeCallback) {\r\n                return entitiesSvc.getManyForEditing(appId, item)\r\n                    .then(function(result) {\r\n                        var ctName = result.data[0].Header.ContentTypeName;\r\n                        var svcForThis = contentTypeSvc(appId); // note: won't specify scope to fallback\r\n                        return svcForThis.getDetails(ctName).then(function(result2) {\r\n                            return svc.openContentTypeFields(result2.data, closeCallback);\r\n                        });\r\n                    });\r\n            };\r\n\r\n\r\n            //#endregion\r\n        \r\n            //#region Item - new, edit\r\n            svc.openItemNew = function oin(contentTypeName, closeCallback) {\r\n                return svc.openEditItems([{ ContentTypeName: contentTypeName }], closeCallback);\r\n            };\r\n\r\n            svc.openItemEditWithEntityId = function oie(entityId, closeCallback) {\r\n                return svc.openEditItems([{ EntityId: entityId }], closeCallback);\r\n            };\r\n\r\n            svc.openEditItems = function oel(items, closeCallback) {\r\n                var resolve = svc.CreateResolve({ items: items });\r\n                return svc.OpenModal(\"form/main-form.html\", \"EditEntityWrapperCtrl as vm\", \"ent-edit\", resolve, closeCallback);\r\n            };\r\n\r\n            svc.openItemHistory = function ioh(entityId, closeCallback) {\r\n                return svc.OpenModal(\"content-items/history.html\", \"History as vm\", \"lg\",\r\n                    svc.CreateResolve({ entityId: entityId }),\r\n                    closeCallback);\r\n            };\r\n            //#endregion\r\n\r\n            //#region Metadata - mainly new\r\n            svc.openMetadataNew = function omdn(appId, targetType, targetId, metadataType, closeCallback) {\r\n                var metadata = {};\r\n                switch (targetType) {\r\n                    case \"entity\":\r\n                        metadata.Key = targetId;\r\n                        metadata.KeyType = \"guid\";\r\n                        metadata.TargetType = eavConfig.metadataOfEntity;\r\n                        break;\r\n                    case \"attribute\":\r\n                        metadata.Key = targetId;\r\n                        metadata.KeyType = \"number\";\r\n                        metadata.TargetType = eavConfig.metadataOfAttribute;\r\n                        break;\r\n                    default: throw \"targetType unknown, only accepts entity or attribute for now\";\r\n                }\r\n                var items = [{\r\n                    ContentTypeName: metadataType,\r\n                    Metadata: metadata\r\n                }];\r\n\r\n                svc.openEditItems(items, closeCallback);\r\n            };\r\n            //#endregion\r\n\r\n            //#region Permissions Dialog\r\n            svc.openPermissionsForGuid = function opfg(appId, targetGuid, closeCallback) {\r\n                var resolve = svc.CreateResolve({ appId: appId, targetGuid: targetGuid });\r\n                return svc.OpenModal(\"permissions/permissions.html\", \"PermissionList as vm\", \"lg\", resolve, closeCallback);\r\n            };\r\n            //#endregion\r\n\r\n            //#region Pipeline Designer\r\n            svc.editPipeline = function ep(appId, pipelineId, closeCallback) {\r\n                var url = svc.derivedUrl({\r\n                    dialog: \"pipeline-designer\",\r\n                    pipelineId: pipelineId\r\n                });\r\n                $window.open(url);\r\n                return;\r\n            };\r\n            //#endregion\r\n\r\n        //#region GenerateUrlBasedOnCurrent\r\n            svc.derivedUrl = function derivedUrl(varsToReplace) {\r\n                var url = window.location.href;\r\n                for (var prop in varsToReplace)\r\n                    if (varsToReplace.hasOwnProperty(prop))\r\n                        url = svc.replaceOrAddOneParam(url, prop, varsToReplace[prop]);\r\n\r\n                return url;\r\n                //url = url\r\n                //    .replace(new RegExp(\"appid=[0-9]*\", \"i\"), \"appid=\" + item.Id) // note: sometimes it doesn't have an appid, so it's [0-9]* instead of [0-9]+\r\n                //    .replace(/approot=[^&]*/, \"approot=\" + item.AppRoot + \"/\")\r\n                //    .replace(\"dialog=zone\", \"dialog=app\");\r\n            };\r\n\r\n            svc.replaceOrAddOneParam = function replaceOneParam(original, param, value) {\r\n                var rule = new RegExp(\"(\" + param + \"=).*?(&)\", \"i\");\r\n                var newText = rule.test(original)\r\n                    ? original.replace(rule, \"$1\" + value + \"$2\")\r\n                    : original + \"&\" + param + \"=\" + value;\r\n                return newText;\r\n            };\r\n        //#endregion\r\n\r\n\r\n        //#region Internal helpers\r\n            svc._attachCallbacks = function attachCallbacks(promise, callbacks) {\r\n                if (typeof (callbacks) === \"undefined\")\r\n                    return;\r\n                if (typeof (callbacks) === \"function\") // if it's only one callback, use it for all close-cases\r\n                    callbacks = { close: callbacks };\r\n                return promise.result.then(callbacks.success || callbacks.close, callbacks.error || callbacks.close, callbacks.notify || callbacks.close);\r\n            };\r\n\r\n        // Will open a modal window. Has various specials, like\r\n        // 1. If the templateUrl begins with \"~/\" - this will be re-mapped to the ng-app root. Only use this for not-inline stuff\r\n        // 2. The controller can be written as \"something as vm\" and this will be split and configured corectly\r\n            svc.OpenModal = function openModal(templateUrl, controller, size, resolveValues, callbacks) {\r\n                var foundAs = controller.indexOf(\" as \");\r\n                var contAs = foundAs > 0 ?\r\n                    controller.substring(foundAs + 4)\r\n                    : null;\r\n                if (foundAs > 0)\r\n                    controller = controller.substring(0, foundAs);\r\n\r\n                var modalInstance = $modal.open({\r\n                    animation: true,\r\n                    templateUrl: templateUrl,\r\n                    controller: controller,\r\n                    controllerAs: contAs,\r\n                    size: size,\r\n                    resolve: resolveValues\r\n                });\r\n\r\n                return svc._attachCallbacks(modalInstance, callbacks);\r\n            };\r\n\r\n        /// This will create a resolve-object containing return function()... for each property in the array\r\n            svc.CreateResolve = function createResolve() {\r\n                var fns = {}, list = arguments[0];\r\n                for (var prop in list) \r\n                    if (list.hasOwnProperty(prop))\r\n                        fns[prop] = svc._create1Resolve(list[prop]);\r\n                return fns;\r\n            };\r\n\r\n            svc._create1Resolve = function (value) {\r\n                return function () { return value; };\r\n            };\r\n        //#endregion\r\n\r\n\r\n        return svc;\r\n    }])\r\n\r\n;\n/*  this file contains various eav-angular services\r\n *  1. the basic configuration enforcing html5 mode\r\n */\r\n\r\nangular.module(\"eavNgSvcs\", [\"ng\"])\r\n\r\n    /// Config to ensure that $location can work and give url-parameters\r\n    .config([\"$locationProvider\", function ($locationProvider) {\r\n            $locationProvider.html5Mode({\r\n                enabled: true,\r\n                requireBase: false\r\n            });\r\n        } ])\r\n\r\n\r\n;\r\n\n\r\n/* File Type Services\r\n * Helps check if something is an image (then the UI usually wants a thumbnail)\r\n * ...or if it has an icon in the font-library - then it can provide the class name for the icon\r\n */\r\nangular.module(\"EavServices\").service(\"fileType\", function () {\r\n    var svc = {};\r\n    svc.iconPrefix = \"icon-\";\r\n    svc.defaultIcon = \"file\";\r\n    svc.checkImgRegEx = /(?:([^:\\/?#]+):)?(?:\\/\\/([^\\/?#]*))?([^?#]*\\.(?:jpg|jpeg|gif|png))(?:\\?([^#]*))?(?:#(.*))?/i;\r\n    svc.extensions = {\r\n        doc: \"file-word\",\r\n        docx: \"file-word\",\r\n        xls: \"file-excel\",\r\n        xlsx: \"file-excel\",\r\n        ppt: \"file-powerpoint\",\r\n        pptx: \"file-powerpoint\",\r\n        pdf: \"file-pdf\",\r\n        mp3: \"file-audio\",\r\n        avi: \"file-video\",\r\n        mpg: \"file-video\",\r\n        mpeg: \"file-video\",\r\n        mov: \"file-video\",\r\n        mp4: \"file-video\",\r\n        zip: \"file-archive\",\r\n        rar: \"file-archive\",\r\n        txt: \"file-text\",\r\n        html: \"file-code\",\r\n        css: \"file-code\",\r\n        xml: \"file-code\",\r\n        xsl: \"file-code\",\r\n        vcf: \"user\"\r\n    };\r\n\r\n    svc.getExtension = function(filename) {\r\n        return filename.substr(filename.lastIndexOf(\".\") + 1).toLowerCase();\r\n    };\r\n\r\n    svc.getIconClass = function getClass(filename) {\r\n        return svc.iconPrefix + (svc.extensions[svc.getExtension(filename)] || svc.defaultIcon);\r\n    };\r\n    \r\n    svc.isKnownType = function(filename) {\r\n        return svc.extensions.indexOf[svc.getExtension(filename)] !== -1;\r\n    };\r\n\r\n    svc.isImage = function(filename) {\r\n        return svc.checkImgRegEx.test(filename);\r\n    };\r\n\r\n    // not used yet, so commented out\r\n    //svc.type = function(url) {\r\n    //    if (svc.isImage(url))\r\n    //        return \"image\";\r\n    //    return \"file\";\r\n    //};\r\n\r\n    return svc;\r\n});\n\r\nangular.module(\"EavServices\")\r\n    .factory(\"historySvc\", [\"$http\", \"svcCreator\", function($http, svcCreator) { \r\n        //var eavConf = eavConfig;\r\n\r\n        // Construct a service for this specific targetGuid\r\n        return function createSvc(appId, entityId) {\r\n            var svc = {\r\n                appId: appId,\r\n                entityId: entityId\r\n            };\r\n\r\n            // When we get the list, reverse-number the results to give it a nice version number\r\n            svc = angular.extend(svc, svcCreator.implementLiveList(function getAll() {\r\n                return $http.get(\"eav/entities/history\", { params: { \"appId\": svc.appId, \"entityId\": svc.entityId } })\r\n                .then(function(result) {\r\n                    var list = result.data;\r\n                        for (var i = 0; i < list.length; i++)\r\n                            list[i].VirtualVersion = list.length - i;\r\n                        return result;\r\n                    });\r\n            }));\r\n\r\n            svc.getVersionDetails = function getVersionDetails(changeId) {\r\n                return $http.get(\"eav/entities/historydetails\", { params: { \"appId\": svc.appId, \"entityId\": svc.entityId, \"changeId\": changeId } });\r\n            };\r\n\r\n            return svc;\r\n        };\r\n    }]);\n/* The main component for language inclusion\r\n * Ensure the dependencies work, that the url-schema is prepared etc.\r\n * \r\n */\r\n\r\n(function () {\r\n    angular.module(\"EavServices\")\r\n        .config([\"$translateProvider\", \"languages\", \"$translatePartialLoaderProvider\", function($translateProvider, languages, $translatePartialLoaderProvider) {\r\n            $translateProvider\r\n                .preferredLanguage(languages.currentLanguage.split(\"-\")[0])\r\n                .useSanitizeValueStrategy(\"escapeParameters\") // this is very important to allow html in the JSON files\r\n                .fallbackLanguage(languages.fallbackLanguage)\r\n                .useLoader(\"$translatePartialLoader\", {\r\n                    urlTemplate: languages.i18nRoot + \"{part}-{lang}.js\"\r\n                })\r\n                .useLoaderCache(true); // should cache json\r\n            $translatePartialLoaderProvider // these parts are always required\r\n                .addPart(\"admin\")\r\n                .addPart(\"edit\");\r\n        }])\r\n\r\n        // ensure that adding parts will load the missing files\r\n        .run([\"$rootScope\", \"$translate\", function($rootScope, $translate) {\r\n            $rootScope.$on(\"$translatePartialLoaderStructureChanged\", function() {\r\n                $translate.refresh();\r\n            });\r\n        }]);\r\n})();\n// By default, eav-controls assume that all their parameters (appId, etc.) are instantiated by the bootstrapper\r\n// but the \"root\" component must get it from the url\r\n// Since different objects could be the root object (this depends on the initial loader), the root-one must have\r\n// a connection to the Url, but only when it is the root\r\n// So the trick is to just include this file - which will provide values for the important attribute\r\n//\r\n// As of now, it only supplies\r\n// * appId\r\n(function () {\r\n    angular.module(\"InitParametersFromUrl\", [])\r\n        //#region properties\r\n        .factory(\"appId\", function () {\r\n            return getParameterByName(\"appId\");\r\n        })\r\n        .factory(\"zoneId\", function () {\r\n            return getParameterByName(\"zoneId\");\r\n        })\r\n        .factory(\"entityId\", function () {\r\n            return getParameterByName(\"entityid\");\r\n        })\r\n        .factory(\"contentTypeName\", function () {\r\n            return getParameterByName(\"contenttypename\");\r\n        })\r\n\r\n        .factory(\"pipelineId\", function () {\r\n            return getParameterByName(\"pipelineId\");\r\n        })\r\n        .factory(\"dialog\", function () {\r\n            return getParameterByName(\"dialog\");\r\n        })\r\n        //#endregion\r\n        //#region helpers / dummy objects\r\n        // This is a dummy object, because it's needed for dialogs\r\n        .factory(\"$modalInstance\", function () {\r\n            return null;\r\n        })\r\n    //#endregion\r\n    ;\r\n\r\n    function getParameterByName(name) {\r\n        if (window.$2sxc)\r\n            return window.$2sxc.urlParams.get(name);\r\n        return getParameterByNameDuplicate(name);\r\n    }\r\n\r\n    // this is a duplicate fn of the 2sxc-version, should only be used if 2sxc doesn't exist\r\n    function getParameterByNameDuplicate(name) {\r\n        name = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\r\n        var searchRx = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\", \"i\");\r\n        var results = searchRx.exec(location.search);\r\n\r\n        if (results === null) {\r\n            var hashRx = new RegExp(\"[#&]\" + name + \"=([^&#]*)\", \"i\");\r\n            results = hashRx.exec(location.hash);\r\n        }\r\n\r\n        // if nothing found, try normal URL because DNN places parameters in /key/value notation\r\n        if (results === null) {\r\n            // Otherwise try parts of the URL\r\n            var matches = window.location.pathname.match(new RegExp(\"/\" + name + \"/([^/]+)\", \"i\"));\r\n\r\n            // Check if we found anything, if we do find it, we must reverse the results so we get the \"last\" one in case there are multiple hits\r\n            if (matches !== null && matches.length > 1)\r\n                results = matches.reverse()[0];\r\n        } else\r\n            results = results[1];\r\n\r\n        return results === null ? \"\" : decodeURIComponent(results.replace(/\\+/g, \" \"));\r\n    }\r\n}());\n/*\r\n * Cleans up all kinds of texts containing non-latin characters like umlauts or romanian characters etc.\r\n * \r\n * based on http://stackoverflow.com/questions/286921/efficiently-replace-all-accented-characters-in-a-string\r\n * \r\n */\r\n\r\nangular.module(\"EavServices\")\r\n    .factory(\"latinizeText\", function() {\r\n        return function(input) {\r\n            var latinMap = { \"Á\": \"A\", \"Ă\": \"A\", \"Ắ\": \"A\", \"Ặ\": \"A\", \"Ằ\": \"A\", \"Ẳ\": \"A\", \"Ẵ\": \"A\", \"Ǎ\": \"A\", \"Â\": \"A\", \"Ấ\": \"A\", \"Ậ\": \"A\", \"Ầ\": \"A\", \"Ẩ\": \"A\", \"Ẫ\": \"A\", \"Ä\": \"Ae\", \"Ǟ\": \"A\", \"Ȧ\": \"A\", \"Ǡ\": \"A\", \"Ạ\": \"A\", \"Ȁ\": \"A\", \"À\": \"A\", \"Ả\": \"A\", \"Ȃ\": \"A\", \"Ā\": \"A\", \"Ą\": \"A\", \"Å\": \"A\", \"Ǻ\": \"A\", \"Ḁ\": \"A\", \"Ⱥ\": \"A\", \"Ã\": \"A\", \"Ꜳ\": \"AA\", \"Æ\": \"AE\", \"Ǽ\": \"AE\", \"Ǣ\": \"AE\", \"Ꜵ\": \"AO\", \"Ꜷ\": \"AU\", \"Ꜹ\": \"AV\", \"Ꜻ\": \"AV\", \"Ꜽ\": \"AY\", \"Ḃ\": \"B\", \"Ḅ\": \"B\", \"Ɓ\": \"B\", \"Ḇ\": \"B\", \"Ƀ\": \"B\", \"Ƃ\": \"B\", \"Ć\": \"C\", \"Č\": \"C\", \"Ç\": \"C\", \"Ḉ\": \"C\", \"Ĉ\": \"C\", \"Ċ\": \"C\", \"Ƈ\": \"C\", \"Ȼ\": \"C\", \"Ď\": \"D\", \"Ḑ\": \"D\", \"Ḓ\": \"D\", \"Ḋ\": \"D\", \"Ḍ\": \"D\", \"Ɗ\": \"D\", \"Ḏ\": \"D\", \"ǲ\": \"D\", \"ǅ\": \"D\", \"Đ\": \"D\", \"Ƌ\": \"D\", \"Ǳ\": \"DZ\", \"Ǆ\": \"DZ\", \"É\": \"E\", \"Ĕ\": \"E\", \"Ě\": \"E\", \"Ȩ\": \"E\", \"Ḝ\": \"E\", \"Ê\": \"E\", \"Ế\": \"E\", \"Ệ\": \"E\", \"Ề\": \"E\", \"Ể\": \"E\", \"Ễ\": \"E\", \"Ḙ\": \"E\", \"Ë\": \"E\", \"Ė\": \"E\", \"Ẹ\": \"E\", \"Ȅ\": \"E\", \"È\": \"E\", \"Ẻ\": \"E\", \"Ȇ\": \"E\", \"Ē\": \"E\", \"Ḗ\": \"E\", \"Ḕ\": \"E\", \"Ę\": \"E\", \"Ɇ\": \"E\", \"Ẽ\": \"E\", \"Ḛ\": \"E\", \"Ꝫ\": \"ET\", \"Ḟ\": \"F\", \"Ƒ\": \"F\", \"Ǵ\": \"G\", \"Ğ\": \"G\", \"Ǧ\": \"G\", \"Ģ\": \"G\", \"Ĝ\": \"G\", \"Ġ\": \"G\", \"Ɠ\": \"G\", \"Ḡ\": \"G\", \"Ǥ\": \"G\", \"Ḫ\": \"H\", \"Ȟ\": \"H\", \"Ḩ\": \"H\", \"Ĥ\": \"H\", \"Ⱨ\": \"H\", \"Ḧ\": \"H\", \"Ḣ\": \"H\", \"Ḥ\": \"H\", \"Ħ\": \"H\", \"Í\": \"I\", \"Ĭ\": \"I\", \"Ǐ\": \"I\", \"Î\": \"I\", \"Ï\": \"I\", \"Ḯ\": \"I\", \"İ\": \"I\", \"Ị\": \"I\", \"Ȉ\": \"I\", \"Ì\": \"I\", \"Ỉ\": \"I\", \"Ȋ\": \"I\", \"Ī\": \"I\", \"Į\": \"I\", \"Ɨ\": \"I\", \"Ĩ\": \"I\", \"Ḭ\": \"I\", \"Ꝺ\": \"D\", \"Ꝼ\": \"F\", \"Ᵹ\": \"G\", \"Ꞃ\": \"R\", \"Ꞅ\": \"S\", \"Ꞇ\": \"T\", \"Ꝭ\": \"IS\", \"Ĵ\": \"J\", \"Ɉ\": \"J\", \"Ḱ\": \"K\", \"Ǩ\": \"K\", \"Ķ\": \"K\", \"Ⱪ\": \"K\", \"Ꝃ\": \"K\", \"Ḳ\": \"K\", \"Ƙ\": \"K\", \"Ḵ\": \"K\", \"Ꝁ\": \"K\", \"Ꝅ\": \"K\", \"Ĺ\": \"L\", \"Ƚ\": \"L\", \"Ľ\": \"L\", \"Ļ\": \"L\", \"Ḽ\": \"L\", \"Ḷ\": \"L\", \"Ḹ\": \"L\", \"Ⱡ\": \"L\", \"Ꝉ\": \"L\", \"Ḻ\": \"L\", \"Ŀ\": \"L\", \"Ɫ\": \"L\", \"ǈ\": \"L\", \"Ł\": \"L\", \"Ǉ\": \"LJ\", \"Ḿ\": \"M\", \"Ṁ\": \"M\", \"Ṃ\": \"M\", \"Ɱ\": \"M\", \"Ń\": \"N\", \"Ň\": \"N\", \"Ņ\": \"N\", \"Ṋ\": \"N\", \"Ṅ\": \"N\", \"Ṇ\": \"N\", \"Ǹ\": \"N\", \"Ɲ\": \"N\", \"Ṉ\": \"N\", \"Ƞ\": \"N\", \"ǋ\": \"N\", \"Ñ\": \"N\", \"Ǌ\": \"NJ\", \"Ó\": \"O\", \"Ŏ\": \"O\", \"Ǒ\": \"O\", \"Ô\": \"O\", \"Ố\": \"O\", \"Ộ\": \"O\", \"Ồ\": \"O\", \"Ổ\": \"O\", \"Ỗ\": \"O\", \"Öe\": \"O\", \"Ȫ\": \"O\", \"Ȯ\": \"O\", \"Ȱ\": \"O\", \"Ọ\": \"O\", \"Ő\": \"O\", \"Ȍ\": \"O\", \"Ò\": \"O\", \"Ỏ\": \"O\", \"Ơ\": \"O\", \"Ớ\": \"O\", \"Ợ\": \"O\", \"Ờ\": \"O\", \"Ở\": \"O\", \"Ỡ\": \"O\", \"Ȏ\": \"O\", \"Ꝋ\": \"O\", \"Ꝍ\": \"O\", \"Ō\": \"O\", \"Ṓ\": \"O\", \"Ṑ\": \"O\", \"Ɵ\": \"O\", \"Ǫ\": \"O\", \"Ǭ\": \"O\", \"Ø\": \"O\", \"Ǿ\": \"O\", \"Õ\": \"O\", \"Ṍ\": \"O\", \"Ṏ\": \"O\", \"Ȭ\": \"O\", \"Ƣ\": \"OI\", \"Ꝏ\": \"OO\", \"Ɛ\": \"E\", \"Ɔ\": \"O\", \"Ȣ\": \"OU\", \"Ṕ\": \"P\", \"Ṗ\": \"P\", \"Ꝓ\": \"P\", \"Ƥ\": \"P\", \"Ꝕ\": \"P\", \"Ᵽ\": \"P\", \"Ꝑ\": \"P\", \"Ꝙ\": \"Q\", \"Ꝗ\": \"Q\", \"Ŕ\": \"R\", \"Ř\": \"R\", \"Ŗ\": \"R\", \"Ṙ\": \"R\", \"Ṛ\": \"R\", \"Ṝ\": \"R\", \"Ȑ\": \"R\", \"Ȓ\": \"R\", \"Ṟ\": \"R\", \"Ɍ\": \"R\", \"Ɽ\": \"R\", \"Ꜿ\": \"C\", \"Ǝ\": \"E\", \"Ś\": \"S\", \"Ṥ\": \"S\", \"Š\": \"S\", \"Ṧ\": \"S\", \"Ş\": \"S\", \"Ŝ\": \"S\", \"Ș\": \"S\", \"Ṡ\": \"S\", \"Ṣ\": \"S\", \"Ṩ\": \"S\", \"Ť\": \"T\", \"Ţ\": \"T\", \"Ṱ\": \"T\", \"Ț\": \"T\", \"Ⱦ\": \"T\", \"Ṫ\": \"T\", \"Ṭ\": \"T\", \"Ƭ\": \"T\", \"Ṯ\": \"T\", \"Ʈ\": \"T\", \"Ŧ\": \"T\", \"Ɐ\": \"A\", \"Ꞁ\": \"L\", \"Ɯ\": \"M\", \"Ʌ\": \"V\", \"Ꜩ\": \"TZ\", \"Ú\": \"U\", \"Ŭ\": \"U\", \"Ǔ\": \"U\", \"Û\": \"U\", \"Ṷ\": \"U\", \"Ü\": \"Ue\", \"Ǘ\": \"U\", \"Ǚ\": \"U\", \"Ǜ\": \"U\", \"Ǖ\": \"U\", \"Ṳ\": \"U\", \"Ụ\": \"U\", \"Ű\": \"U\", \"Ȕ\": \"U\", \"Ù\": \"U\", \"Ủ\": \"U\", \"Ư\": \"U\", \"Ứ\": \"U\", \"Ự\": \"U\", \"Ừ\": \"U\", \"Ử\": \"U\", \"Ữ\": \"U\", \"Ȗ\": \"U\", \"Ū\": \"U\", \"Ṻ\": \"U\", \"Ų\": \"U\", \"Ů\": \"U\", \"Ũ\": \"U\", \"Ṹ\": \"U\", \"Ṵ\": \"U\", \"Ꝟ\": \"V\", \"Ṿ\": \"V\", \"Ʋ\": \"V\", \"Ṽ\": \"V\", \"Ꝡ\": \"VY\", \"Ẃ\": \"W\", \"Ŵ\": \"W\", \"Ẅ\": \"W\", \"Ẇ\": \"W\", \"Ẉ\": \"W\", \"Ẁ\": \"W\", \"Ⱳ\": \"W\", \"Ẍ\": \"X\", \"Ẋ\": \"X\", \"Ý\": \"Y\", \"Ŷ\": \"Y\", \"Ÿ\": \"Y\", \"Ẏ\": \"Y\", \"Ỵ\": \"Y\", \"Ỳ\": \"Y\", \"Ƴ\": \"Y\", \"Ỷ\": \"Y\", \"Ỿ\": \"Y\", \"Ȳ\": \"Y\", \"Ɏ\": \"Y\", \"Ỹ\": \"Y\", \"Ź\": \"Z\", \"Ž\": \"Z\", \"Ẑ\": \"Z\", \"Ⱬ\": \"Z\", \"Ż\": \"Z\", \"Ẓ\": \"Z\", \"Ȥ\": \"Z\", \"Ẕ\": \"Z\", \"Ƶ\": \"Z\", \"Ĳ\": \"IJ\", \"Œ\": \"OE\", \"ᴀ\": \"A\", \"ᴁ\": \"AE\", \"ʙ\": \"B\", \"ᴃ\": \"B\", \"ᴄ\": \"C\", \"ᴅ\": \"D\", \"ᴇ\": \"E\", \"ꜰ\": \"F\", \"ɢ\": \"G\", \"ʛ\": \"G\", \"ʜ\": \"H\", \"ɪ\": \"I\", \"ʁ\": \"R\", \"ᴊ\": \"J\", \"ᴋ\": \"K\", \"ʟ\": \"L\", \"ᴌ\": \"L\", \"ᴍ\": \"M\", \"ɴ\": \"N\", \"ᴏ\": \"O\", \"ɶ\": \"OE\", \"ᴐ\": \"O\", \"ᴕ\": \"OU\", \"ᴘ\": \"P\", \"ʀ\": \"R\", \"ᴎ\": \"N\", \"ᴙ\": \"R\", \"ꜱ\": \"S\", \"ᴛ\": \"T\", \"ⱻ\": \"E\", \"ᴚ\": \"R\", \"ᴜ\": \"U\", \"ᴠ\": \"V\", \"ᴡ\": \"W\", \"ʏ\": \"Y\", \"ᴢ\": \"Z\", \"á\": \"a\", \"ă\": \"a\", \"ắ\": \"a\", \"ặ\": \"a\", \"ằ\": \"a\", \"ẳ\": \"a\", \"ẵ\": \"a\", \"ǎ\": \"a\", \"â\": \"a\", \"ấ\": \"a\", \"ậ\": \"a\", \"ầ\": \"a\", \"ẩ\": \"a\", \"ẫ\": \"a\", \"ä\": \"ae\", \"ǟ\": \"a\", \"ȧ\": \"a\", \"ǡ\": \"a\", \"ạ\": \"a\", \"ȁ\": \"a\", \"à\": \"a\", \"ả\": \"a\", \"ȃ\": \"a\", \"ā\": \"a\", \"ą\": \"a\", \"ᶏ\": \"a\", \"ẚ\": \"a\", \"å\": \"a\", \"ǻ\": \"a\", \"ḁ\": \"a\", \"ⱥ\": \"a\", \"ã\": \"a\", \"ꜳ\": \"aa\", \"æ\": \"ae\", \"ǽ\": \"ae\", \"ǣ\": \"ae\", \"ꜵ\": \"ao\", \"ꜷ\": \"au\", \"ꜹ\": \"av\", \"ꜻ\": \"av\", \"ꜽ\": \"ay\", \"ḃ\": \"b\", \"ḅ\": \"b\", \"ɓ\": \"b\", \"ḇ\": \"b\", \"ᵬ\": \"b\", \"ᶀ\": \"b\", \"ƀ\": \"b\", \"ƃ\": \"b\", \"ɵ\": \"o\", \"ć\": \"c\", \"č\": \"c\", \"ç\": \"c\", \"ḉ\": \"c\", \"ĉ\": \"c\", \"ɕ\": \"c\", \"ċ\": \"c\", \"ƈ\": \"c\", \"ȼ\": \"c\", \"ď\": \"d\", \"ḑ\": \"d\", \"ḓ\": \"d\", \"ȡ\": \"d\", \"ḋ\": \"d\", \"ḍ\": \"d\", \"ɗ\": \"d\", \"ᶑ\": \"d\", \"ḏ\": \"d\", \"ᵭ\": \"d\", \"ᶁ\": \"d\", \"đ\": \"d\", \"ɖ\": \"d\", \"ƌ\": \"d\", \"ı\": \"i\", \"ȷ\": \"j\", \"ɟ\": \"j\", \"ʄ\": \"j\", \"ǳ\": \"dz\", \"ǆ\": \"dz\", \"é\": \"e\", \"ĕ\": \"e\", \"ě\": \"e\", \"ȩ\": \"e\", \"ḝ\": \"e\", \"ê\": \"e\", \"ế\": \"e\", \"ệ\": \"e\", \"ề\": \"e\", \"ể\": \"e\", \"ễ\": \"e\", \"ḙ\": \"e\", \"ë\": \"e\", \"ė\": \"e\", \"ẹ\": \"e\", \"ȅ\": \"e\", \"è\": \"e\", \"ẻ\": \"e\", \"ȇ\": \"e\", \"ē\": \"e\", \"ḗ\": \"e\", \"ḕ\": \"e\", \"ⱸ\": \"e\", \"ę\": \"e\", \"ᶒ\": \"e\", \"ɇ\": \"e\", \"ẽ\": \"e\", \"ḛ\": \"e\", \"ꝫ\": \"et\", \"ḟ\": \"f\", \"ƒ\": \"f\", \"ᵮ\": \"f\", \"ᶂ\": \"f\", \"ǵ\": \"g\", \"ğ\": \"g\", \"ǧ\": \"g\", \"ģ\": \"g\", \"ĝ\": \"g\", \"ġ\": \"g\", \"ɠ\": \"g\", \"ḡ\": \"g\", \"ᶃ\": \"g\", \"ǥ\": \"g\", \"ḫ\": \"h\", \"ȟ\": \"h\", \"ḩ\": \"h\", \"ĥ\": \"h\", \"ⱨ\": \"h\", \"ḧ\": \"h\", \"ḣ\": \"h\", \"ḥ\": \"h\", \"ɦ\": \"h\", \"ẖ\": \"h\", \"ħ\": \"h\", \"ƕ\": \"hv\", \"í\": \"i\", \"ĭ\": \"i\", \"ǐ\": \"i\", \"î\": \"i\", \"ï\": \"i\", \"ḯ\": \"i\", \"ị\": \"i\", \"ȉ\": \"i\", \"ì\": \"i\", \"ỉ\": \"i\", \"ȋ\": \"i\", \"ī\": \"i\", \"į\": \"i\", \"ᶖ\": \"i\", \"ɨ\": \"i\", \"ĩ\": \"i\", \"ḭ\": \"i\", \"ꝺ\": \"d\", \"ꝼ\": \"f\", \"ᵹ\": \"g\", \"ꞃ\": \"r\", \"ꞅ\": \"s\", \"ꞇ\": \"t\", \"ꝭ\": \"is\", \"ǰ\": \"j\", \"ĵ\": \"j\", \"ʝ\": \"j\", \"ɉ\": \"j\", \"ḱ\": \"k\", \"ǩ\": \"k\", \"ķ\": \"k\", \"ⱪ\": \"k\", \"ꝃ\": \"k\", \"ḳ\": \"k\", \"ƙ\": \"k\", \"ḵ\": \"k\", \"ᶄ\": \"k\", \"ꝁ\": \"k\", \"ꝅ\": \"k\", \"ĺ\": \"l\", \"ƚ\": \"l\", \"ɬ\": \"l\", \"ľ\": \"l\", \"ļ\": \"l\", \"ḽ\": \"l\", \"ȴ\": \"l\", \"ḷ\": \"l\", \"ḹ\": \"l\", \"ⱡ\": \"l\", \"ꝉ\": \"l\", \"ḻ\": \"l\", \"ŀ\": \"l\", \"ɫ\": \"l\", \"ᶅ\": \"l\", \"ɭ\": \"l\", \"ł\": \"l\", \"ǉ\": \"lj\", \"ſ\": \"s\", \"ẜ\": \"s\", \"ẛ\": \"s\", \"ẝ\": \"s\", \"ḿ\": \"m\", \"ṁ\": \"m\", \"ṃ\": \"m\", \"ɱ\": \"m\", \"ᵯ\": \"m\", \"ᶆ\": \"m\", \"ń\": \"n\", \"ň\": \"n\", \"ņ\": \"n\", \"ṋ\": \"n\", \"ȵ\": \"n\", \"ṅ\": \"n\", \"ṇ\": \"n\", \"ǹ\": \"n\", \"ɲ\": \"n\", \"ṉ\": \"n\", \"ƞ\": \"n\", \"ᵰ\": \"n\", \"ᶇ\": \"n\", \"ɳ\": \"n\", \"ñ\": \"n\", \"ǌ\": \"nj\", \"ó\": \"o\", \"ŏ\": \"o\", \"ǒ\": \"o\", \"ô\": \"o\", \"ố\": \"o\", \"ộ\": \"o\", \"ồ\": \"o\", \"ổ\": \"o\", \"ỗ\": \"o\", \"ö\": \"oe\", \"ȫ\": \"o\", \"ȯ\": \"o\", \"ȱ\": \"o\", \"ọ\": \"o\", \"ő\": \"o\", \"ȍ\": \"o\", \"ò\": \"o\", \"ỏ\": \"o\", \"ơ\": \"o\", \"ớ\": \"o\", \"ợ\": \"o\", \"ờ\": \"o\", \"ở\": \"o\", \"ỡ\": \"o\", \"ȏ\": \"o\", \"ꝋ\": \"o\", \"ꝍ\": \"o\", \"ⱺ\": \"o\", \"ō\": \"o\", \"ṓ\": \"o\", \"ṑ\": \"o\", \"ǫ\": \"o\", \"ǭ\": \"o\", \"ø\": \"o\", \"ǿ\": \"o\", \"õ\": \"o\", \"ṍ\": \"o\", \"ṏ\": \"o\", \"ȭ\": \"o\", \"ƣ\": \"oi\", \"ꝏ\": \"oo\", \"ɛ\": \"e\", \"ᶓ\": \"e\", \"ɔ\": \"o\", \"ᶗ\": \"o\", \"ȣ\": \"ou\", \"ṕ\": \"p\", \"ṗ\": \"p\", \"ꝓ\": \"p\", \"ƥ\": \"p\", \"ᵱ\": \"p\", \"ᶈ\": \"p\", \"ꝕ\": \"p\", \"ᵽ\": \"p\", \"ꝑ\": \"p\", \"ꝙ\": \"q\", \"ʠ\": \"q\", \"ɋ\": \"q\", \"ꝗ\": \"q\", \"ŕ\": \"r\", \"ř\": \"r\", \"ŗ\": \"r\", \"ṙ\": \"r\", \"ṛ\": \"r\", \"ṝ\": \"r\", \"ȑ\": \"r\", \"ɾ\": \"r\", \"ᵳ\": \"r\", \"ȓ\": \"r\", \"ṟ\": \"r\", \"ɼ\": \"r\", \"ᵲ\": \"r\", \"ᶉ\": \"r\", \"ɍ\": \"r\", \"ɽ\": \"r\", \"ↄ\": \"c\", \"ꜿ\": \"c\", \"ɘ\": \"e\", \"ɿ\": \"r\", \"ß\": \"ss\", \"ś\": \"s\", \"ṥ\": \"s\", \"š\": \"s\", \"ṧ\": \"s\", \"ş\": \"s\", \"ŝ\": \"s\", \"ș\": \"s\", \"ṡ\": \"s\", \"ṣ\": \"s\", \"ṩ\": \"s\", \"ʂ\": \"s\", \"ᵴ\": \"s\", \"ᶊ\": \"s\", \"ȿ\": \"s\", \"ɡ\": \"g\", \"ᴑ\": \"o\", \"ᴓ\": \"o\", \"ᴝ\": \"u\", \"ť\": \"t\", \"ţ\": \"t\", \"ṱ\": \"t\", \"ț\": \"t\", \"ȶ\": \"t\", \"ẗ\": \"t\", \"ⱦ\": \"t\", \"ṫ\": \"t\", \"ṭ\": \"t\", \"ƭ\": \"t\", \"ṯ\": \"t\", \"ᵵ\": \"t\", \"ƫ\": \"t\", \"ʈ\": \"t\", \"ŧ\": \"t\", \"ᵺ\": \"th\", \"ɐ\": \"a\", \"ᴂ\": \"ae\", \"ǝ\": \"e\", \"ᵷ\": \"g\", \"ɥ\": \"h\", \"ʮ\": \"h\", \"ʯ\": \"h\", \"ᴉ\": \"i\", \"ʞ\": \"k\", \"ꞁ\": \"l\", \"ɯ\": \"m\", \"ɰ\": \"m\", \"ᴔ\": \"oe\", \"ɹ\": \"r\", \"ɻ\": \"r\", \"ɺ\": \"r\", \"ⱹ\": \"r\", \"ʇ\": \"t\", \"ʌ\": \"v\", \"ʍ\": \"w\", \"ʎ\": \"y\", \"ꜩ\": \"tz\", \"ú\": \"u\", \"ŭ\": \"u\", \"ǔ\": \"u\", \"û\": \"u\", \"ṷ\": \"u\", \"ü\": \"ue\", \"ǘ\": \"u\", \"ǚ\": \"u\", \"ǜ\": \"u\", \"ǖ\": \"u\", \"ṳ\": \"u\", \"ụ\": \"u\", \"ű\": \"u\", \"ȕ\": \"u\", \"ù\": \"u\", \"ủ\": \"u\", \"ư\": \"u\", \"ứ\": \"u\", \"ự\": \"u\", \"ừ\": \"u\", \"ử\": \"u\", \"ữ\": \"u\", \"ȗ\": \"u\", \"ū\": \"u\", \"ṻ\": \"u\", \"ų\": \"u\", \"ᶙ\": \"u\", \"ů\": \"u\", \"ũ\": \"u\", \"ṹ\": \"u\", \"ṵ\": \"u\", \"ᵫ\": \"ue\", \"ꝸ\": \"um\", \"ⱴ\": \"v\", \"ꝟ\": \"v\", \"ṿ\": \"v\", \"ʋ\": \"v\", \"ᶌ\": \"v\", \"ⱱ\": \"v\", \"ṽ\": \"v\", \"ꝡ\": \"vy\", \"ẃ\": \"w\", \"ŵ\": \"w\", \"ẅ\": \"w\", \"ẇ\": \"w\", \"ẉ\": \"w\", \"ẁ\": \"w\", \"ⱳ\": \"w\", \"ẘ\": \"w\", \"ẍ\": \"x\", \"ẋ\": \"x\", \"ᶍ\": \"x\", \"ý\": \"y\", \"ŷ\": \"y\", \"ÿ\": \"y\", \"ẏ\": \"y\", \"ỵ\": \"y\", \"ỳ\": \"y\", \"ƴ\": \"y\", \"ỷ\": \"y\", \"ỿ\": \"y\", \"ȳ\": \"y\", \"ẙ\": \"y\", \"ɏ\": \"y\", \"ỹ\": \"y\", \"ź\": \"z\", \"ž\": \"z\", \"ẑ\": \"z\", \"ʑ\": \"z\", \"ⱬ\": \"z\", \"ż\": \"z\", \"ẓ\": \"z\", \"ȥ\": \"z\", \"ẕ\": \"z\", \"ᵶ\": \"z\", \"ᶎ\": \"z\", \"ʐ\": \"z\", \"ƶ\": \"z\", \"ɀ\": \"z\", \"ﬀ\": \"ff\", \"ﬃ\": \"ffi\", \"ﬄ\": \"ffl\", \"ﬁ\": \"fi\", \"ﬂ\": \"fl\", \"ĳ\": \"ij\", \"œ\": \"oe\", \"ﬆ\": \"st\", \"ₐ\": \"a\", \"ₑ\": \"e\", \"ᵢ\": \"i\", \"ⱼ\": \"j\", \"ₒ\": \"o\", \"ᵣ\": \"r\", \"ᵤ\": \"u\", \"ᵥ\": \"v\", \"ₓ\": \"x\" };\r\n            return input.replace(/[^A-Za-z0-9\\[\\] ]/g, function(a) { return latinMap[a] || a; });\r\n        };\r\n    });\r\n\n// metadata\r\n// retrieves metadata for an entity or an attribute\r\n\r\nangular.module(\"EavServices\")\r\n    /// Management actions which are rather advanced metadata kind of actions\r\n    .factory(\"metadataSvc\", [\"$http\", \"appId\", function($http, appId) {\r\n        var svc = {};\r\n\r\n        // Find all items assigned to a GUID\r\n        svc.getMetadata = function getMetadata(assignedToId, keyGuid, contentTypeName) {\r\n            return $http.get(\"eav/metadata/getassignedentities\", {\r\n                params: {\r\n                    appId: appId,\r\n                    assignmentObjectTypeId: assignedToId,\r\n                    keyType: \"guid\",\r\n                    key: keyGuid,\r\n                    contentType: contentTypeName\r\n                }\r\n            });\r\n        };\r\n        return svc;\r\n    }]);\n\r\nangular.module(\"EavServices\")\r\n    .factory(\"permissionsSvc\", [\"$http\", \"eavConfig\", \"entitiesSvc\", \"metadataSvc\", \"svcCreator\", \"contentTypeSvc\", function($http, eavConfig, entitiesSvc, metadataSvc, svcCreator, contentTypeSvc) {\r\n        var eavConf = eavConfig;\r\n\r\n        // Construct a service for this specific targetGuid\r\n        return function createSvc(appId, permissionTargetGuid) {\r\n            var svc = {\r\n                PermissionTargetGuid: permissionTargetGuid,\r\n                ctName: \"PermissionConfiguration\",\r\n                ctId: 0,\r\n                EntityAssignment: eavConf.metadataOfEntity,\r\n                ctSvc: contentTypeSvc(appId)\r\n            };\r\n\r\n            svc = angular.extend(svc, svcCreator.implementLiveList(function getAll() {\r\n                // todo: refactor this - get out of the eavmanagemnetsvc\r\n                return metadataSvc.getMetadata(svc.EntityAssignment, svc.PermissionTargetGuid, svc.ctName).then(svc.updateLiveAll);\r\n            }));\r\n\r\n            // 2016-02-14 2dm commented out, don't think the ctId is ever used...\r\n            // Get ID of this content-type \r\n            svc.ctSvc.getDetails(svc.ctName).then(function (result) {\r\n                svc.ctId = result.data.Id; // 2016-02-14 previously AttributeSetId;\r\n            });\r\n\r\n            // delete, then reload\r\n            svc.delete = function del(id) {\r\n                return entitiesSvc.delete(svc.ctName, id)\r\n                    .then(svc.liveListReload);\r\n            };\r\n            return svc;\r\n        };\r\n    }]);\n// PipelineService provides an interface to the Server Backend storing Pipelines and their Pipeline Parts\r\n\r\nangular.module(\"EavServices\")\r\n    .factory(\"pipelineService\", [\"$resource\", \"$q\", \"$filter\", \"eavConfig\", \"$http\", \"contentTypeSvc\", \"metadataSvc\", \"eavAdminDialogs\", function ($resource, $q, $filter, eavConfig, $http, contentTypeSvc, metadataSvc, eavAdminDialogs) {\r\n        \"use strict\";\r\n        var svc = {};\r\n        // Web API Service\r\n        svc.pipelineResource = $resource(\"eav/PipelineDesigner/:action\");\r\n        svc.entitiesResource = $resource(\"eav/Entities/:action\");\r\n\r\n        // 2016-02-18 2dm - not needed?\r\n        // svc.dataPipelineAttributeSetId = 0;\r\n        svc.appId = 0;\r\n\r\n        // Get the Definition of a DataSource\r\n        svc.getDataSourceDefinitionProperty = function (model, dataSource) {\r\n        \tvar definition = $filter(\"filter\")(model.InstalledDataSources, function (d) { return d.PartAssemblyAndType == dataSource.PartAssemblyAndType; })[0];\r\n        \tif (!definition)\r\n        \t\tthrow \"DataSource Definition not found: \" + dataSource.PartAssemblyAndType;\r\n        \treturn definition;\r\n        };\r\n\r\n        // todo refactor: why do we have 2 methods with same name?\r\n        // Extend Pipeline-Model retrieved from the Server\r\n        var postProcessDataSources = function(model) {\r\n            // Append Out-DataSource for the UI\r\n            model.DataSources.push({\r\n                Name: eavConfig.pipelineDesigner.outDataSource.name,\r\n                Description: eavConfig.pipelineDesigner.outDataSource.description,\r\n                EntityGuid: \"Out\",\r\n                PartAssemblyAndType: eavConfig.pipelineDesigner.outDataSource.className,\r\n                VisualDesignerData: eavConfig.pipelineDesigner.outDataSource.visualDesignerData,\r\n                ReadOnly: true\r\n            });\r\n\r\n            // Extend each DataSource with Definition-Property and ReadOnly Status\r\n            angular.forEach(model.DataSources, function(dataSource) {\r\n                dataSource.Definition = function() { return svc.getDataSourceDefinitionProperty(model, dataSource); };\r\n                dataSource.ReadOnly = dataSource.ReadOnly || !model.Pipeline.AllowEdit;\r\n            });\r\n        };\r\n\r\n        angular.extend(svc, { \r\n            \r\n            // get a Pipeline with Pipeline Info with Pipeline Parts and Installed DataSources\r\n            getPipeline: function(pipelineEntityId) {\r\n                var deferred = $q.defer();\r\n\r\n                var getPipeline = svc.pipelineResource.get({ action: \"GetPipeline\", id: pipelineEntityId, appId: svc.appId });\r\n                var getInstalledDataSources = svc.pipelineResource.query({ action: \"GetInstalledDataSources\" });\r\n\r\n                // Join and modify retrieved Data\r\n                $q.all([getPipeline.$promise, getInstalledDataSources.$promise]).then(function(results) {\r\n                    var model = JSON.parse(angular.toJson(results[0])); // workaround to remove AngularJS Promise from the result-Objects\r\n                    model.InstalledDataSources = JSON.parse(angular.toJson(results[1]));\r\n\r\n                    // Init new Pipeline Object\r\n                    if (!pipelineEntityId) {\r\n                        model.Pipeline = {\r\n                            AllowEdit: \"True\"\r\n                        };\r\n                    }\r\n\r\n                    // Add Out-DataSource for the UI\r\n                    model.InstalledDataSources.push({\r\n                        PartAssemblyAndType: eavConfig.pipelineDesigner.outDataSource.className,\r\n                        ClassName: eavConfig.pipelineDesigner.outDataSource.className,\r\n                        In: eavConfig.pipelineDesigner.outDataSource.in,\r\n                        Out: null,\r\n                        allowNew: false\r\n                    });\r\n\r\n                    postProcessDataSources(model);\r\n\r\n                    deferred.resolve(model);\r\n                }, function(reason) {\r\n                    deferred.reject(reason);\r\n                });\r\n\r\n                return deferred.promise;\r\n            },\r\n            // Ensure Model has all DataSources and they're linked to their Definition-Object\r\n            postProcessDataSources: function(model) {\r\n                // stop Post-Process if the model already contains the Out-DataSource\r\n                if ($filter(\"filter\")(model.DataSources, function(d) { return d.EntityGuid == \"Out\"; })[0])\r\n                    return;\r\n\r\n                postProcessDataSources(model);\r\n            },\r\n            // Get a JSON for a DataSource with Definition-Property\r\n            getNewDataSource: function(model, dataSourceBase) {\r\n                return {\r\n                    Definition: function() { return svc.getDataSourceDefinitionProperty(model, dataSourceBase); }\r\n                };\r\n            },\r\n            // Save whole Pipline\r\n            savePipeline: function(pipeline, dataSources) {\r\n                if (!svc.appId)\r\n                    return $q.reject(\"appId must be set to save a Pipeline\");\r\n\r\n                // Remove some Properties from the DataSource before Saving\r\n                var dataSourcesPrepared = [];\r\n                angular.forEach(dataSources, function(dataSource) {\r\n                    var dataSourceClone = angular.copy(dataSource);\r\n                    delete dataSourceClone.ReadOnly;\r\n                    dataSourcesPrepared.push(dataSourceClone);\r\n                });\r\n\r\n                return svc.pipelineResource.save({\r\n                    action: \"SavePipeline\",\r\n                    appId: svc.appId,\r\n                    Id: pipeline.EntityId /*id later EntityId */\r\n                }, { pipeline: pipeline, dataSources: dataSourcesPrepared }).$promise;\r\n            },\r\n            // clone a whole Pipeline\r\n            clonePipeline: function(pipelineEntityId) {\r\n                return svc.pipelineResource.get({ action: \"ClonePipeline\", appId: svc.appId, Id: pipelineEntityId }).$promise;\r\n            },\r\n\r\n\r\n            // Get the URL to configure a DataSource\r\n            editDataSourcePart: function(dataSource) {\r\n                var dataSourceFullName = $filter(\"typename\")(dataSource.PartAssemblyAndType, \"classFullName\");\r\n                var contentTypeName = \"|Config \" + dataSourceFullName; // todo refactor centralize\r\n                var assignmentObjectTypeId = 4; // todo refactor centralize\r\n                var keyGuid = dataSource.EntityGuid;\r\n\r\n                // Query for existing Entity\r\n                metadataSvc.getMetadata(assignmentObjectTypeId, keyGuid, contentTypeName).then(function (result) { \r\n                    var success = result.data;\r\n                    if (success.length) // Edit existing Entity\r\n                        eavAdminDialogs.openItemEditWithEntityId(success[0].Id);\r\n                    else { // Create new Entity\r\n                        var items = [{\r\n                                ContentTypeName: contentTypeName,\r\n                                Metadata: {\r\n                                    TargetType: assignmentObjectTypeId,\r\n                                    KeyType: \"guid\",\r\n                                    Key: keyGuid\r\n                                }}];\r\n                        eavAdminDialogs.openEditItems(items);\r\n                    }\r\n                });\r\n            }\r\n\r\n        });\r\n\r\n        angular.extend(svc, {\r\n            // Query the Data of a Pipeline\r\n            queryPipeline: function (id) {\r\n                return svc.pipelineResource.get({ action: \"QueryPipeline\", appId: svc.appId, id: id }).$promise;\r\n            },\r\n            // set appId and init some dynamic configurations\r\n            setAppId: function (newAppId) {\r\n                svc.appId = newAppId;\r\n            },\r\n\r\n            // 2016-01-14 2dm - commenting out completely, as the getPipelineUrl is probably not used any more\r\n            // Init some Content Types, currently only used for getPipelineUrl('new', ...)\r\n            //initContentTypes: function initContentTypes() {\r\n            //    return contentTypeSvc(svc.appId).getDetails(\"DataPipeline\").then(function (result) {\r\n            //        svc.dataPipelineAttributeSetId = result.data.Id; // 2016-02-14 previously AttributeSetId;\r\n            //    });\r\n            //},\r\n\r\n\r\n            // Get all Pipelines of current App\r\n            getPipelines: function () {\r\n                return svc.entitiesResource.query({ action: \"GetEntities\", appId: svc.appId, contentType: \"DataPipeline\" });\r\n            },\r\n            // Delete a Pipeline on current App\r\n            deletePipeline: function (id) {\r\n                return svc.pipelineResource.get({ action: \"DeletePipeline\", appId: svc.appId, id: id }).$promise;\r\n            }\r\n        });\r\n\r\n        return svc;\r\n    }]);\n/*  this file contains the svcCreator - a helper to quickly create services\r\n */\r\n\r\nangular.module(\"EavServices\")\r\n    // This is a helper-factory to create services which manage one live list\r\n    // check examples with the permissions-service or the content-type-service how we use it\r\n    .factory(\"svcCreator\", [\"toastr\", \"$translate\", \"$timeout\", function (toastr, $translate, $timeout) {\r\n        var creator = {};\r\n\r\n        // construct a object which has liveListCache, liveListReload(), liveListReset(),  \r\n        creator.implementLiveList = function (getLiveList, disableToastr) {\r\n            var t = {};\r\n            t.disableToastr = !!disableToastr;\r\n            t.liveListCache = [];                   // this is the cached list\r\n            t.liveListCache.isLoaded = false;\r\n\r\n            t.liveList = function getAllLive() {\r\n                if (t.liveListCache.length === 0)\r\n                    t.liveListReload();\r\n                return t.liveListCache;\r\n            };\r\n\r\n            // use a promise-result to re-fill the live list of all items, return the promise again\r\n            t._liveListUpdateWithResult = function updateLiveAll(result) {\r\n                if (t.msg.isOpened)\r\n                    toastr.clear(t.msg);\r\n                else {\r\n                    $timeout(300).then(function() {\r\n                            toastr.clear(t.msg);\r\n                        }\r\n                    );\r\n                }\r\n                t.liveListCache.length = 0; // clear\r\n                for (var i = 0; i < result.data.length; i++)\r\n                    t.liveListCache.push(result.data[i]);\r\n                t.liveListCache.isLoaded = true;\r\n                return result;\r\n            };\r\n\r\n            t.liveListSourceRead = getLiveList;\r\n\r\n            t.liveListReload = function getAll() {\r\n                // show loading - must use the promise-mode because this may be used early before the language has arrived\r\n                $translate(\"General.Messages.Loading\").then(function(msg) {\r\n                    t.msg = toastr.info(msg);\r\n                });\r\n                return t.liveListSourceRead()\r\n                    .then(t._liveListUpdateWithResult);\r\n            };\r\n\r\n            t.liveListReset = function resetList() {\r\n                t.liveListCache = [];\r\n            };\r\n\r\n            return t;\r\n        };\r\n        return creator;\r\n\r\n    }])\r\n\r\n;\n\r\nangular.module(\"EavServices\")\r\n    // the config is important to ensure our toaster has a common setup\r\n    .config([\"toastrConfig\", function(toastrConfig) {\r\n        angular.extend(toastrConfig, {\r\n            autoDismiss: false,\r\n            containerId: \"toast-container\",\r\n            maxOpened: 5, // def is 0    \r\n            newestOnTop: true,\r\n            positionClass: \"toast-top-right\",\r\n            preventDuplicates: false,\r\n            preventOpenDuplicates: false,\r\n            target: \"body\"\r\n        });\r\n    }])\r\n\r\n    .factory(\"toastrWithHttpErrorHandling\", [\"toastr\", function (toastr) {\r\n        toastr.originalError = toastr.error;\r\n        toastr.error = function errorWithHttpErrorDisplay(messageOrHttpError, title, optionsOverride) {\r\n            var message;\r\n            // test whether bodyOrError is an Error from Web API\r\n            if (messageOrHttpError && messageOrHttpError.data && messageOrHttpError.data.Message) {\r\n                message = messageOrHttpError.data.Message;\r\n                if (messageOrHttpError.data.ExceptionMessage)\r\n                    message += \"\\n\" + messageOrHttpError.data.ExceptionMessage;\r\n            } else\r\n                message = messageOrHttpError;\r\n\r\n            toastr.originalError(message, title, optionsOverride);\r\n        };\r\n        return toastr;\r\n    }])\r\n\r\n    \r\n    .factory(\"saveToastr\", [\"toastr\", \"$translate\", function (toastr, $translate) {\r\n        function saveWithToaster(promise) {\r\n            // todo: replace all this with a single-line calling the promise-toaster below...\r\n            // ? return saveWithToaster(promise, \"Message.Saving\", \"Message.Saved\", \"Message.ErrorWhileSaving\", null, 3000, null);\r\n                var saving = toastr.info($translate.instant(\"Message.Saving\"));\r\n                return promise.then(function(result) {\r\n                    toastr.clear(saving);\r\n                    toastr.success($translate.instant(\"Message.Saved\"), { timeOut: 3000 });\r\n                    return result;\r\n                }, function errorWhileSaving(result) {\r\n                    toastr.clear(saving);\r\n                    toastr.error($translate.instant(\"Message.ErrorWhileSaving\"));\r\n                    return result;\r\n                });\r\n            }\r\n\r\n            return saveWithToaster;\r\n    }])\r\n\r\n    .factory(\"promiseToastr\", [\"toastrWithHttpErrorHandling\", \"$translate\", function (toastrWithHttpErrorHandling, $translate) {\r\n        function saveWithToaster(promise, keyInfo, keyOk, keyError, durInfo, durOk, durError) {\r\n            var toastr = toastrWithHttpErrorHandling;\r\n            var saving = toastr.info($translate.instant(keyInfo));\r\n            return promise.then(function (result) {\r\n                toastr.clear(saving);\r\n                toastr.success($translate.instant(keyOk), { timeOut: durOk || 1000 });\r\n                return result;\r\n            }, function errorWhileSaving(result) {\r\n                toastr.clear(saving);\r\n                toastr.error(result, $translate.instant(keyError));\r\n                return result;\r\n            });\r\n        }\r\n\r\n        return saveWithToaster;\r\n    }])\r\n;\nangular.module(\"eavTemplates\", []).run([\"$templateCache\", function($templateCache) {$templateCache.put(\"content-import-export/content-export.html\",\"\\r\\n<div class=\\\"modal-header\\\">\\r\\n    <button class=\\\"btn btn-default btn-square btn-subtle pull-right\\\" type=\\\"button\\\" icon=\\\"remove\\\" ng-click=\\\"vm.close()\\\"></button>\\r\\n    <h3 class=\\\"modal-title\\\" translate=\\\"Content.Export.Title\\\">cc</h3>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"modal-body\\\">\\r\\n    <div translate=\\\"Content.Export.Help\\\"></div>\\r\\n    <formly-form form=\\\"vm.form\\\" model=\\\"vm.formValues\\\" fields=\\\"vm.formFields\\\">\\r\\n    </formly-form>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"modal-footer\\\">\\r\\n    <button type=\\\"button\\\" class=\\\"btn btn-primary pull-left\\\" ng-click=\\\"vm.exportContent()\\\" translate=\\\"Content.Export.Commands.Export\\\"></button>\\r\\n</div>\");\n$templateCache.put(\"content-import-export/content-import.html\",\"<div ng-click=\\\"vm.debug.autoEnableAsNeeded($event)\\\">\\r\\n    <!-- HEADER -->\\r\\n    <div class=\\\"modal-header\\\">\\r\\n        <button class=\\\"btn btn-default btn-square btn-subtle pull-right\\\" type=\\\"button\\\" icon=\\\"remove\\\" ng-click=\\\"vm.close()\\\"></button>\\r\\n        <h3 class=\\\"modal-title\\\"><span  translate=\\\"Content.Import.Title\\\"></span> <span ng-show=\\\"vm.viewStateSelected > 0\\\" translate=\\\"Content.Import.TitleSteps\\\" translate-values=\\\"{step: vm.viewStateSelected}\\\"></span></h3>\\r\\n    </div>\\r\\n    <!-- END HEADER -->\\r\\n\\r\\n    <div ng-switch=\\\"vm.viewStateSelected\\\">\\r\\n\\r\\n        <!-- FORM -->\\r\\n        <div ng-switch-when=\\\"1\\\">\\r\\n            <div class=\\\"modal-body\\\">\\r\\n                <div translate=\\\"Content.Import.Help\\\"></div>\\r\\n                <formly-form form=\\\"vm.form\\\" model=\\\"vm.formValues\\\" fields=\\\"vm.formFields\\\"></formly-form>\\r\\n                <div class=\\\"text-warning\\\" translate=\\\"Content.Import.Messages.BackupContentBefore\\\"></div>\\r\\n            </div>\\r\\n            <div class=\\\"modal-footer\\\">\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-primary pull-left\\\" ng-click=\\\"vm.evaluateContent()\\\" ng-disabled=\\\"!vm.formValues.File || !vm.formValues.File.filename\\\" translate=\\\"Content.Import.Commands.Preview\\\"></button>\\r\\n            </div>\\r\\n        </div>\\r\\n        <!-- END FORM -->\\r\\n\\r\\n\\r\\n        <!-- WAITING -->\\r\\n        <div ng-switch-when=\\\"0\\\">\\r\\n            <div class=\\\"modal-body\\\"> {{\\'Content.Import.Messages.WaitingForResponse\\' | translate}}\\r\\n            </div>\\r\\n        </div>\\r\\n        <!-- END WAITING -->\\r\\n\\r\\n\\r\\n        <!-- EVALUATION RESULT -->\\r\\n        <div ng-switch-when=\\\"2\\\">\\r\\n            <div class=\\\"modal-body\\\">\\r\\n                <!-- DETAILS / STATISTICS -->\\r\\n                <div ng-if=\\\"vm.evaluationResult.Succeeded\\\">\\r\\n                    <h4 translate=\\\"Content.Import.Evaluation.Detail.Title\\\" translate-values=\\\"{filename: vm.formValues.File.filename}\\\"></h4>\\r\\n                    <h5 translate=\\\"Content.Import.Evaluation.Detail.File.Title\\\"></h5>\\r\\n                    <ul>\\r\\n                        <li translate=\\\"Content.Import.Evaluation.Detail.File.ElementCount\\\" translate-values=\\\"{count: vm.evaluationResult.Detail.DocumentElementsCount}\\\"></li>\\r\\n                        <li translate=\\\"Content.Import.Evaluation.Detail.File.LanguageCount\\\" translate-values=\\\"{count: vm.evaluationResult.Detail.LanguagesInDocumentCount}\\\"></li>\\r\\n                        <li translate=\\\"Content.Import.Evaluation.Detail.File.Attributes\\\" translate-values=\\\"{count: vm.evaluationResult.Detail.AttributeNamesInDocument.length, attributes: vm.evaluationResult.Detail.AttributeNamesInDocument.join(\\', \\')}\\\"></li>\\r\\n                    </ul>\\r\\n                    <h5 translate=\\\"Content.Import.Evaluation.Detail.Entities.Title\\\"></h5>\\r\\n                    <ul>\\r\\n                        <li translate=\\\"Content.Import.Evaluation.Detail.Entities.Create\\\" translate-values=\\\"{count: vm.evaluationResult.Detail.AmountOfEntitiesCreated}\\\"></li>\\r\\n                        <li translate=\\\"Content.Import.Evaluation.Detail.Entities.Update\\\" translate-values=\\\"{count: vm.evaluationResult.Detail.AmountOfEntitiesUpdated}\\\"></li>\\r\\n                        <li translate=\\\"Content.Import.Evaluation.Detail.Entities.Delete\\\" translate-values=\\\"{count: vm.evaluationResult.Detail.AmountOfEntitiesDeleted}\\\"></li>\\r\\n                        <li translate=\\\"Content.Import.Evaluation.Detail.Entities.AttributesIgnored\\\" translate-values=\\\"{count: vm.evaluationResult.Detail.AttributeNamesNotImported.length, attributes: vm.evaluationResult.Detail.AttributeNamesNotImported.join(\\', \\')}\\\"></li>\\r\\n                    </ul>\\r\\n                    <div class=\\\"text-warning\\\" translate=\\\"Content.Import.Messages.ImportCanTakeSomeTime\\\"></div>\\r\\n                </div>\\r\\n                <!-- END DETAILS / STATISTICS -->\\r\\n                <!-- ERRORS -->\\r\\n                <div ng-if=\\\"!vm.evaluationResult.Succeeded\\\">\\r\\n                    <h4 translate=\\\"Content.Import.Evaluation.Error.Title\\\" translate-values=\\\"{filename: vm.formValues.File.filename}\\\"></h4>\\r\\n                    <ul>\\r\\n                        <li ng-repeat=\\\"error in vm.evaluationResult.Detail\\\">\\r\\n                            <div><span translate=\\\"Content.Import.Evaluation.Error.Codes.{{error.ErrorCode}}\\\"></span></div>\\r\\n                            <div ng-if=\\\"error.ErrorDetail\\\"><i translate=\\\"Content.Import.Evaluation.Error.Detail\\\" translate-values=\\\"{detail: error.ErrorDetail}\\\"></i>\\r\\n                            </div>\\r\\n                            <div ng-if=\\\"error.LineNumber\\\"><i translate=Content.Import.Evaluation.Error.LineNumber\\\" translate-values=\\\"{number: error.LineNumber}\\\"></i>\\r\\n                            </div>\\r\\n                            <div ng-if=\\\"error.LineDetail\\\"><i translate=\\\"Content.Import.Evaluation.Error.LineDetail\\\" translate-values=\\\"{detail: error.LineDetail}\\\"></i>\\r\\n                            </div>\\r\\n                        </li>\\r\\n                    </ul>\\r\\n                </div>\\r\\n                <!-- END ERRORS -->\\r\\n            </div>\\r\\n            <div class=\\\"modal-footer\\\">\\r\\n                <button type=\\\"button\\\" class=\\\"btn pull-left\\\" ng-click=\\\"vm.back()\\\" icon=\\\"arrow-left\\\"></button>\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-default pull-left\\\" ng-click=\\\"vm.importContent()\\\" translate=\\\"Content.Import.Commands.Import\\\" ng-disabled=\\\"!vm.evaluationResult.Succeeded\\\"></button>\\r\\n            </div>\\r\\n        </div>\\r\\n        <!-- END EVALUATION RESULT -->\\r\\n\\r\\n\\r\\n        <!-- IMPORT RESULT -->\\r\\n        <div ng-switch-when=\\\"3\\\">\\r\\n            <div class=\\\"modal-body\\\">\\r\\n                <span ng-show=\\\"vm.importResult.Succeeded\\\" translate=\\\"Content.Import.Messages.ImportSucceeded\\\"></span>\\r\\n                <span ng-hide=\\\"vm.importResult.Succeeded\\\" translate=\\\"Content.Import.Messages.ImportFailed\\\"></span>\\r\\n            </div>\\r\\n        </div>\\r\\n        <!-- END IMPORT RESULT -->\\r\\n\\r\\n        <div ng-if=\\\"vm.debug.on\\\">\\r\\n            <h3>Debug infos</h3>\\r\\n            <pre>{{vm.formValues | json}}</pre>\\r\\n        </div>\\r\\n    </div>\\r\\n</div>\");\n$templateCache.put(\"permissions/permissions.html\",\"    <div class=\\\"modal-header\\\">\\r\\n        <button class=\\\"btn btn-default btn-square pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.close()\\\"><i icon=\\\"remove\\\"></i></button>\\r\\n        <h3 class=\\\"modal-title\\\" translate=\\\"Permissions.Title\\\"></h3>\\r\\n    </div>\\r\\n    <div class=\\\"modal-body\\\">\\r\\n\\r\\n        <button type=\\\"button\\\" class=\\\"btn btn-primar btn-square\\\" ng-click=\\\"vm.add()\\\"><i icon=\\\"plus\\\"></i></button>\\r\\n        <button ng-if=\\\"vm.debug.on\\\" type=\\\"button\\\" class=\\\"btn btn-square\\\" ng-click=\\\"vm.refresh()\\\"><i icon=\\\"repeat\\\"></i></button>\\r\\n\\r\\n        <table class=\\\"table table-striped table-hover table-manage-eav\\\">\\r\\n            <thead>\\r\\n            <tr>\\r\\n                <th translate=\\\"Permissions.Table.Id\\\" style=\\\"width: 60px\\\"></th>\\r\\n                <th translate=\\\"Permissions.Table.Name\\\" style=\\\"width: 33%\\\"></th>\\r\\n                <th translate=\\\"Permissions.Table.Condition\\\" style=\\\"width: 33%\\\"></th>\\r\\n                <th translate=\\\"Permissions.Table.Grant\\\" style=\\\"width: 33%\\\"></th>\\r\\n                <th translate=\\\"Permissions.Table.Actions\\\" style=\\\"width: 40px\\\"></th>\\r\\n            </tr>\\r\\n            </thead>\\r\\n            <tbody>\\r\\n            <tr ng-repeat=\\\"item in vm.items | orderBy:\\'Title\\'\\\" class=\\\"clickable-row\\\" ng-click=\\\"vm.edit(item)\\\">\\r\\n                <td class=\\\"clickable\\\">{{item.Id}}</td>\\r\\n                <td class=\\\"clickable\\\">{{item.Title}}</td>\\r\\n                <td class=\\\"clickable\\\">{{item.Condition}}</td>\\r\\n                <td class=\\\"clickable\\\">{{item.Grant}}</td>\\r\\n                <td class=\\\"text-nowrap\\\" stop-event=\\\"click\\\">\\r\\n                    <button icon=\\\"remove\\\" type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-click=\\\"vm.tryToDelete(item)\\\"></button>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr ng-if=\\\"!vm.items.length\\\">\\r\\n                <td colspan=\\\"100\\\" translate=\\\"General.Messages.NothingFound\\\"></td>\\r\\n            </tr>\\r\\n            </tbody>\\r\\n        </table>\\r\\n    </div>\");\n$templateCache.put(\"content-items/content-edit.html\",\"<div class=\\\"modal-header\\\">\\r\\n    <button type=\\\"button\\\" class=\\\"btn btn-default btn-subtle\\\" ng-click=\\\"vm.history()\\\">\\r\\n        <span class=\\\"glyphicon glyphicon-time\\\"> history / todo </span>\\r\\n    </button>\\r\\n    <h3 class=\\\"modal-title\\\">Edit / New Content</h3>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"modal-body\\\">\\r\\n    this is where the edit appears. Would edit entity {{vm.entityId}} or add a {{vm.contentType}} - depending on the mode: {{vm.mode}}\\r\\n    <h3>Use cases</h3>\\r\\n    <ol>\\r\\n        <li>Edit an existing entity with ID</li>\\r\\n        <li>Create a new entity of a certaint content-type, just save and done (like from a \\\"new\\\" button without content-group)</li>\\r\\n        <li>Create a new entity of a certain type and assign it to a metadata thing (guid, int, string)</li>\\r\\n\\r\\n        <li>Create a new entity and put it into a content-group at the right place</li>\\r\\n        <li>Edit content-group: item + presentation </li>\\r\\n        <li>Edit multiple IDs/or new/mix: Edit multiple items with IDs</li>\\r\\n    </ol>\\r\\n\\r\\n    init of 1 edit\\r\\n    - entity-id in storage\\r\\n    - new-type + optional: assignment-id + assignment-type\\r\\n\\r\\n    - array of the above\\r\\n    --- [{id 17}, {type: \\\"person\\\"}, {type: person, asstype: 4, target: 0205}]\\r\\n\\r\\n    - content-group\\r\\n</div>\\r\\n\");\n$templateCache.put(\"content-items/content-items-agnostic.html\",\"<div ng-click=\\\"vm.debug.autoEnableAsNeeded($event)\\\" class=\\\"content-items-agnostic\\\">\\r\\n    <div class=\\\"modal-header\\\">\\r\\n        <button class=\\\"btn btn-default btn-square btn-subtle pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.close()\\\"><i icon=\\\"remove\\\"></i></button>\\r\\n        <h3 class=\\\"modal-title\\\" translate=\\\"Content.Manage.Title\\\"></h3>\\r\\n    </div>\\r\\n    <div class=\\\"modal-body\\\">\\r\\n        <button type=\\\"button\\\" class=\\\"btn btn-primary btn-square\\\" ng-click=\\\"vm.add()\\\"><i icon=\\\"plus\\\"></i></button>\\r\\n\t    <button ng-if=\\\"vm.debug.on\\\" type=\\\"button\\\" class=\\\"btn btn-warning btn-square\\\" ng-click=\\\"vm.refresh()\\\"><i icon=\\\"repeat\\\"></i></button>\\r\\n\\r\\n\t\t<div ag-grid=\\\"vm.gridOptions\\\" class=\\\"ag-grid-wrapper\\\"></div>\\r\\n\t    \\r\\n        <show-debug-availability class=\\\"pull-right\\\" ></show-debug-availability>\\r\\n    </div>\\r\\n</div>\");\n$templateCache.put(\"content-items/content-items.html\",\"<div ng-click=\\\"vm.debug.autoEnableAsNeeded($event)\\\">\\r\\n    <div class=\\\"modal-header\\\">\\r\\n        <button class=\\\"btn btn-default btn-square btn-subtle pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.close()\\\"><i icon=\\\"remove\\\"></i></button>\\r\\n        <h3 class=\\\"modal-title\\\" translate=\\\"Content.Manage.Title\\\"></h3>\\r\\n    </div>\\r\\n    <div class=\\\"modal-body\\\">\\r\\n        <button type=\\\"button\\\" class=\\\"btn btn-primary btn-square\\\" ng-click=\\\"vm.add()\\\"><i icon=\\\"plus\\\"></i></button>\\r\\n        <button ng-if=\\\"vm.debug.on\\\" type=\\\"button\\\" class=\\\"btn btn-warning btn-square\\\" ng-click=\\\"vm.refresh()\\\"><i icon=\\\"repeat\\\"></i></button>\\r\\n\\r\\n        <div style=\\\"overflow: auto\\\">\\r\\n            <table class=\\\"table table-hover table-manage-eav\\\">\\r\\n                <thead>\\r\\n                <tr>\\r\\n                    <th translate=\\\"Content.Manage.Table.Id\\\" class=\\\"col-id\\\"></th>\\r\\n                    <th translate=\\\"Content.Manage.Table.Status\\\" style=\\\"width: 60px\\\"></th>\\r\\n                    <th translate=\\\"Content.Manage.Table.Title\\\" style=\\\"width: 200px\\\"></th>\\r\\n                    <th translate=\\\"Content.Manage.Table.Actions\\\" class=\\\"mini-btn-2\\\"></th>\\r\\n                    <th ng-repeat=\\\"col in vm.dynamicColumns\\\" style=\\\"width: 10%\\\">{{col.StaticName}}</th>\\r\\n                </tr>\\r\\n                </thead>\\r\\n                <tbody>\\r\\n                <tr ng-repeat=\\\"item in vm.items | orderBy: [\\'Id\\',\\'-IsPublished\\'] \\\" class=\\\"clickable-row\\\" ng-click=\\\"vm.edit(item)\\\">\\r\\n                    <td class=\\\"text-nowrap clickable\\\" style=\\\"text-align: right\\\">\\r\\n                        <span tooltip=\\\"Id: {{item.Id}}\\r\\nRepoId: {{item.RepositoryId}}\\r\\nGuid: {{item.Guid}}\\\">{{item.Id}}</span>\\r\\n                    </td>\\r\\n                    <td class=\\\"text-nowrap\\\">\\r\\n                        <span class=\\\"glyphicon\\\" ng-class=\\\"{\\'glyphicon-eye-open\\': item.IsPublished, \\'glyphicon-eye-close\\' : !item.IsPublished}\\\" tooltip=\\\"{{ \\'Content.Publish.\\' + (item.IsPublished ? \\'PnV\\': item.Published ? \\'DoP\\' : \\'D\\') | translate }}\\\"></span>\\r\\n                        <span icon=\\\"{{ item.Draft ? \\'link\\' : item.Published ? \\'link\\' : \\'\\' }}\\\" tooltip=\\\"{{ (item.Draft ? \\'Content.Publish.HD\\' :\\'\\') | translate:\\'{ id: item.Draft.RepositoryId}\\' }}\\r\\n{{ (item.Published ? \\'Content.Publish.HP\\' :\\'\\') | translate }} #{{ item.Published.RepositoryId }}\\\"></span>\\r\\n                        <span ng-if=\\\"item.Metadata\\\" tooltip=\\\"Metadata for type {{ item.Metadata.TargetType}}, id {{ item.Metadata.KeyNumber }}{{ item.Metadata.KeyString }}{{ item.Metadata.KeyGuid }}\\\" icon=\\\"tag\\\"></span>\\r\\n                    </td>\\r\\n                    <td class=\\\"text-nowrap clickable\\\">\\r\\n                        <div class=\\\"hide-overflow-text\\\" style=\\\"height: 20px; width: 200px\\\" tooltip=\\\"{{item.Title}}\\\">\\r\\n                            {{item.Title}}{{ (!item.Title ? \\'Content.Manage.NoTitle\\':\\'\\') | translate }}\\r\\n                        </div>\\r\\n                    </td>\\r\\n                    <td class=\\\"text-nowrap\\\" stop-event=\\\"click\\\">\\r\\n                        <button type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-click=\\\"vm.openDuplicate(item)\\\" tooltip=\\\"{{ \\'General.Buttons.Copy\\' | translate }}\\\"><i icon=\\\"duplicate\\\"></i></button>\\r\\n                        <button type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-click=\\\"vm.tryToDelete(item)\\\" tooltip=\\\"{{ \\'General.Buttons.Delete\\' | translate }}\\\"><i icon=\\\"remove\\\"></i> </button>\\r\\n                    </td>\\r\\n                    <td ng-repeat=\\\"col in vm.dynamicColumns\\\" width=\\\"10%\\\">\\r\\n                        <div style=\\\"height: 20px; max-width: 300px;\\\" class=\\\"hide-overflow-text\\\" tooltip=\\\"{{item[col.StaticName]}}\\\">{{item[col.StaticName].toString().substring(0,25)}}</div>\\r\\n                    </td>\\r\\n\\r\\n                </tr>\\r\\n                <tr ng-if=\\\"!vm.items.length\\\">\\r\\n                    <td colspan=\\\"100\\\" translate=\\\"General.Messages.NothingFound\\\"></td>\\r\\n                </tr>\\r\\n                </tbody>\\r\\n            </table>\\r\\n        </div>\\r\\n        <show-debug-availability class=\\\"pull-right\\\" ></show-debug-availability>\\r\\n    </div>\\r\\n</div>\");\n$templateCache.put(\"content-items/history-details.html\",\"<div>\\r\\n    <div class=\\\"modal-header\\\">\\r\\n        <button class=\\\"btn btn-default btn-subtle btn-square pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.close()\\\">\\r\\n            <span class=\\\"glyphicon glyphicon-remove\\\"></span>\\r\\n        </button>\\r\\n        <h3 class=\\\"modal-title\\\">History Details {{vm.ChangeId}} of {{vm.entityId}}</h3>\\r\\n    </div>\\r\\n    <div class=\\\"modal-body\\\">\\r\\n        <h1>todo</h1>\\r\\n        <table class=\\\"table table-striped table-hover\\\">\\r\\n            <thead>\\r\\n            <tr>\\r\\n                <th>Field</th>\\r\\n                <th>Language</th>\\r\\n                <th>Value</th>\\r\\n                <th>SharedWith</th>\\r\\n            </tr>\\r\\n            </thead>\\r\\n            <tbody>\\r\\n            <tr ng-repeat=\\\"item in vm.items | orderBy:SysCreatedDate:reverse\\\">\\r\\n                <td>{{item.Field}}</td>\\r\\n                <td>{{item.Language}}</td>\\r\\n                <td>{{item.Value}}</td>\\r\\n                <td>{{item.SharedWith}}</td>\\r\\n\\r\\n            </tr>\\r\\n            <tr ng-if=\\\"!vm.items.length\\\">\\r\\n                <td colspan=\\\"100\\\">No History</td>\\r\\n            </tr>\\r\\n            </tbody>\\r\\n        </table>\\r\\n\\r\\n        <button class=\\\"btn btn-primary pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.restore()\\\">\\r\\n            <span class=\\\"glyphicon glyphicon-ok\\\">todo restore</span>\\r\\n        </button>    </div>\\r\\n\\r\\n</div>\");\n$templateCache.put(\"content-items/history.html\",\"<div>\\r\\n    <div class=\\\"modal-header\\\">\\r\\n        <button class=\\\"btn btn-default btn-square btn-subtle pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.close()\\\">\\r\\n            <span class=\\\"glyphicon glyphicon-remove\\\"></span>\\r\\n        </button>\\r\\n        <h3 class=\\\"modal-title\\\">{{ \\\"Content.History.Title\\\" | translate:\\'{ id:vm.entityId }\\' }}History of {{vm.entityId}}</h3>\\r\\n    </div>\\r\\n    <div class=\\\"modal-body\\\">\\r\\n\\r\\n        <table class=\\\"table table-striped table-hover\\\">\\r\\n            <thead>\\r\\n            <tr>\\r\\n                <th translate=\\\"Content.History.Table.Id\\\"></th>\\r\\n                <th translate=\\\"Content.History.Table.When\\\"></th>\\r\\n                <th translate=\\\"Content.History.Table.User\\\"></th>\\r\\n                <th translate=\\\"Content.History.Table.Action\\\"></th>\\r\\n            </tr>\\r\\n            </thead>\\r\\n            <tbody>\\r\\n            <tr ng-repeat=\\\"item in vm.items | orderBy:SysCreatedDate:reverse\\\">\\r\\n                <td><span tooltip=\\\"ChangeId: {{item.ChangeId}}\\\">{{item.VirtualVersion}}</span></td>\\r\\n                <td>{{item.SysCreatedDate.replace(\\\"T\\\", \\\" \\\")}}</td>\\r\\n                <td>{{item.User}}</td>\\r\\n                <td>\\r\\n                    <button type=\\\"button\\\" class=\\\"btn btn-xs\\\" ng-click=\\\"vm.details(item)\\\">\\r\\n                        <span class=\\\"glyphicon glyphicon-search\\\"></span>\\r\\n                    </button>\\r\\n                </td>\\r\\n            </tr>\\r\\n                <tr ng-if=\\\"!vm.items.length\\\">\\r\\n                    <td colspan=\\\"100\\\" translate=\\\"General.Messages.NothingFound\\\"></td>\\r\\n                </tr>\\r\\n            </tbody>\\r\\n        </table>\\r\\n    </div>\\r\\n\\r\\n</div>\");\n$templateCache.put(\"content-types/content-types-edit.html\",\"<div ng-click=\\\"vm.debug.autoEnableAsNeeded($event)\\\">\\r\\n    <div class=\\\"modal-header\\\">\\r\\n        <button class=\\\"btn btn-default btn-square btn-subtle pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.close()\\\"><i icon=\\\"remove\\\"></i></button>\\r\\n        <h3 class=\\\"modal-title\\\" translate=\\\"ContentTypeEdit.Title\\\"></h3>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"modal-body\\\">\\r\\n        {{ \\\"ContentTypeEdit.Name\\\" | translate }}: <br />\\r\\n        <input ng-model=\\\"vm.item.Name\\\" class=\\\"input-lg\\\" />\\r\\n        <br />\\r\\n        {{ \\\"ContentTypeEdit.Description\\\" | translate }}: <br />\\r\\n        <input ng-model=\\\"vm.item.Description\\\" class=\\\"input-lg\\\"/><br/>\\r\\n\\r\\n        <div>\\r\\n            {{ \\\"ContentTypeEdit.Scope\\\" | translate }}: <br />\\r\\n            <span ng-if=\\\"vm.debug.on\\\">\\r\\n                <div class=\\\"alert alert-danger\\\">the scope should almost never be changed - <a href=\\\"http://2sxc.org/help?tag=scope\\\" _target=\\\"_blank\\\">see help</a></div>\\r\\n            </span>\\r\\n            <input ng-disabled=\\\"!vm.debug.on\\\" ng-model=\\\"vm.item.Scope\\\" class=\\\"input-lg\\\" />\\r\\n        </div>\\r\\n\\r\\n        <div ng-if=\\\"vm.debug.on\\\" class=\\\"alert-danger\\\">\\r\\n            <h3>Static Name</h3>\\r\\n            <input type=\\\"checkbox\\\" class=\\\"input-lg\\\" ng-model=\\\"vm.item.ChangeStaticName\\\"/> Really edit StaticName??? - this is usually a very bad idea\\r\\n            <br/>\\r\\n            <input ng-model=\\\"vm.item.NewStaticName\\\" ng-disabled=\\\"!vm.item.ChangeStaticName\\\" class=\\\"input-lg\\\"/>\\r\\n        </div>\\r\\n        <div ng-if=\\\"vm.debug.on\\\" class=\\\"alert-danger\\\">\\r\\n            <h3>Shared Content Type (Ghost)</h3>\\r\\n            <div>Note: this can\\'t be edited in the UI, for now if you really know what you\\'re doing, do it in the DB</div>\\r\\n            <div>Uses Type Definition of: {{vm.item.SharedDefId}}</div> \\r\\n        </div>\\r\\n    </div>\\r\\n    <div class=\\\"modal-footer\\\">\\r\\n        <button class=\\\"btn btn-primary btn-square pull-left btn-lg\\\" type=\\\"button\\\" ng-click=\\\"vm.ok()\\\"><i icon=\\\"ok\\\"></i></button>\\r\\n        <show-debug-availability class=\\\"pull-right\\\" style=\\\"margin-top: 20px;\\\"></show-debug-availability>\\r\\n    </div>\\r\\n</div>\");\n$templateCache.put(\"content-types/content-types-field-edit.html\",\"<div class=\\\"modal-header\\\">\\r\\n    <button icon=\\\"remove\\\" class=\\\"btn btn-default btn-square btn-subtle pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.close()\\\"></button>\\r\\n    <h3 class=\\\"modal-title\\\" translate=\\\"Fields.TitleEdit\\\"></h3>\\r\\n</div>\\r\\n<div class=\\\"modal-body\\\">\\r\\n    <table class=\\\"table table-hover table-manage-eav\\\">\\r\\n        <thead>\\r\\n        <tr>\\r\\n            <th translate=\\\"Fields.Table.Name\\\" style=\\\"width: 33%\\\"></th>\\r\\n            <th translate=\\\"Fields.Table.DataType\\\" style=\\\"width: 33%\\\">Data Type</th>\\r\\n            <th translate=\\\"Fields.Table.InputType\\\" style=\\\"width: 33%\\\">Input Type</th>\\r\\n        </tr>\\r\\n        </thead>\\r\\n        <tbody>\\r\\n        <tr ng-repeat=\\\"item in vm.items\\\">\\r\\n            <td>\\r\\n                <input ng-model=\\\"item.StaticName\\\" ng-required=\\\"true\\\" class=\\\"input-lg\\\" style=\\\"width: 100%\\\" disabled=\\\"disabled\\\"/>\\r\\n            </td>\\r\\n            <td>\\r\\n                <input ng-model=\\\"item.Type\\\" disabled=\\\"disabled\\\" class=\\\"input-lg\\\" style=\\\"width: 100%\\\"/>\\r\\n            </td>\\r\\n            <td>\\r\\n                <select class=\\\"input-lg\\\" ng-model=\\\"item.InputType\\\" style=\\\"width: 100%\\\"\\r\\n                        tooltip=\\\"{{ (vm.allInputTypes | filter: { inputType: item.InputType})[0].description }}\\\"\\r\\n                        ng-options=\\\"o.inputType as o.label for o in vm.allInputTypes | filter: {dataType: item.Type.toLowerCase() } \\\">\\r\\n                </select>\\r\\n\\r\\n            </td>\\r\\n        </tr>\\r\\n        </tbody>\\r\\n    </table>\\r\\n</div>\\r\\n<div class=\\\"modal-footer\\\">\\r\\n    <button icon=\\\"ok\\\" class=\\\"btn btn-lg btn-primary btn-square pull-left\\\" type=\\\"button\\\" ng-click=\\\"vm.ok()\\\"></button>\\r\\n</div>\");\n$templateCache.put(\"content-types/content-types-fields-add.html\",\"<div class=\\\"modal-header\\\">\\r\\n    <button icon=\\\"remove\\\" class=\\\"btn btn-default btn-square btn-subtle pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.close()\\\"></button>\\r\\n    <h3 class=\\\"modal-title\\\" translate=\\\"Fields.TitleEdit\\\"></h3>\\r\\n</div>\\r\\n<div class=\\\"modal-body\\\">\\r\\n    <table class=\\\"table table-hover table-manage-eav\\\">\\r\\n        <thead>\\r\\n        <tr>\\r\\n            <th translate=\\\"Fields.Table.Name\\\" style=\\\"width: 33%\\\"></th>\\r\\n            <th translate=\\\"Fields.Table.DataType\\\" style=\\\"width: 33%\\\">Data Type</th>\\r\\n            <th translate=\\\"Fields.Table.InputType\\\" style=\\\"width: 33%\\\">Input Type</th>\\r\\n        </tr>\\r\\n        </thead>\\r\\n        <tbody>\\r\\n        <tr ng-repeat=\\\"item in vm.items\\\">\\r\\n            <td>\\r\\n                <input ng-model=\\\"item.StaticName\\\" ng-required=\\\"true\\\" class=\\\"input-lg\\\" style=\\\"width: 100%\\\"/>\\r\\n            </td>\\r\\n            <td>\\r\\n                <select class=\\\"input-lg\\\" ng-model=\\\"item.Type\\\" style=\\\"width: 100%\\\"\\r\\n                        tooltip=\\\"{{ \\'DataType.\\' + item.Type + \\'.Explanation\\' | translate }}\\\"\\r\\n                        ng-options=\\\"o as \\'DataType.\\' + o + \\'.Choice\\' | translate for o in vm.types | orderBy: \\'toString()\\' \\\"\\r\\n                        ng-change=\\\"vm.resetSubTypes(item)\\\">\\r\\n                    <option>-- select --</option>\\r\\n                </select>\\r\\n            </td>\\r\\n            <td>\\r\\n                <select class=\\\"input-lg\\\" ng-model=\\\"item.InputType\\\" style=\\\"width: 100%\\\"\\r\\n                        tooltip=\\\"{{ (vm.allInputTypes | filter: { inputType: item.InputType})[0].description }}\\\"\\r\\n                        ng-options=\\\"o.inputType as o.label for o in vm.allInputTypes | filter: {dataType: item.Type.toLowerCase() } \\\">\\r\\n                </select>\\r\\n\\r\\n            </td>\\r\\n        </tr>\\r\\n        </tbody>\\r\\n    </table>\\r\\n</div>\\r\\n<div class=\\\"modal-footer\\\">\\r\\n    <button icon=\\\"ok\\\" class=\\\"btn btn-lg btn-primary btn-square pull-left\\\" type=\\\"button\\\" ng-click=\\\"vm.ok()\\\"></button>\\r\\n</div>\");\n$templateCache.put(\"content-types/content-types-fields.html\",\"<div>\\r\\n\\r\\n    <div class=\\\"modal-header\\\">\\r\\n        <button class=\\\"btn btn-default btn-subtle btn-square pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.close()\\\"><i icon=\\\"remove\\\"></i></button>\\r\\n        <h3 class=\\\"modal-title\\\" translate=\\\"Fields.Title\\\"></h3>\\r\\n    </div>\\r\\n    <div class=\\\"modal-body\\\">\\r\\n        <button icon=\\\"plus\\\" ng-click=\\\"vm.add()\\\" class=\\\"btn btn-primary btn-square\\\"></button>\\r\\n\\r\\n        <!-- Table of content types for editing -->\\r\\n        <table class=\\\"table table-hover table-manage-eav\\\">\\r\\n            <thead>\\r\\n                <tr>\\r\\n                    <th translate=\\\"Fields.Table.Title\\\" class=\\\"mini-btn-1\\\"></th>\\r\\n                    <th translate=\\\"Fields.Table.Name\\\" style=\\\"width: 40%\\\"></th>\\r\\n                    <th translate=\\\"Fields.Table.DataType\\\" style=\\\"width: 20%\\\"></th>\\r\\n                    <th translate=\\\"Fields.Table.InputType\\\" style=\\\"width: 20%\\\"></th>\\r\\n                    <th translate=\\\"Fields.Table.Label\\\" style=\\\"width: 30%\\\"></th>\\r\\n                    <th translate=\\\"Fields.Table.Notes\\\" style=\\\"width: 50%\\\"></th>\\r\\n                    <th translate=\\\"Fields.Table.Sort\\\" class=\\\"mini-btn-2\\\"></th>\\r\\n                    <th translate=\\\"Fields.Table.Action\\\" class=\\\"mini-btn-1\\\"></th>\\r\\n                </tr>\\r\\n            </thead>\\r\\n            <tbody>\\r\\n                <tr ng-repeat=\\\"item in vm.items | orderBy: \\'SortOrder\\'\\\" class=\\\"clickable-row\\\" ng-click=\\\"vm.createOrEditMetadata(item, item.Type)\\\">\\r\\n                    <td stop-event=\\\"click\\\">\\r\\n                        <button type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-style=\\\"(item.IsTitle ? \\'\\' : \\'color: transparent !important\\')\\\" ng-click=\\\"vm.setTitle(item)\\\">\\r\\n                            <i icon=\\\"{{item.IsTitle ? \\'star\\' : \\'star-empty\\'}}\\\"></i>\\r\\n                        </button>\\r\\n                    </td>\\r\\n                    <td class=\\\"clickable\\\"><span tooltip=\\\"{{ \\'Id: \\' + item.Id}}\\\">{{item.StaticName}}</span></td>\\r\\n                    <td class=\\\"text-nowrap clickable\\\">\\r\\n                        {{item.Type}}\\r\\n                    </td>\\r\\n                    <td class=\\\"text-nowrap InputType\\\" stop-event=\\\"click\\\">\\r\\n                        <span class=\\\"clickable\\\" tooltip=\\\"{{ vm.inputTypeTooltip(item.InputType) }}\\\" ng-click=\\\"vm.edit(item)\\\">\\r\\n                            <i icon=\\\"pencil\\\"></i>\\r\\n                            {{item.InputType.substring(item.InputType.indexOf(\\'-\\') + 1, 100)}}\\r\\n                        </span>\\r\\n                    </td>\\r\\n                    <td class=\\\"text-nowrap clickable\\\">\\r\\n                        {{item.Metadata.All.Name}}\\r\\n                    </td>\\r\\n                    <!--<td>-</td>-->\\r\\n                    <td class=\\\"text-nowrap clickable\\\">\\r\\n                        <div class=\\\"hide-overflow-text\\\">\\r\\n                            {{item.Metadata.All.Notes}}\\r\\n                        </div>\\r\\n                    </td>\\r\\n\\r\\n                    <td class=\\\"text-nowrap\\\" stop-event=\\\"click\\\">\\r\\n                        <button icon=\\\"arrow-up\\\" type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-disabled=\\\"$first\\\" ng-click=\\\"vm.moveUp(item)\\\"></button>\\r\\n                        <button icon=\\\"arrow-down\\\" type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-disabled=\\\"$last\\\" ng-click=\\\"vm.moveDown(item)\\\"></button>\\r\\n                    </td>\\r\\n                    <td stop-event=\\\"click\\\">\\r\\n                        <button icon=\\\"remove\\\" type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-click=\\\"vm.tryToDelete(item)\\\"></button>\\r\\n                    </td>\\r\\n                </tr>\\r\\n                <tr ng-if=\\\"!vm.items.length\\\">\\r\\n                    <td colspan=\\\"100\\\" translate=\\\"General.Messages.NothingFound\\\"></td>\\r\\n                </tr>\\r\\n            </tbody>\\r\\n        </table>\\r\\n\\r\\n    </div>\\r\\n\\r\\n\\r\\n</div>\");\n$templateCache.put(\"content-types/content-types.html\",\"<div ng-controller=\\\"List as vm\\\" ng-click=\\\"vm.debug.autoEnableAsNeeded($event)\\\">\\r\\n    <div class=\\\"modal-header\\\">\\r\\n        <h3 class=\\\"modal-title\\\" translate=\\\"ContentTypes.Title\\\"></h3>\\r\\n    </div>\\r\\n    <div class=\\\"modal-body\\\">\\r\\n        <!-- Buttons on top -->\\r\\n        <button title=\\\"{{ \\'General.Buttons.Add\\' | translate }}\\\" type=\\\"button\\\" class=\\\"btn btn-primary btn-square\\\" ng-click=\\\"vm.edit()\\\"><i icon=\\\"plus\\\"></i></button>\\r\\n\\r\\n\\r\\n        <span class=\\\"btn-group\\\" ng-if=\\\"vm.debug.on\\\">\\r\\n            <button title=\\\"{{ \\'General.Buttons.Refresh\\' | translate }}\\\" type=\\\"button\\\" class=\\\"btn btn-warning btn-square\\\" ng-click=\\\"vm.refresh()\\\"><i icon=\\\"repeat\\\"></i></button>\\r\\n            <button title=\\\"todo\\\" type=\\\"button\\\" class=\\\"btn btn-warning btn-icon\\\" ng-click=\\\"vm.createGhost()\\\"><i class=\\\"icon-ghost\\\"></i></button>\\r\\n            <button title=\\\"{{ \\'ContentTypes.Buttons.ChangeScope\\' | translate }}\\\" type=\\\"button\\\" class=\\\"btn btn-warning btn-square\\\" ng-click=\\\"vm.changeScope()\\\"><i icon=\\\"record\\\"></i></button>\\r\\n            <button title=\\\"{{ \\'General.Buttons.System\\' | translate }}\\\" type=\\\"button\\\" class=\\\"btn btn-warning btn-square\\\" ng-click=\\\"vm.liveEval()\\\"><i icon=\\\"flash\\\"></i></button>\\r\\n        </span>\\r\\n        <!-- Table of content types for editing -->\\r\\n        <table class=\\\"table table-hover\\\" style=\\\"table-layout: fixed; width: 100%\\\">\\r\\n            <thead>\\r\\n            <tr>\\r\\n                <!--<th translate=\\\"ContentTypes.TypesTable.Items\\\" class=\\\"col-id\\\"></th>-->\\r\\n                <th translate=\\\"ContentTypes.TypesTable.Name\\\" style=\\\"width: 50%\\\"></th>\\r\\n                <th class=\\\"mini-btn-1\\\"></th>\\r\\n                <th translate=\\\"ContentTypes.TypesTable.Description\\\" style=\\\"width: 50%\\\"></th>\\r\\n                <th translate=\\\"ContentTypes.TypesTable.Fields\\\" class=\\\"mini-btn-2\\\"></th>\\r\\n                <th translate=\\\"ContentTypes.TypesTable.Actions\\\" class=\\\"mini-btn-3\\\"></th>\\r\\n                <th class=\\\"mini-btn-1\\\"> </th>\\r\\n            </tr>\\r\\n            </thead>\\r\\n            <tbody>\\r\\n            <tr ng-if=\\\"vm.items.isLoaded\\\" ng-repeat=\\\"item in vm.items | orderBy:\\'Name\\'\\\" class=\\\"clickable-row\\\" ng-click=\\\"vm.editItems(item)\\\">\\r\\n                <!--<td style=\\\"text-align: center\\\" class=\\\"clickable\\\"> {{item.Items}} </td>-->\\r\\n                <td class=\\\"clickable\\\">\\r\\n                    <span class=\\\"text-nowrap hide-overflow-text\\\" style=\\\"max-width: 400px\\\" tooltip=\\\"{{item.Name}}\\\">{{item.Name}}</span>\\r\\n                </td>\\r\\n                <td class=\\\"clickable\\\" style=\\\"text-align: right\\\">\\r\\n                    <div class=\\\"badge pull-right badge-primary hover-pair\\\" stop-event=\\\"click\\\" ng-click=\\\"vm.addItem(item.StaticName)\\\"><span class=\\\"hover-default\\\">{{item.Items}}</span><span class=\\\"hover-hover icon-plus\\\"></span></div></td>\\r\\n                <td class=\\\"clickable\\\">\\r\\n                    <div class=\\\"text-nowrap hide-overflow-text\\\" style=\\\"max-width: 500px\\\" tooltip=\\\"{{item.Description}}\\\">{{item.Description}}</div>\\r\\n                </td>\\r\\n                <td stop-event=\\\"click\\\">\\r\\n                    <button ng-if=\\\"!item.UsesSharedDef\\\" type=\\\"button\\\" class=\\\"btn btn-xs\\\" style=\\\"width: 60px\\\" ng-click=\\\"vm.editFields(item)\\\">\\r\\n                        <i class=\\\"icon-fields\\\"></i>&nbsp;<span style=\\\"width: 22px; text-align: right\\\">{{item.Fields}}</span>\\r\\n                    </button>\\r\\n                    <button ng-if=\\\"item.UsesSharedDef\\\" tooltip=\\\"{{ \\'ContentTypes.Messages.SharedDefinition\\' | translate:item }}\\\" type=\\\"button\\\" class=\\\"btn btn-default btn-xs\\\" style=\\\"width: 60px\\\">\\r\\n                        <i class=\\\"icon-ghost\\\"></i>&nbsp;<span style=\\\"width: 22px; text-align: right\\\">{{item.Fields}}</span>\\r\\n                    </button>\\r\\n                </td>\\r\\n\\r\\n                <td class=\\\"text-nowrap\\\" stop-event=\\\"click\\\">\\r\\n                    <span class=\\\"btn-group\\\">\\r\\n                        <button tooltip=\\\"{{ \\'General.Buttons.Rename\\' | translate }} - {{  \\'ContentTypes.Messages.Type\\' + (item.UsesSharedDef ? \\'Shared\\' : \\'Own\\')  | translate:item }}\\\" type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-click=\\\"vm.edit(item)\\\">\\r\\n                            <i icon=\\\"heart{{ (item.UsesSharedDef ? \\'-empty\\' : \\'\\') }}\\\"></i>\\r\\n                        </button>\\r\\n                        <button tooltip=\\\"{{ \\'ContentTypes.Buttons.Export\\' | translate }}\\\" type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-click=\\\"vm.openExport(item)\\\"><i icon=\\\"export\\\"></i></button>\\r\\n                        <button tooltip=\\\"{{ \\'ContentTypes.Buttons.Import\\' | translate }}\\\" type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-click=\\\"vm.openImport(item)\\\"><i icon=\\\"import\\\"></i></button>\\r\\n                        <button type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-click=\\\"vm.permissions(item)\\\" ng-if=\\\"vm.isGuid(item.StaticName)\\\"><i icon=\\\"user\\\"></i></button>\\r\\n                    </span>\\r\\n                </td>\\r\\n                <td stop-event=\\\"click\\\">\\r\\n                    <button icon=\\\"remove\\\" type=\\\"button\\\" class=\\\"btn btn-xs\\\" ng-click=\\\"vm.tryToDelete(item)\\\"></button>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr ng-if=\\\"!vm.items.length\\\">\\r\\n                <td colspan=\\\"100\\\">{{ \\'General.Messages.Loading\\' | translate }} / {{ \\'General.Messages.NothingFound\\' | translate }}</td>\\r\\n            </tr>\\r\\n            </tbody>\\r\\n        </table>\\r\\n        <show-debug-availability class=\\\"pull-right\\\"></show-debug-availability>\\r\\n    </div>\\r\\n    <div ng-if=\\\"vm.debug.on\\\">\\r\\n\\r\\n        <h3>Notes / Debug / ToDo</h3>\\r\\n        <ol>\\r\\n            <li>get validators to work on all dialogs</li>\\r\\n        </ol>\\r\\n    </div>\\r\\n</div>\\r\\n\");\n$templateCache.put(\"pipelines/pipeline-designer.html\",\"<div class=\\\"ng-cloak\\\">\\r\\n    <div ng-controller=\\\"PipelineDesignerController as vm\\\" ng-click=\\\"vm.debug.autoEnableAsNeeded($event)\\\">\\r\\n        <div id=\\\"pipelineContainer\\\">\\r\\n            <div ng-repeat=\\\"dataSource in pipelineData.DataSources\\\"\\r\\n                 datasource\\r\\n                 guid=\\\"{{dataSource.EntityGuid}}\\\"\\r\\n                 id=\\\"dataSource_{{dataSource.EntityGuid}}\\\"\\r\\n                 class=\\\"dataSource\\\"\\r\\n                 ng-attr-style=\\\"top: {{dataSource.VisualDesignerData.Top}}px; left: {{dataSource.VisualDesignerData.Left}}px\\\">\\r\\n                <div class=\\\"configure\\\" ng-click=\\\"configureDataSource(dataSource)\\\" title=\\\"Configure this DataSource\\\" ng-if=\\\"!dataSource.ReadOnly\\\">\\r\\n                    <span class=\\\"glyphicon glyphicon-list-alt\\\"></span>\\r\\n                </div>\\r\\n                <div class=\\\"name\\\" title=\\\"Click to edit the Name\\\" ng-click=\\\"editName(dataSource)\\\">{{dataSource.Name || \\'(unnamed)\\'}}</div><br />\\r\\n                <div class=\\\"description\\\" title=\\\"Click to edit the Description\\\" ng-click=\\\"editDescription(dataSource)\\\">{{dataSource.Description || \\'(no description)\\'}}</div><br />\\r\\n                <div class=\\\"typename\\\" ng-attr-title=\\\"{{dataSource.PartAssemblyAndType}}\\\">Type: {{dataSource.PartAssemblyAndType | typename: \\'className\\'}}</div>\\r\\n                <div class=\\\"ep\\\" title=\\\"Drag a new Out-Connection from here\\\" ng-if=\\\"!dataSource.ReadOnly\\\">\\r\\n                    <span class=\\\"glyphicon glyphicon-plus-sign\\\"></span>\\r\\n                </div>\\r\\n                <div class=\\\"delete glyphicon glyphicon-remove\\\" title=\\\"Delete this DataSource\\\" ng-click=\\\"remove($index)\\\" ng-if=\\\"!dataSource.ReadOnly\\\"></div>\\r\\n            </div>\\r\\n        </div>\\r\\n        <div class=\\\"actions panel panel-default\\\">\\r\\n            <div class=\\\"panel-heading\\\">\\r\\n                <span class=\\\"pull-left\\\">Actions</span>\\r\\n                <a href=\\\"http://2sxc.org/help\\\" class=\\\"btn btn-info btn-xs pull-right\\\" target=\\\"_blank\\\"><span class=\\\"glyphicon glyphicon-question-sign\\\"></span> Help</a>\\r\\n            </div>\\r\\n            <div class=\\\"panel-body\\\">\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-primary btn-block\\\" title=\\\"Query the Data of this Pipeline\\\" ng-click=\\\"queryPipeline()\\\">\\r\\n                    <span class=\\\"glyphicon glyphicon-play\\\"></span> Query\\r\\n                </button>\\r\\n\\r\\n                <select class=\\\"form-control\\\" ng-model=\\\"addDataSourceType\\\" ng-disabled=\\\"readOnly\\\" ng-change=\\\"addDataSource()\\\" ng-options=\\\"d.ClassName for d in pipelineData.InstalledDataSources | filter: {allowNew: \\'!false\\'} | orderBy: \\'ClassName\\'\\\">\\r\\n                    <option value=\\\"\\\">-- Add DataSource --</option>\\r\\n                </select>\\r\\n                <!--<button type=\\\"button\\\" class=\\\"btn btn-default btn-sm\\\" title=\\\"Clone this Pipeline with all DataSources and Configurations\\\" ng-click=\\\"clonePipeline()\\\" ng-disabled=\\\"!PipelineEntityId\\\"><span class=\\\"glyphicon glyphicon-share-alt\\\"></span> Clone</button>-->\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-default btn-block\\\" ng-click=\\\"editPipelineEntity()\\\"><span class=\\\"glyphicon glyphicon-pencil\\\"></span> Test Parameters</button>\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-primary btn-block\\\" ng-disabled=\\\"readOnly\\\" ng-click=\\\"savePipeline()\\\">\\r\\n                    <span icon=\\\"ok\\\"></span> Save\\r\\n                </button>\\r\\n                <br/>\\r\\n                <br/>\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-info btn-xs\\\" ng-click=\\\"toggleEndpointOverlays()\\\"><span class=\\\"glyphicon glyphicon-info-sign\\\"></span> {{showEndpointOverlays ? \\'Hide\\' : \\'Show\\' }} Overlays</button>\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-info btn-xs\\\" ng-click=\\\"repaint()\\\"><span class=\\\"glyphicon glyphicon-repeat\\\"></span> Repaint</button>\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-info btn-xs\\\" ng-if=\\\"vm.debug.on\\\" ng-click=\\\"toogleDebug()\\\"><span class=\\\"glyphicon glyphicon-info-sign\\\"></span> {{debug ? \\'Hide\\' : \\'Show\\'}} Debug Info</button>\\r\\n\\r\\n                <show-debug-availability class=\\\"pull-right\\\"></show-debug-availability>\\r\\n            </div>\\r\\n        </div>\\r\\n        <toaster-container></toaster-container>\\r\\n        <pre ng-if=\\\"debug\\\">{{pipelineData | json}}</pre>\\r\\n    </div>\\r\\n</div>\\r\\n\");\n$templateCache.put(\"pipelines/pipelines.html\",\"<div ng-click=\\\"vm.debug.autoEnableAsNeeded($event)\\\">\\r\\n    <div class=\\\"modal-header\\\">\\r\\n        <h3 class=\\\"modal-title\\\" translate=\\\"Pipeline.Manage.Title\\\"></h3>\\r\\n    </div>\\r\\n    <div class=\\\"modal-body ng-cloak\\\">\\r\\n        <div translate=\\\"Pipeline.Manage.Intro\\\"></div>\\r\\n        <div>\\r\\n            <button icon=\\\"plus\\\" type=\\\"button\\\" class=\\\"btn btn-primary btn-square\\\" ng-click=\\\"vm.add()\\\"></button>\\r\\n            <span class=\\\"btn-group\\\" ng-if=\\\"vm.debug.on\\\">\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-warning btn-square\\\" ng-click=\\\"vm.refresh()\\\"><i icon=\\\"repeat\\\"></i></button>\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-warning btn-square\\\" ng-click=\\\"vm.liveEval()\\\"><i icon=\\\"flash\\\"></i></button>\\r\\n            </span>\\r\\n            <table class=\\\"table table-hover table-manage-eav\\\">\\r\\n                <thead>\\r\\n                <tr>\\r\\n                    <th translate=\\\"Pipeline.Manage.Table.Id\\\" class=\\\"col-id\\\"></th>\\r\\n                    <th translate=\\\"Pipeline.Manage.Table.Name\\\"></th>\\r\\n                    <th translate=\\\"Pipeline.Manage.Table.Description\\\"></th>\\r\\n                    <th translate=\\\"Pipeline.Manage.Table.Actions\\\" class=\\\"mini-btn-4\\\"></th>\\r\\n                </tr>\\r\\n                </thead>\\r\\n                <tbody>\\r\\n                <tr ng-repeat=\\\"pipeline in vm.pipelines | orderBy:\\'Name\\'\\\" class=\\\"clickable-row\\\" ng-click=\\\"vm.design(pipeline)\\\">\\r\\n                    <td class=\\\"clickable\\\">{{pipeline.Id}}</td>\\r\\n                    <td class=\\\"clickable\\\">{{pipeline.Name}}</td>\\r\\n                    <td class=\\\"clickable\\\">{{pipeline.Description}}</td>\\r\\n                    <td class=\\\"text-nowrap mini-btn-4\\\" stop-event=\\'click\\'>\\r\\n                        <span class=\\\"btn-group\\\">\\r\\n                            <button title=\\\"{{ \\'General.Buttons.Edit\\' | translate }}\\\" class=\\\"btn btn-xs\\\" ng-click=\\\"vm.edit(pipeline)\\\"><i icon=\\\"cog\\\"></i></button>\\r\\n                            <button title=\\\"{{ \\'General.Buttons.Copy\\' | translate }}\\\" type=\\\"button\\\" class=\\\"btn btn-xs\\\" ng-click=\\\"vm.clone(pipeline)\\\"><i icon=\\\"duplicate\\\"></i></button>\\r\\n                            <button title=\\\"{{ \\'General.Buttons.Permissions\\' | translate }}\\\" type=\\\"button\\\" class=\\\"btn btn-xs\\\" ng-click=\\\"vm.permissions(pipeline)\\\"><i icon=\\\"user\\\"></i></button>\\r\\n                        </span>\\r\\n                        <button title=\\\"{{ \\'General.Buttons.Delete\\' | translate }}\\\" type=\\\"button\\\" class=\\\"btn btn-xs\\\" ng-click=\\\"vm.delete(pipeline)\\\"><i icon=\\\"remove\\\"></i></button>\\r\\n                    </td>\\r\\n                </tr>\\r\\n                <tr ng-if=\\\"!vm.pipelines.length\\\">\\r\\n                    <td colspan=\\\"100\\\" translate=\\\"General.Messages.NothingFound\\\"></td>\\r\\n                </tr>\\r\\n                </tbody>\\r\\n            </table>\\r\\n        </div>\\r\\n\\r\\n        <show-debug-availability class=\\\"pull-right\\\"></show-debug-availability>\\r\\n    </div>\\r\\n\\r\\n</div>\");\n$templateCache.put(\"pipelines/query-stats.html\",\"<div class=\\\"modal-header\\\">\\r\\n    <button icon=\\\"remove\\\" class=\\\"btn pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.close()\\\"></button>\\r\\n    <h3 class=\\\"modal-title\\\" translate=\\\"Pipeline.Stats.Title\\\"></h3>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"modal-body\\\">\\r\\n    <div translate=\\\"Pipeline.Stats.Intro\\\"></div>\\r\\n\\r\\n    <div>\\r\\n        <h3 translate=\\\"Pipeline.Stats.ParamTitle\\\"></h3>\\r\\n        <div translate=\\\"Pipeline.Stats.ExecutedIn\\\" translate-values=\\\"{ ms: vm.timeUsed, ticks: vm.ticksUsed }\\\"></div>\\r\\n        <div>\\r\\n            <ul>\\r\\n                <li ng-repeat=\\\"param in vm.testParameters\\\">{{param}}</li>\\r\\n            </ul>\\r\\n        </div>\\r\\n    </div>\\r\\n\\r\\n    <div>\\r\\n        <h3 translate=\\\"Pipeline.Stats.QueryTitle\\\"></h3>\\r\\n        <pre>{{vm.result | json}}</pre>\\r\\n    </div>\\r\\n    <div>\\r\\n        <h3 translate=\\\"Pipeline.Stats.SourcesAndStreamsTitle\\\"></h3>\\r\\n        <h4 translate=\\\"Pipeline.Stats.Sources.Title\\\"></h4>\\r\\n        <table>\\r\\n            <tr>\\r\\n                <th translate=\\\"Pipeline.Stats.Sources.Guid\\\"></th>\\r\\n                <th translate=\\\"Pipeline.Stats.Sources.Type\\\"></th>\\r\\n                <th translate=\\\"Pipeline.Stats.Sources.Config\\\"></th>\\r\\n            </tr>\\r\\n            <tr ng-repeat=\\\"s in vm.sources\\\">\\r\\n                <td tooltip=\\\"{{s}}\\\"><pre>{{s.Guid.substring(0, 13)}}...</pre></td>\\r\\n                <td>{{s.Type}}</td>\\r\\n                <td tooltip=\\\"{{s.Configuration}}\\\">\\r\\n                    <ol>\\r\\n                        <li ng-repeat=\\\"(key, value) in s.Configuration\\\"><b>{{key}}</b>=<em>{{value}}</em></li>\\r\\n                    </ol>\\r\\n                </td>\\r\\n            </tr>\\r\\n        </table>\\r\\n\\r\\n        <h4 translate=\\\"Pipeline.Stats.Streams.Title\\\"></h4>\\r\\n        <table>\\r\\n            <tr>\\r\\n                <th translate=\\\"Pipeline.Stats.Streams.Source\\\"></th>\\r\\n                <th translate=\\\"Pipeline.Stats.Streams.Target\\\"></th>\\r\\n                <th translate=\\\"Pipeline.Stats.Streams.Items\\\"></th>\\r\\n                <th translate=\\\"Pipeline.Stats.Streams.Error\\\"></th>\\r\\n            </tr>\\r\\n            <tr ng-repeat=\\\"sr in vm.streams\\\">\\r\\n                <td><pre>{{sr.Source.substring(0, 13) + \\\":\\\" + sr.SourceOut}}</pre></td>\\r\\n                <td><pre>{{sr.Target.substring(0, 13) + \\\":\\\" + sr.TargetIn}}</pre></td>\\r\\n                <td><span>{{sr.Count}}</span></td>\\r\\n                <td><span>{{sr.Error}}</span></td>\\r\\n            </tr>\\r\\n        </table>\\r\\n\\r\\n    </div>\\r\\n</div>\");}]);","(function () {\r\n    angular.module(\"ContentExportApp\", [\r\n        \"EavAdminUi\",\r\n        \"EavDirectives\",\r\n        \"EavConfiguration\",\r\n        \"EavServices\",\r\n        \"ContentHelperFilters\",\r\n        \"ContentFormlyTypes\"\r\n    ]);\r\n}());\n(function () {\r\n\r\n    contentExportController.$inject = [\"appId\", \"contentType\", \"contentExportService\", \"eavAdminDialogs\", \"eavConfig\", \"languages\", \"$modalInstance\", \"$filter\", \"$translate\"];\r\n    angular.module(\"ContentExportApp\")\r\n        .controller(\"ContentExport\", contentExportController);\r\n\r\n    function contentExportController(appId, contentType, contentExportService, eavAdminDialogs, eavConfig, languages, $modalInstance, $filter, $translate) {\r\n\r\n        var vm = this;\r\n\r\n        vm.formValues = {};\r\n\r\n        vm.formFields = [{\r\n            // Content type\r\n            key: \"AppId\",\r\n            type: \"hidden\",\r\n            defaultValue: appId\r\n        }, {\r\n            // Default / fallback language\r\n            key: \"DefaultLanguage\",\r\n            type: \"hidden\",\r\n            defaultValue: $filter(\"isoLangCode\")(languages.defaultLanguage)\r\n        }, {\r\n            // Content type\r\n            key: \"ContentType\",\r\n            type: \"hidden\",\r\n            defaultValue: contentType\r\n        }, {\r\n            key: \"Language\",\r\n            type: \"select\",\r\n            expressionProperties: {\r\n                \"templateOptions.label\": \"'Content.Export.Fields.Language.Label' | translate\",\r\n                \"templateOptions.options\": function () {\r\n                    var options = [{\r\n                        \"name\": $translate.instant(\"Content.Export.Fields.Language.Options.All\"),\r\n                        \"value\": \"\"\r\n                    }];\r\n                    angular.forEach(languages.languages, function (lang) {\r\n                        var langCode = $filter(\"isoLangCode\")(lang.key);\r\n                        options.push({ \"name\": langCode, \"value\": langCode });\r\n                    });\r\n                    return options;\r\n                }\r\n            },\r\n            defaultValue: \"\"\r\n        }, {\r\n            key: \"RecordExport\",\r\n            type: \"radio\",\r\n            expressionProperties: {\r\n                \"templateOptions.label\": \"'Content.Export.Fields.RecordExport.Label' | translate\",\r\n                \"templateOptions.options\": function () {\r\n                    return [{\r\n                        \"name\": $translate.instant(\"Content.Export.Fields.RecordExport.Options.Blank\"),\r\n                        \"value\": \"Blank\"\r\n                    }, {\r\n                        \"name\": $translate.instant(\"Content.Export.Fields.RecordExport.Options.All\"),\r\n                        \"value\": \"All\"\r\n                    }];\r\n                }\r\n            },\r\n            defaultValue: \"All\"\r\n        }, {\r\n            // Language references\r\n            key: \"LanguageReferences\",\r\n            type: \"radio\",\r\n            expressionProperties: {\r\n                \"templateOptions.label\": \"'Content.Export.Fields.LanguageReferences.Label' | translate\",\r\n                \"templateOptions.disabled\": function () {\r\n                    return vm.formValues.RecordExport == \"Blank\";\r\n                },\r\n                \"templateOptions.options\": function () {\r\n                    return [{\r\n                        \"name\": $translate.instant(\"Content.Export.Fields.LanguageReferences.Options.Link\"),\r\n                        \"value\": \"Link\"\r\n                    }, {\r\n                        \"name\": $translate.instant(\"Content.Export.Fields.LanguageReferences.Options.Resolve\"),\r\n                        \"value\": \"Resolve\"\r\n                    }];\r\n                }\r\n            },\r\n            defaultValue: \"Link\"\r\n        }, {\r\n            // File / page references\r\n            key: \"ResourcesReferences\",\r\n            type: \"radio\",\r\n            expressionProperties: {\r\n                \"templateOptions.label\": \"'Content.Export.Fields.ResourcesReferences.Label' | translate\",\r\n                \"templateOptions.disabled\": function () {\r\n                    return vm.formValues.RecordExport == \"Blank\";\r\n                },\r\n                \"templateOptions.options\": function () {\r\n                    return [{\r\n                        \"name\": $translate.instant(\"Content.Export.Fields.ResourcesReferences.Options.Link\"),\r\n                        \"value\": \"Link\"\r\n                    }, {\r\n                        \"name\": $translate.instant(\"Content.Export.Fields.ResourcesReferences.Options.Resolve\"),\r\n                        \"value\": \"Resolve\"\r\n                    }];\r\n                }\r\n            },\r\n            defaultValue: \"Link\"\r\n        }];\r\n\r\n\r\n        vm.exportContent = function exportContent() {\r\n            contentExportService.exportContent(vm.formValues);\r\n        };\r\n\r\n        vm.close = function close() {\r\n            $modalInstance.dismiss(\"cancel\");\r\n        };\r\n    }\r\n}());\n(function () {\r\n\r\n    contentExportService.$inject = [\"$http\", \"eavConfig\"];\r\n    angular.module(\"ContentExportApp\")\r\n         .factory(\"contentExportService\", contentExportService);\r\n\r\n\r\n    function contentExportService($http, eavConfig) {\r\n        var srvc = {\r\n            exportContent: exportContent,\r\n        };\r\n        return srvc;\r\n\r\n        function exportContent(args) {\r\n            var url = eavConfig.getUrlPrefix(\"api\") + \"/eav/ContentExport/ExportContent\";\r\n            window.open(url + \"?appId=\" + args.AppId + \"&language=\" + args.Language + \"&defaultLanguage=\" + args.DefaultLanguage + \"&contentType=\" + args.ContentType + \"&recordExport=\" + args.RecordExport + \"&resourcesReferences=\" + args.ResourcesReferences + \"&languageReferences=\" + args.LanguageReferences, \"_self\", \"\");\r\n        }\r\n    }\r\n}());\n(function () {\r\n    angular.module(\"ContentFormlyTypes\", [\r\n        \"naif.base64\",\r\n        \"formly\",\r\n        \"formlyBootstrap\",\r\n        \"ui.bootstrap\"\r\n    ]);\r\n}());\n(function () {\r\n\r\n    angular.module(\"ContentFormlyTypes\")\r\n\r\n        .config([\"formlyConfigProvider\", function (formlyConfigProvider) {\r\n            var formly = formlyConfigProvider;\r\n\r\n            formly.setType({\r\n                name: \"file\",\r\n                template: \"<span class='btn btn-default btn-square btn-file'><span class='glyphicon glyphicon-open'></span><input type='file' ng-model='model[options.key]' base-sixty-four-input /></span> <span ng-if='model[options.key]'>{{model[options.key].filename}}</span>\",\r\n                wrapper: [\"bootstrapLabel\", \"bootstrapHasError\"]\r\n            });\r\n\r\n            formly.setType({\r\n                name: \"hidden\",\r\n                template: \"<input style='display:none' ng-model='model[options.key]' />\",\r\n                wrapper: [\"bootstrapLabel\", \"bootstrapHasError\"]\r\n            });\r\n    }]);\r\n}());\n(function () {\r\n    angular.module(\"ContentHelperFilters\", []);\r\n\r\n\r\n    angular.module(\"ContentHelperFilters\").filter(\"isoLangCode\", function () {\r\n        return function (str) {\r\n            if (str.length != 5)\r\n                return str;\r\n            return str.substring(0, 2).toLowerCase() + \"-\" + str.substring(3, 5).toUpperCase();\r\n        };\r\n    });\r\n}());\n(function () {\r\n    angular.module(\"ContentImportApp\", [\r\n        \"EavAdminUi\",\r\n        \"EavDirectives\",\r\n        \"EavConfiguration\",\r\n        \"EavServices\",\r\n        \"ContentHelperFilters\",\r\n        \"ContentFormlyTypes\"\r\n    ]);\r\n}());\n(function () {\r\n\r\n    contentImportController.$inject = [\"appId\", \"contentType\", \"contentImportService\", \"eavAdminDialogs\", \"eavConfig\", \"languages\", \"debugState\", \"$modalInstance\", \"$filter\", \"$translate\"];\r\n    angular.module(\"ContentImportApp\")\r\n        .controller(\"ContentImport\", contentImportController);\r\n\r\n    function contentImportController(appId, contentType, contentImportService, eavAdminDialogs, eavConfig, languages, debugState, $modalInstance, $filter, $translate) {\r\n\r\n        var vm = this;\r\n        vm.debug = debugState;\r\n\r\n        vm.formValues = {};\r\n\r\n        vm.formFields = [{\r\n            // Content type\r\n            key: \"AppId\",\r\n            type: \"hidden\",\r\n            defaultValue: appId\r\n        }, {\r\n            // Default / fallback language\r\n            key: \"DefaultLanguage\",\r\n            type: \"hidden\",\r\n            defaultValue: $filter(\"isoLangCode\")(languages.defaultLanguage)\r\n        }, {\r\n            // Content type\r\n            key: \"ContentType\",\r\n            type: \"hidden\",\r\n            defaultValue: contentType\r\n        }, {\r\n            // File\r\n            key: \"File\",\r\n            type: \"file\",\r\n            templateOptions: {\r\n                required: true\r\n            },\r\n            expressionProperties: {\r\n                \"templateOptions.label\": \"'Content.Import.Fields.File.Label' | translate\"\r\n            }\r\n        }, {\r\n            // File / page references\r\n            key: \"ResourcesReferences\",\r\n            type: \"radio\",\r\n            expressionProperties: {\r\n                \"templateOptions.label\": \"'Content.Import.Fields.ResourcesReferences.Label' | translate\",\r\n                \"templateOptions.options\": function () {\r\n                    return [{\r\n                        \"name\": $translate.instant(\"Content.Import.Fields.ResourcesReferences.Options.Keep\"),\r\n                        \"value\": \"Keep\"\r\n                    }, {\r\n                        \"name\": $translate.instant(\"Content.Import.Fields.ResourcesReferences.Options.Resolve\"),\r\n                        \"value\": \"Resolve\"\r\n                    }];\r\n                }\r\n            },\r\n            defaultValue: \"Keep\"\r\n        }, {\r\n            // Clear entities\r\n            key: \"ClearEntities\",\r\n            type: \"radio\",\r\n            expressionProperties: {\r\n                \"templateOptions.label\": \"'Content.Import.Fields.ClearEntities.Label' | translate\",\r\n                \"templateOptions.options\": function () {\r\n                    return [{\r\n                        \"name\": $translate.instant(\"Content.Import.Fields.ClearEntities.Options.None\"),\r\n                        \"value\": \"None\"\r\n                    }, {\r\n                        \"name\": $translate.instant(\"Content.Import.Fields.ClearEntities.Options.All\"),\r\n                        \"value\": \"All\"\r\n                    }];\r\n                }\r\n            },\r\n            defaultValue: \"None\"\r\n        }];\r\n\r\n        vm.viewStates = {\r\n            \"Waiting\":   0,\r\n            \"Default\":   1,\r\n            \"Evaluated\": 2,\r\n            \"Imported\":  3\r\n        };\r\n\r\n        vm.viewStateSelected = vm.viewStates.Default;\r\n\r\n\r\n        vm.evaluationResult = { };\r\n\r\n        vm.importResult = { };\r\n\r\n\r\n        vm.evaluateContent = function evaluateContent() {\r\n            vm.viewStateSelected = vm.viewStates.Waiting;\r\n            return contentImportService.evaluateContent(vm.formValues).then(function (result) {\r\n                vm.evaluationResult = result.data;\r\n                vm.viewStateSelected = vm.viewStates.Evaluated;\r\n            });\r\n        };\r\n\r\n        vm.importContent = function importContent() {\r\n            vm.viewStateSelected = vm.viewStates.Waiting;\r\n            return contentImportService.importContent(vm.formValues).then(function (result) {\r\n                vm.importResult = result.data;\r\n                vm.viewStateSelected = vm.viewStates.Imported;\r\n            });\r\n        };\r\n\r\n        vm.reset = function reset() {\r\n            vm.formValues = { };\r\n            vm.evaluationResult = { };\r\n            vm.importResult = { };\r\n        };\r\n\r\n        vm.back = function back() {\r\n            vm.viewStateSelected = vm.viewStates.Default;\r\n        };\r\n\r\n        vm.close = function close() {\r\n            vm.viewStateSelected = vm.viewStates.Default;\r\n            $modalInstance.dismiss(\"cancel\");\r\n        };\r\n    }\r\n}());\n(function () {\r\n\r\n    contentImportService.$inject = [\"$http\"];\r\n    angular.module(\"ContentImportApp\")\r\n         .factory(\"contentImportService\", contentImportService);\r\n\r\n\r\n    function contentImportService($http) {\r\n        var srvc = {\r\n            evaluateContent: evaluateContent,\r\n            importContent: importContent\r\n        };\r\n        return srvc;\r\n\r\n        function evaluateContent(args) {\r\n            return $http.post(\"eav/ContentImport/EvaluateContent\", { AppId: args.AppId, DefaultLanguage: args.DefaultLanguage, ContentType: args.ContentType, ContentBase64: args.File.base64, ResourcesReferences: args.ResourcesReferences, ClearEntities: args.ClearEntities });\r\n        }\r\n\r\n        function importContent(args) {\r\n            return $http.post(\"eav/ContentImport/ImportContent\", { AppId: args.AppId, DefaultLanguage: args.DefaultLanguage, ContentType: args.ContentType, ContentBase64: args.File.base64, ResourcesReferences: args.ResourcesReferences, ClearEntities: args.ClearEntities });\r\n        }\r\n    }\r\n}());\n(function () { \r\n\r\n    EditContentItemController.$inject = [\"mode\", \"entityId\", \"contentType\", \"eavAdminDialogs\", \"$modalInstance\"];\r\n    angular.module(\"ContentEditApp\", [\r\n        \"EavServices\",\r\n        \"EavAdminUi\"\r\n    ])\r\n        .controller(\"EditContentItem\", EditContentItemController)\r\n        ;\r\n\r\n    function EditContentItemController(mode, entityId, contentType, eavAdminDialogs, $modalInstance) { //}, contentTypeId, eavAdminDialogs) {\r\n        var vm = this;\r\n        vm.mode = mode;\r\n        vm.entityId = entityId;\r\n        vm.contentType = contentType;\r\n        vm.TestMessage = \"Test message the controller is binding correctly...\";\r\n\r\n        vm.history = function history() {\r\n            return eavAdminDialogs.openItemHistory(vm.entityId);\r\n        };\r\n\r\n        vm.close = function () { $modalInstance.dismiss(\"cancel\"); };\r\n    }\r\n\r\n} ());\n(function () {\r\n\t'use strict';\r\n\r\n\tcontentItemsListController.$inject = [\"contentItemsSvc\", \"eavConfig\", \"appId\", \"contentType\", \"eavAdminDialogs\", \"debugState\", \"$modalInstance\", \"$q\", \"$modalStack\"];\r\n\tangular.module(\"ContentItemsAppAgnostic\", [\r\n        \"EavConfiguration\",\r\n        \"EavAdminUi\",\r\n        \"EavServices\",\r\n\t\t// \"agGrid\" // needs this, but can't hardwire the dependency as it would cause problems with lazy-loading\r\n\t])\r\n        .controller(\"ContentItemsList\", contentItemsListController)\r\n\t;\r\n\r\n\tfunction contentItemsListController(contentItemsSvc, eavConfig, appId, contentType, eavAdminDialogs, debugState, $modalInstance, $q, $modalStack) {\r\n\t\t/* jshint validthis:true */\r\n\t\tvar vm = angular.extend(this, {\r\n\t\t\tdebug: debugState,\r\n\t\t\tgridOptions: {\r\n\t\t\t\tenableSorting: true,\r\n\t\t\t\tenableFilter: true,\r\n\t\t\t\trowHeight: 39,\r\n\t\t\t\tcolWidth: 155,\r\n\t\t\t\theaderHeight: 38,\r\n\t\t\t\tangularCompileRows: true\r\n\t\t\t},\r\n\t\t\tadd: add,\r\n\t\t\trefresh: setRowData,\r\n\t\t\ttryToDelete: tryToDelete,\r\n\t\t\topenDuplicate: openDuplicate,\r\n\t\t\tclose: close\r\n\t\t});\r\n\t\tvar svc;\r\n\r\n\t\tvar staticColumns = [\r\n\t\t\t{\r\n\t\t\t\theaderName: \"ID\",\r\n\t\t\t\tfield: \"Id\",\r\n\t\t\t\twidth: 50,\r\n\t\t\t\ttemplate: '<span tooltip-append-to-body=\"true\" tooltip=\"Id: {{data.Id}}\\nRepoId: {{data.RepositoryId}}\\nGuid: {{data.Guid}}\" ng-bind=\"data.Id\"></span>',\r\n\t\t\t\tcellClass: \"clickable\",\r\n\t\t\t\tfilter: 'number',\r\n\t\t\t\tonCellClicked: openEditDialog\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\theaderName: \"Status\",\r\n\t\t\t\tfield: \"IsPublished\",\r\n\t\t\t\twidth: 75,\r\n\t\t\t\tsuppressSorting: true,\r\n\t\t\t\ttemplate: '<span class=\"glyphicon\" ng-class=\"{\\'glyphicon-eye-open\\': data.IsPublished, \\'glyphicon-eye-close\\' : !data.IsPublished}\" tooltip-append-to-body=\"true\" tooltip=\"{{ \\'Content.Publish.\\' + (data.IsPublished ? \\'PnV\\': data.Published ? \\'DoP\\' : \\'D\\') | translate }}\"></span> <span icon=\"{{ data.Draft ? \\'link\\' : data.Published ? \\'link\\' : \\'\\' }}\" tooltip-append-to-body=\"true\" tooltip=\"{{ (data.Draft ? \\'Content.Publish.HD\\' :\\'\\') | translate:\\'{ id: data.Draft.RepositoryId}\\' }}\\n{{ (data.Published ? \\'Content.Publish.HP\\' :\\'\\') | translate }} #{{ data.Published.RepositoryId }}\"></span> <span ng-if=\"data.Metadata\" tooltip-append-to-body=\"true\" tooltip=\"Metadata for type {{ data.Metadata.TargetType}}, id {{ data.Metadata.KeyNumber }}{{ data.Metadata.KeyString }}{{ data.Metadata.KeyGuid }}\" icon=\"tag\"></span>',\r\n\t\t\t\tvalueGetter: valueGetterStatusField\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\theaderName: \"Title\",\r\n\t\t\t\tfield: \"Title\",\r\n\t\t\t\twidth: 216,\r\n\t\t\t\tcellClass: \"clickable\",\r\n\t\t\t\ttemplate: '<span tooltip-append-to-body=\"true\" tooltip=\"{{data.Title}}\" ng-bind=\"data.Title + \\' \\' + ((!data.Title ? \\'Content.Manage.NoTitle\\':\\'\\') | translate)\"></span>',\r\n\t\t\t\tfilter: 'text',\r\n\t\t\t\tonCellClicked: openEditDialog\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\theaderName: \"\",\r\n\t\t\t\twidth: 70,\r\n\t\t\t\tsuppressSorting: true,\r\n\t\t\t\tsuppressMenu: true,\r\n\t\t\t\ttemplate: '<button type=\"button\" class=\"btn btn-xs btn-square\" ng-click=\"vm.openDuplicate(data)\" tooltip-append-to-body=\"true\" tooltip=\"{{ \\'General.Buttons.Copy\\' | translate }}\"><i icon=\"duplicate\"></i></button> <button type=\"button\" class=\"btn btn-xs btn-square\" ng-click=\"vm.tryToDelete(data)\" tooltip-append-to-body=\"true\" tooltip=\"{{ \\'General.Buttons.Delete\\' | translate }}\"><i icon=\"remove\"></i> </button>'\r\n\t\t\t}\r\n\t\t];\r\n\r\n\t\tactivate();\r\n\r\n\t\tfunction activate() {\r\n\t\t\tsvc = contentItemsSvc(appId, contentType);\r\n\r\n\t\t\t// set RowData an Column Definitions\r\n\t\t\t$q.all([setRowData(), svc.getColumns()])\r\n\t\t\t\t.then(function (success) {\r\n\t\t\t\t\tvar columnDefs = getColumnDefs(success[1].data);\r\n\t\t\t\t\tvm.gridOptions.api.setColumnDefs(columnDefs);\r\n\r\n\t\t\t\t\t// resize outer modal (if needed)\r\n\t\t\t\t\tvar bodyWidth = vm.gridOptions.api.gridPanel.eBodyContainer.clientWidth;\r\n\t\t\t\t\tvar viewportWidth = vm.gridOptions.api.gridPanel.eBodyViewport.clientWidth;\r\n\t\t\t\t\tif (bodyWidth < viewportWidth)\r\n\t\t\t\t\t\tsetModalWidth(bodyWidth);\r\n\t\t\t\t});\r\n\t\t}\r\n\r\n\t\t// set width of outer angular-ui-modal. This is a quick and dirty solution because there's no official way to do this.\r\n\t\t// $modalStack.getTop() might get a wrong modal Instance\r\n\t\t// setting the width with inline css in a controller should be avoided\r\n\t\tfunction setModalWidth(width) {\r\n\t\t\tvar modalDomEl = $modalStack.getTop().value.modalDomEl;\r\n\t\t\tvar modalDialog = modalDomEl.children();\r\n\t\t\tmodalDialog.css(\"width\", (width + 47) + \"px\");\t// add some pixels for padding and scrollbars\r\n\t\t}\r\n\r\n\t\tfunction add() {\r\n\t\t\teavAdminDialogs.openItemNew(contentType, setRowData);\r\n\t\t}\r\n\r\n\t\tfunction openEditDialog(params) {\r\n\t\t\teavAdminDialogs.openItemEditWithEntityId(params.data.Id, setRowData);\r\n\t\t}\r\n\r\n\t\t// Get/Update Grid Row-Data\r\n\t\tfunction setRowData() {\r\n\t\t\tvar sortModel = {};\r\n\t\t\tvar filterModel = {};\r\n\t\t\tif (vm.gridOptions.api) {\r\n\t\t\t\tsortModel = vm.gridOptions.api.getSortModel();\r\n\t\t\t\tfilterModel = vm.gridOptions.api.getFilterModel();\r\n\t\t\t}\r\n\r\n\t\t\treturn svc.liveListSourceRead().then(function (success) {\r\n\t\t\t\tvm.gridOptions.api.setRowData(success.data);\r\n\t\t\t\tvm.gridOptions.api.setSortModel(sortModel);\r\n\t\t\t\tvm.gridOptions.api.setFilterModel(filterModel);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// get Grid Column-Definitions from an Array of EAV-Attributes\r\n\t\tfunction getColumnDefs(eavAttributes) {\r\n\t\t\tvar columnDefs = staticColumns;\r\n\r\n\t\t\tangular.forEach(eavAttributes, function (eavAttribute) {\r\n\t\t\t\tif (eavAttribute.IsTitle) {\r\n\t\t\t\t\tstaticColumns[2].eavAttribute = eavAttribute;\r\n\t\t\t\t\treturn;\t// don't add Title-Field twice\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar colDef = {\r\n\t\t\t\t\teavAttribute: eavAttribute,\r\n\t\t\t\t\theaderName: eavAttribute.StaticName,\r\n\t\t\t\t\tfield: eavAttribute.StaticName,\r\n\t\t\t\t\tcellRenderer: cellRendererDefault,\r\n\t\t\t\t\tfilterParams: { cellRenderer: cellRendererDefaultFilter }\r\n\t\t\t\t};\r\n\r\n\r\n\t\t\t\tswitch (eavAttribute.Type) {\r\n\t\t\t\t\tcase \"Entity\":\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tcolDef.allowMultiValue = eavAttribute.Metadata.Entity.AllowMultiValue;\r\n\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\tcolDef.allowMultiValue = true;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tcolDef.cellRenderer = cellRendererEntity;\r\n\t\t\t\t\t\tcolDef.valueGetter = valueGetterEntityField;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"DateTime\":\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tcolDef.useTimePicker = eavAttribute.Metadata.DateTime.UseTimePicker;\r\n\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\tcolDef.useTimePicker = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcolDef.valueGetter = valueGetterDateTime;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Boolean\":\r\n\t\t\t\t\t\tcolDef.valueGetter = valueGetterBoolean;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Number\":\r\n\t\t\t\t\t\tcolDef.filter = 'number';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcolumnDefs.push(colDef);\r\n\t\t\t});\r\n\r\n\t\t\treturn columnDefs;\r\n\t\t}\r\n\r\n\t\t//#region Column Value-Getter and Cell Renderer\r\n\t\tfunction valueGetterEntityField(params) {\r\n\t\t\tvar rawValue = params.data[params.colDef.field];\r\n\t\t\tif (rawValue.length === 0)\r\n\t\t\t\treturn null;\r\n\r\n\t\t\treturn rawValue.map(function (item) {\r\n\t\t\t\treturn item.Title;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfunction valueGetterStatusField(params) {\r\n\t\t\treturn [\r\n\t\t\t\tparams.data.IsPublished ? \"is published\" : \"is not published\",\r\n\t\t\t\tparams.data.Metadata ? \"is metadata\" : \"is not metadata\"\r\n\t\t\t];\r\n\t\t}\r\n\r\n\t\tfunction valueGetterDateTime(params) {\r\n\t\t\tvar rawValue = params.data[params.colDef.field];\r\n\t\t\tif (!rawValue)\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t// remove 'Z' and replace 'T'\r\n\t\t\treturn params.colDef.useTimePicker ? rawValue.substr(0, 19).replace('T', ' ') : rawValue.substr(0, 10);\r\n\t\t}\r\n\r\n\t\tfunction valueGetterBoolean(params) {\r\n\t\t\tvar rawValue = params.data[params.colDef.field];\r\n\t\t\tif (typeof rawValue != \"boolean\")\r\n\t\t\t\treturn null;\r\n\r\n\t\t\treturn rawValue.toString();\r\n\t\t}\r\n\r\n\t\tfunction cellRendererDefault(params) {\r\n\t\t\tif (typeof (params.value) != \"string\" || params.value === null)\r\n\t\t\t\treturn params.value;\r\n\r\n\t\t\tvar encodedValue = htmlEncode(params.value);\r\n\t\t\treturn '<span title=\"' + encodedValue + '\">' + encodedValue + '</span>';\r\n\t\t}\r\n\r\n\t\tfunction cellRendererDefaultFilter(params) {\r\n\t\t\treturn cellRendererDefault(params) || \"(empty)\";\r\n\t\t}\r\n\r\n\t\t// htmlencode strings (source: http://stackoverflow.com/a/7124052)\r\n\t\tfunction htmlEncode(text) {\r\n\t\t\treturn text.replace(/&/g, '&amp;').replace(/\"/g, '&quot;').replace(/'/g, '&#39;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n\t\t}\r\n\r\n\t\tfunction cellRendererEntity(params) {\r\n\t\t\tif (!Array.isArray(params.value))\r\n\t\t\t\treturn null;\r\n\r\n\t\t\tvar encodedValue = htmlEncode(params.value.join(\", \"));\r\n\t\t\tvar result = '<span title=\"' + encodedValue + '\">';\r\n\t\t\tif (params.colDef.allowMultiValue)\r\n\t\t\t\tresult += '<span class=\"badge badge-primary\">' + params.value.length + '</span> ';\r\n\t\t\tresult += encodedValue + '</span>';\r\n\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\t// #endregion\r\n\r\n\t\tfunction tryToDelete(item) {\r\n\t\t\tif (confirm(\"Delete '\" + item.Title + \"' (\" + item.RepositoryId + \") ?\"))\r\n\t\t\t\tsvc.delete(item.RepositoryId).then(setRowData);\r\n\t\t}\r\n\r\n\t\tfunction openDuplicate(item) {\r\n\t\t\tvar items = [\r\n\t\t        {\r\n\t\t        \tContentTypeName: contentType,\r\n\t\t        \tDuplicateEntity: item.Id\r\n\t\t        }\r\n\t\t\t];\r\n\t\t\teavAdminDialogs.openEditItems(items, svc.liveListReload);\r\n\t\t}\r\n\r\n\t\tfunction close() {\r\n\t\t\t$modalInstance.dismiss(\"cancel\");\r\n\t\t}\r\n\t}\r\n\r\n}());\n(function () { // TN: this is a helper construct, research iife or read https://github.com/johnpapa/angularjs-styleguide#iife\r\n\r\n    ContentItemsListController.$inject = [\"contentItemsSvc\", \"eavConfig\", \"appId\", \"contentType\", \"eavAdminDialogs\", \"debugState\", \"$modalInstance\"];\r\n    angular.module(\"ContentItemsApp\", [\r\n        \"EavConfiguration\",\r\n        \"EavAdminUi\",\r\n        \"EavServices\"\r\n    ])\r\n        .controller(\"ContentItemsList\", ContentItemsListController)\r\n    ;\r\n\r\n    function ContentItemsListController(contentItemsSvc, eavConfig, appId, contentType, eavAdminDialogs, debugState, $modalInstance) {\r\n        var vm = this;\r\n        vm.debug = debugState;\r\n\r\n        var svc = contentItemsSvc(appId, contentType); \r\n\r\n        // config\r\n        vm.maxDynamicColumns = 10;\r\n\r\n        vm.add = function add() {\r\n            eavAdminDialogs.openItemNew(contentType, svc.liveListReload);\r\n        };\r\n\r\n        vm.edit = function(item) {\r\n            eavAdminDialogs.openItemEditWithEntityId(item.Id, svc.liveListReload);\r\n        };\r\n\r\n        vm.refresh = svc.liveListReload;\r\n\r\n        vm.items = svc.liveList();\r\n\r\n        vm.dynamicColumns = [];\r\n        svc.getColumns().then(function (result) {\r\n            var cols = result.data;\r\n            for (var c = 0; c < cols.length && c < vm.maxDynamicColumns; c++) {\r\n                if (!cols[c].IsTitle)\r\n                    vm.dynamicColumns.push(cols[c]);\r\n            }\r\n        });\r\n\r\n        vm.tryToDelete = function tryToDelete(item) {\r\n            if (confirm(\"Delete '\" + \"title-unknown-yet\" + \"' (\" + item.RepositoryId + \") ?\"))\r\n                svc.delete(item.RepositoryId);\r\n        };\r\n\r\n        vm.openDuplicate = function openDuplicate(item) {\r\n            var items = [\r\n                {\r\n                    ContentTypeName: contentType,\r\n                    DuplicateEntity: item.Id\r\n                }\r\n            ];\r\n            eavAdminDialogs.openEditItems(items, svc.liveListReload);\r\n\r\n        };\r\n\r\n        vm.close = function () { $modalInstance.dismiss(\"cancel\"); };\r\n\r\n    }\r\n\r\n} ());\n(function () { // TN: this is a helper construct, research iife or read https://github.com/johnpapa/angularjs-styleguide#iife\r\n\r\n    HistoryController.$inject = [\"appId\", \"entityId\", \"historySvc\", \"$modalInstance\", \"$modal\"];\r\n    HistoryDetailsController.$inject = [\"changeId\", \"dataSvc\", \"$modalInstance\"];\r\n    angular.module(\"HistoryApp\", [\r\n        \"EavServices\",\r\n        \"EavConfiguration\",\r\n        \"eavTemplates\",\r\n    ])\r\n        .controller(\"History\", HistoryController)\r\n        .controller(\"HistoryDetails\", HistoryDetailsController)\r\n        ;\r\n\r\n    function HistoryController(appId, entityId, historySvc, $modalInstance, $modal) {\r\n        var vm = this;\r\n        var svc = historySvc(appId, entityId);\r\n        vm.entityId = entityId;\r\n        vm.items = svc.liveList();\r\n\r\n        vm.close = function () { $modalInstance.dismiss(\"cancel\"); };\r\n\r\n        vm.details = function(item) {\r\n            $modal.open({\r\n                animation: true,\r\n                templateUrl: \"content-items/history-details.html\",\r\n                controller: \"HistoryDetails\",\r\n                controllerAs: \"vm\",\r\n                resolve: {\r\n                    changeId: function() { return item.ChangeId; },\r\n                    dataSvc: function() { return svc; }\r\n                }\r\n            });\r\n        };\r\n    }\r\n\r\n    function HistoryDetailsController(changeId, dataSvc, $modalInstance) {\r\n        var vm = this;\r\n        alert(\"not implemented yet\");\r\n        var svc = dataSvc;\r\n\r\n        svc.getVersionDetails(changeId).then(function(result) {\r\n            alert(result.data);\r\n            vm.items = result.data;\r\n        });\r\n        // vm.items = svc.liveList();\r\n\r\n        vm.close = function () { $modalInstance.dismiss(\"cancel\"); };\r\n    }\r\n} ());\n// This is the main declaration for the app ContentTypesApp\r\n(function () {\r\n\r\n    angular.module(\"ContentTypesApp\", [\r\n        \"EavServices\",\r\n        \"EavAdminUi\",\r\n        \"EavDirectives\"\r\n        ])\r\n        .constant(\"license\", {\r\n            createdBy: \"2sic internet solutions\",\r\n            license: \"MIT\"\r\n            })             \r\n    ;  \r\n}()); \n(function() {\r\n\r\n    contentTypeEditController.$inject = [\"appId\", \"item\", \"contentTypeSvc\", \"debugState\", \"$translate\", \"$modalInstance\"];\r\n    angular.module(\"ContentTypesApp\")\r\n        .controller(\"Edit\", contentTypeEditController);\r\n\r\n    /// Edit or add a content-type\r\n    /// Note that the svc can also be null if you don't already have it, the system will then create its own\r\n    function contentTypeEditController(appId, item, contentTypeSvc, debugState, $translate, $modalInstance) {\r\n        var vm = this;\r\n        var svc = contentTypeSvc(appId);\r\n\r\n        vm.debug = debugState;\r\n\r\n        vm.item = item;\r\n        vm.item.ChangeStaticName = false;\r\n        vm.item.NewStaticName = vm.item.StaticName; // in case you really, really want to change it\r\n\r\n        vm.ok = function () {\r\n            svc.save(item).then(function() {\r\n                $modalInstance.close(vm.item);              \r\n            });\r\n        };\r\n\r\n        vm.close = function () {\r\n            $modalInstance.dismiss(\"cancel\");\r\n        };\r\n    }\r\n\r\n}());\n(function () {\r\n    /*jshint laxbreak:true */\r\n    contentTypeFieldEditController.$inject = [\"appId\", \"svc\", \"item\", \"$filter\", \"$modalInstance\"];\r\n    angular.module(\"ContentTypesApp\")\r\n        .controller(\"FieldEdit\", contentTypeFieldEditController)\r\n    ;\r\n\r\n    /// This is the main controller for adding a field\r\n    /// Add is a standalone dialog, showing 10 lines for new field names / types\r\n    function contentTypeFieldEditController(appId, svc, item, $filter, $modalInstance) {\r\n        var vm = this;\r\n\r\n        vm.items = [item];\r\n\r\n        vm.types = svc.types.liveList();\r\n\r\n        vm.allInputTypes = svc.getInputTypesList();\r\n\r\n        vm.resetSubTypes = function resetSubTypes(item) {\r\n            item.InputType = item.Type.toLowerCase() + \"-default\";\r\n        };\r\n\r\n        vm.ok = function () {\r\n            svc.updateInputType(vm.items[0]);\r\n            $modalInstance.close();\r\n        };\r\n\r\n        vm.close = function() { $modalInstance.dismiss(\"cancel\"); };\r\n    }\r\n}());\n(function () {\r\n    /*jshint laxbreak:true */\r\n    contentTypeFieldsAddController.$inject = [\"appId\", \"svc\", \"$filter\", \"$modalInstance\"];\r\n    angular.module(\"ContentTypesApp\")\r\n        .controller(\"FieldsAdd\", contentTypeFieldsAddController)\r\n    ;\r\n\r\n    /// This is the main controller for adding a field\r\n    /// Add is a standalone dialog, showing 10 lines for new field names / types\r\n    function contentTypeFieldsAddController(appId, svc, $filter, $modalInstance) {\r\n        var vm = this;\r\n\r\n        // prepare empty array of up to 10 new items to be added\r\n        var nw = svc.newItem;\r\n        vm.items = [nw(), nw(), nw(), nw(), nw(), nw(), nw(), nw(), nw(), nw()];\r\n\r\n        vm.item = svc.newItem();\r\n        vm.types = svc.types.liveList();\r\n\r\n        vm.allInputTypes = svc.getInputTypesList();\r\n        //svc.getInputTypes().then(function (result) {\r\n        //    function addToList(value, key) {\r\n        //        var item = {\r\n        //            dataType: value.Type.substring(0, value.Type.indexOf(\"-\")),\r\n        //            inputType: value.Type, \r\n        //            label: value.Label,\r\n        //            description: value.Description\r\n        //        };\r\n        //        vm.allInputTypes.push(item);\r\n        //    }\r\n\r\n        //    angular.forEach(result.data, addToList);\r\n\r\n        //    vm.allInputTypes = $filter(\"orderBy\")(vm.allInputTypes, [\"dataType\", \"inputType\"]);\r\n        //});\r\n\r\n        vm.resetSubTypes = function resetSubTypes(item) {\r\n            item.InputType = item.Type.toLowerCase() + \"-default\";\r\n        };\r\n\r\n        vm.ok = function () {\r\n            var items = vm.items;\r\n            var newList = [];\r\n            for (var c = 0; c < items.length; c++)\r\n                if (items[c].StaticName)\r\n                    newList.push(items[c]);\r\n            svc.addMany(newList, 0);\r\n            $modalInstance.close();\r\n        };\r\n\r\n        vm.close = function() { $modalInstance.dismiss(\"cancel\"); };\r\n    }\r\n}());\n/*jshint laxbreak:true */\r\n(function () {\r\n    contentTypeFieldListController.$inject = [\"appId\", \"contentTypeFieldSvc\", \"contentType\", \"$modalInstance\", \"$modal\", \"eavAdminDialogs\", \"$filter\", \"$translate\", \"eavConfig\"];\r\n    angular.module(\"ContentTypesApp\")\r\n        .controller(\"FieldList\", contentTypeFieldListController)\r\n    ;\r\n\r\n    /// The controller to manage the fields-list\r\n    function contentTypeFieldListController(appId, contentTypeFieldSvc, contentType, $modalInstance, $modal, eavAdminDialogs, $filter, $translate, eavConfig) {\r\n        var vm = this;\r\n        var svc = contentTypeFieldSvc(appId, contentType);\r\n\r\n        // to close this dialog\r\n        vm.close = function () {\r\n            $modalInstance.dismiss(\"cancel\");\r\n        };\r\n\r\n        vm.items = svc.liveList();\r\n\r\n        // Open an add-dialog, and add them if the dialog is closed\r\n        vm.add = function add() {\r\n            $modal.open({\r\n                animation: true,\r\n                templateUrl: \"content-types/content-types-fields-add.html\",\r\n                controller: \"FieldsAdd\",\r\n                controllerAs: \"vm\",\r\n                size: \"lg\",\r\n                resolve: {\r\n                    svc: function() { return svc; }\r\n                }\r\n            });\r\n        };\r\n\r\n        vm.edit = function edit(item) {\r\n            $modal.open({\r\n                animation: true,\r\n                templateUrl: \"content-types/content-types-field-edit.html\",\r\n                controller: \"FieldEdit\",\r\n                controllerAs: \"vm\",\r\n                size: \"lg\",\r\n                resolve: {\r\n                    svc: function() { return svc; },\r\n                    item: function() { return item; }\r\n                }\r\n            });\r\n\r\n        };\r\n\r\n        vm.inputTypeTooltip = function(inputType) {\r\n            if (inputType !== \"unknown\")\r\n                return inputType;\r\n\r\n            return \"unknown means it's using an old definition for input-types - edit it to use the new definition\";\r\n        };\r\n\r\n        // Actions like moveUp, Down, Delete, Title\r\n        vm.moveUp = svc.moveUp;\r\n        vm.moveDown = svc.moveDown;\r\n        vm.setTitle = svc.setTitle;\r\n\r\n        vm.tryToDelete = function tryToDelete(item) {\r\n            if (item.IsTitle) \r\n                return $translate([\"General.Messages.CantDelete\", \"General.Terms.Title\"], {target:\"{0}\"}).then(function (translations) {\r\n                    alert(translations[\"General.Messages.CantDelete\"].replace(\"{0}\", translations[\"General.Terms.Title\"]));\r\n                });\r\n\r\n            $translate(\"General.Questions.Delete\", { target: \"'\" + item.StaticName + \"' (\" + item.Id + \")\" }).then(function(msg) {\r\n                if (confirm(msg))\r\n                    svc.delete(item);\r\n            });\r\n        };\r\n\r\n        // Edit / Add metadata to a specific fields\r\n        vm.createOrEditMetadata = function createOrEditMetadata(item, metadataType) {\r\n            // assemble an array of 2 items for editing\r\n            var items = [vm.createItemDefinition(item, \"All\"),\r\n                vm.createItemDefinition(item, metadataType),\r\n                vm.createItemDefinition(item, item.InputType),\r\n            ];\r\n            eavAdminDialogs.openEditItems(items, svc.liveListReload);\r\n        };\r\n\r\n        vm.createItemDefinition = function createItemDefinition(item, metadataType) {\r\n            var title = metadataType === \"All\" ? $translate.instant(\"DataType.All.Title\") : metadataType; \r\n            return item.Metadata[metadataType] !== undefined\r\n                ? { EntityId: item.Metadata[metadataType].Id, Title: title }  // if defined, return the entity-number to edit\r\n                : {\r\n                    ContentTypeName: \"@\" + metadataType,        // otherwise the content type for new-assegnment\r\n                    Metadata: {\r\n                        Key: item.Id,\r\n                        KeyType: \"number\",\r\n                        TargetType: eavConfig.metadataOfAttribute\r\n                    },\r\n                    Title: title,\r\n                    Prefill: { Name: item.StaticName }\r\n                };      \r\n        };\r\n    }\r\n\r\n}());\n(function() {\r\n\r\n    contentTypeListController.$inject = [\"contentTypeSvc\", \"eavAdminDialogs\", \"appId\", \"debugState\", \"$translate\"];\r\n    angular.module(\"ContentTypesApp\")\r\n        .controller(\"List\", contentTypeListController);\r\n\r\n\r\n    /// Manage the list of content-types\r\n    function contentTypeListController(contentTypeSvc, eavAdminDialogs, appId, debugState, $translate) {\r\n        var vm = this;\r\n        var svc = contentTypeSvc(appId);\r\n\r\n        vm.debug = debugState;\r\n\r\n        vm.items = svc.liveList();\r\n        vm.refresh = svc.liveListReload;\r\n\r\n        vm.tryToDelete = function tryToDelete(item) {\r\n            $translate(\"General.Questions.Delete\", { target: \"'\" + item.Name + \"' (\" + item.Id + \")\"}).then(function(msg) {\r\n                if(confirm(msg))\r\n                    svc.delete(item);\r\n            });\r\n        };\r\n\r\n        vm.edit = function edit(item) {\r\n            if (item === undefined)\r\n                item = svc.newItem();\r\n\r\n            eavAdminDialogs.openContentTypeEdit(item, vm.refresh);\r\n        };\r\n\r\n        vm.createGhost = function createGhost() {\r\n            var sourceName = window.prompt(\"to create a ghost content-type enter source static name / id - this is a very advanced operation - read more about it on 2sxc.org/help?tag=ghost\");\r\n            if (!sourceName)\r\n                return;\r\n            svc.createGhost(sourceName);\r\n        };\r\n\r\n        vm.editFields = function editFields(item) {\r\n            eavAdminDialogs.openContentTypeFields(item, vm.refresh);\r\n        };\r\n\r\n        vm.editItems = function editItems(item) {\r\n            eavAdminDialogs.openContentItems(svc.appId, item.StaticName, item.Id, vm.refresh);\r\n        };\r\n\r\n        vm.addItem = function(contentType) {\r\n            eavAdminDialogs.openItemNew(contentType, vm.refresh);\r\n        };\r\n\r\n\r\n        vm.liveEval = function admin() {\r\n            $translate(\"General.Questions.SystemInput\").then(function (msg) {\r\n                var inp = prompt(msg);\r\n                if(inp)\r\n                    eval(inp); // jshint ignore:line\r\n            });\r\n        };\r\n\r\n        // this is to change the scope of the items being shown\r\n        vm.changeScope = function admin() {\r\n            $translate(\"ContentTypes.Buttons.ChangeScopeQuestion\").then(function (msg) {\r\n                var inp = prompt(msg);\r\n                if (inp)\r\n                    svc.setScope(inp);\r\n            });\r\n        };\r\n\r\n        vm.isGuid = function isGuid(txtToTest) {\r\n            var patt = new RegExp(/[a-f0-9]{8}(?:-[a-f0-9]{4}){3}-[a-f0-9]{12}/i);\r\n            return patt.test(txtToTest); // note: can't use the txtToTest.match because it causes infinite digest cycles\r\n        };\r\n\r\n        vm.permissions = function permissions(item) {\r\n            return eavAdminDialogs.openPermissionsForGuid(svc.appId, item.StaticName, vm.refresh);\r\n        };\r\n\r\n        vm.openExport = function openExport(item) {\r\n            return eavAdminDialogs.openContentExport(svc.appId, item.StaticName, vm.refresh);\r\n        };\r\n\r\n        vm.openImport = function openImport(item) {\r\n            return eavAdminDialogs.openContentImport(svc.appId, item.StaticName, vm.refresh);\r\n        };\r\n\r\n    }\r\n\r\n\r\n}());\n\r\n(function () {\r\n    /* jshint laxbreak:true*/\r\n\r\nangular.module(\"EavDirectives\", [])\r\n    .directive(\"icon\", function() {\r\n        return {\r\n            restrict: \"A\",\r\n            replace: false,\r\n            transclude: false,\r\n            link: function postLink(scope, elem, attrs) {\r\n                var icn = attrs.icon;\r\n                elem.addClass(\"glyphicon glyphicon-\" + icn);\r\n            }\r\n        };\r\n    })\r\n    .directive('stopEvent', function() {\r\n        return {\r\n            restrict: 'A',\r\n            link: function(scope, element, attr) {\r\n                if (attr && attr.stopEvent)\r\n                    element.bind(attr.stopEvent, function(e) {\r\n                        e.stopPropagation();\r\n                    });\r\n            }\r\n        };\r\n    })\r\n    .directive('showDebugAvailability', function() {\r\n        return {\r\n            restrict: 'E',\r\n            template: \"<span class=\\\"low-priority\\\" tooltip=\\\"{{ 'AdvancedMode.Info.Available' | translate }}\\\">\"\r\n                + \"&pi;\" // \"<i icon=\\\"sunglasses\\\"></i>\"\r\n                + \"</span><br/>\"\r\n        };\r\n    })\r\n\r\n    ;\r\n\r\n\r\n})();\n(function () { \r\n\r\n    permissionListController.$inject = [\"permissionsSvc\", \"eavAdminDialogs\", \"eavConfig\", \"appId\", \"targetGuid\", \"$modalInstance\"];\r\n    angular.module(\"PermissionsApp\", [\r\n        \"EavServices\",\r\n        \"EavConfiguration\",\r\n        \"EavAdminUi\"])\r\n        .controller(\"PermissionList\", permissionListController)\r\n        ;\r\n\r\n    function permissionListController(permissionsSvc, eavAdminDialogs, eavConfig, appId, targetGuid, $modalInstance /* $location */) {\r\n        var vm = this;\r\n        var svc = permissionsSvc(appId, targetGuid);\r\n\r\n        vm.edit = function edit(item) {\r\n            eavAdminDialogs.openItemEditWithEntityId(item.Id, svc.liveListReload);\r\n        };\r\n\r\n        vm.add = function add() {\r\n            eavAdminDialogs.openMetadataNew(appId, \"entity\", svc.PermissionTargetGuid, svc.ctName, svc.liveListReload);\r\n        };\r\n\r\n        vm.items = svc.liveList();\r\n        vm.refresh = svc.liveListReload;\r\n        \r\n        vm.tryToDelete = function tryToDelete(item) {\r\n            if (confirm(\"Delete '\" + item.Title + \"' (\" + item.Id + \") ?\"))\r\n                svc.delete(item.Id);\r\n        };\r\n\r\n        vm.close = function () {\r\n            $modalInstance.dismiss(\"cancel\");\r\n        };\r\n    }\r\n\r\n} ());\nangular.module(\"PipelineDesigner\", [\r\n        \"PipelineDesigner.filters\",\r\n        \"ngResource\",\r\n        \"EavConfiguration\",\r\n        \"EavServices\",\r\n        \"eavTemplates\",\r\n        \"eavNgSvcs\",\r\n        \"EavAdminUi\"\r\n    ])\r\n\r\n// datasource directive makes an element a DataSource with jsPlumb\r\n    .directive(\"datasource\", [\"$timeout\", function($timeout) {\r\n        return {\r\n            restrict: \"A\",\r\n            link: function(scope, element) {\r\n                // make this a DataSource when the DOM is ready\r\n                $timeout(function() {\r\n                    scope.makeDataSource(scope.dataSource, element);\r\n                });\r\n                if (scope.$last === true) {\r\n                    $timeout(function() {\r\n                        scope.$emit(\"ngRepeatFinished\");\r\n                    });\r\n                }\r\n            }\r\n        };\r\n    }]);\r\n\r\n// Filters for \"ClassName, AssemblyName\"\r\nangular.module(\"PipelineDesigner.filters\", []).filter(\"typename\", function () {\r\n\treturn function (input, format) {\r\n\t\tvar globalParts = input.match(/[^,\\s]+/g);\r\n\r\n\t\tswitch (format) {\r\n\t\t\tcase \"classFullName\":\r\n\t\t\t\tif (globalParts)\r\n\t\t\t\t    return globalParts[0];\r\n\t\t\t    break;\r\n\t\t\tcase \"className\":\r\n\t\t\t\tif (globalParts) {\r\n\t\t\t\t\tvar classFullName = globalParts[0].match(/[^\\.]+/g);\r\n\t\t\t\t\treturn classFullName[classFullName.length - 1];\r\n\t\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn input;\r\n\t};\r\n});\n// AngularJS Controller for the >>>> Pipeline Designer\r\n\r\n(function () {\r\n    /*jshint laxbreak:true */\r\n\r\n    // helper method because we don't have jQuery any more to find the offset\r\n    function getElementOffset(element) {\r\n        var de = document.documentElement;\r\n        var box = element.getBoundingClientRect();\r\n        var top = box.top + window.pageYOffset - de.clientTop;\r\n        var left = box.left + window.pageXOffset - de.clientLeft;\r\n        return { top: top, left: left };\r\n    }\r\n\r\n    angular.module(\"PipelineDesigner\")\r\n        .controller(\"PipelineDesignerController\",\r\n            [\"appId\", \"pipelineId\", \"$scope\", \"pipelineService\", \"$location\", \"debugState\", \"$timeout\", \"ctrlS\", \"$filter\", \"toastrWithHttpErrorHandling\", \"eavAdminDialogs\", \"$log\", \"eavConfig\", \"$q\", function (appId, pipelineId, $scope, pipelineService, $location, debugState, $timeout, ctrlS, $filter, toastrWithHttpErrorHandling, eavAdminDialogs, $log, eavConfig, $q) {\r\n                \"use strict\";\r\n                var vm = this;\r\n                // Init\r\n                vm.debug = debugState;\r\n                var toastr = toastrWithHttpErrorHandling;\r\n                var waitMsg = toastr.info(\"This shouldn't take long\", \"Please wait...\");\r\n\r\n                function activate() {\r\n                    // add ctrl+s to save\r\n                    vm.saveShortcut = ctrlS(function() { vm.savePipeline(); });\r\n                }\r\n                activate();\r\n\r\n\r\n                $scope.readOnly = true;\r\n                $scope.dataSourcesCount = 0;\r\n                $scope.dataSourceIdPrefix = \"dataSource_\";\r\n                $scope.debug = false;\r\n\r\n                // Load Pipeline Data\r\n                $scope.PipelineEntityId = pipelineId;\r\n\r\n                pipelineService.setAppId(appId);\r\n\r\n                // this will retrieve the dataSource info-object for a DOM element\r\n                $scope.findDataSourceOfElement = function fdsog(element) {\r\n                    var guid = element.attributes.guid.value;\r\n                    var list = $scope.pipelineData.DataSources;\r\n                    var found = $filter(\"filter\")(list, { EntityGuid: guid })[0];\r\n                    return found;\r\n                };\r\n\r\n                // Get Data from PipelineService (Web API)\r\n                pipelineService.getPipeline($scope.PipelineEntityId)\r\n                    .then(function(success) {\r\n                        $scope.pipelineData = success;\r\n\r\n                        // If a new (empty) Pipeline is made, init new Pipeline\r\n                        if (!$scope.PipelineEntityId || $scope.pipelineData.DataSources.length === 1) {\r\n                            $scope.readOnly = false;\r\n                            initNewPipeline();\r\n                        } else {\r\n                            // if read only, show message\r\n                            $scope.readOnly = !success.Pipeline.AllowEdit;\r\n                            toastr.clear(waitMsg);\r\n                            toastr.info($scope.readOnly ? \"This pipeline is read only\" : \"You can now design the Pipeline. \\nNote that there are still a few UI bugs.\\nVisit 2sxc.org/help for more.\",\r\n                                \"Ready\", { autoDismiss: true });\r\n                        }\r\n                    }, function(reason) {\r\n                        toastr.error(reason, \"Loading Pipeline failed\");\r\n                    });\r\n\r\n\r\n                // init new jsPlumb Instance\r\n                jsPlumb.ready(function () {\r\n\r\n                    $scope.jsPlumbInstance = jsPlumb.getInstance({\r\n                        Connector: [\"Bezier\", { curviness: 70 }],\r\n                        HoverPaintStyle: {\r\n                            lineWidth: 4,\r\n                            strokeStyle: \"#216477\",\r\n                            outlineWidth: 2,\r\n                            outlineColor: \"white\"\r\n                        },\r\n                        PaintStyle: {\r\n                            lineWidth: 4,\r\n                            strokeStyle: \"#61B7CF\",\r\n                            joinstyle: \"round\",\r\n                            outlineColor: \"white\",\r\n                            outlineWidth: 2\r\n                        },\r\n                        Container: \"pipelineContainer\"\r\n                    });\r\n\r\n\r\n                    // If connection on Out-DataSource was removed, remove custom Endpoint\r\n                    $scope.jsPlumbInstance.bind(\"connectionDetached\", function(info) {\r\n                        if (info.targetId === $scope.dataSourceIdPrefix + \"Out\") {\r\n                            var element = angular.element(info.target);\r\n                            var fixedEndpoints = $scope.findDataSourceOfElement(element) /* element.scope() */.dataSource.Definition().In;\r\n                            var label = info.targetEndpoint.getOverlay(\"endpointLabel\").label;\r\n                            if (fixedEndpoints.indexOf(label) === -1) {\r\n                                $timeout(function() {\r\n                                    $scope.jsPlumbInstance.deleteEndpoint(info.targetEndpoint);\r\n                                });\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                    // If a new connection is created, ask for a name of the In-Stream\r\n                    $scope.jsPlumbInstance.bind(\"connection\", function(info) {\r\n                        if (!$scope.connectionsInitialized) return;\r\n\r\n                        // Repeat until a valid Stream-Name is provided by the user\r\n                        var repeatCount = 0;\r\n                        var endpointHandling = function(endpoint) {\r\n                            var label = endpoint.getOverlay(\"endpointLabel\").getLabel();\r\n                            if (label === labelPrompt && info.targetEndpoint.id !== endpoint.id && angular.element(endpoint.canvas).hasClass(\"targetEndpoint\"))\r\n                                targetEndpointHavingSameLabel = endpoint;\r\n                        };\r\n                        while (true) {\r\n                            repeatCount++;\r\n\r\n                            var promptMessage = \"Please name the Stream\";\r\n                            if (repeatCount > 1)\r\n                                promptMessage += \". Ensure the name is not used by any other Stream on this DataSource.\";\r\n\r\n                            var endpointLabel = info.targetEndpoint.getOverlay(\"endpointLabel\");\r\n                            var labelPrompt = prompt(promptMessage, endpointLabel.getLabel());\r\n                            if (labelPrompt)\r\n                                endpointLabel.setLabel(labelPrompt);\r\n                            else\r\n                                continue;\r\n\r\n                            // Check if any other Target-Endpoint has the same Stream-Name (Label)\r\n                            var endpoints = $scope.jsPlumbInstance.getEndpoints(info.target.id);\r\n                            var targetEndpointHavingSameLabel = null;\r\n\r\n                            angular.forEach(endpoints, endpointHandling);\r\n                            if (targetEndpointHavingSameLabel)\r\n                                continue;\r\n\r\n                            break;\r\n                        }\r\n                    });\r\n                });\r\n\r\n                // #region jsPlumb Endpoint Definitions\r\n                var getEndpointOverlays = function(isSource) {\r\n                    return [\r\n                        [\r\n                            \"Label\", {\r\n                                id: \"endpointLabel\",\r\n                                location: [0.5, isSource ? -0.5 : 1.5],\r\n                                label: \"Default\",\r\n                                cssClass: isSource ? \"endpointSourceLabel\" : \"endpointTargetLabel\",\r\n                                events: {\r\n                                    dblclick: function(labelOverlay) {\r\n                                        if ($scope.readOnly) return;\r\n\r\n                                        var newLabel = prompt(\"Rename Stream\", labelOverlay.label);\r\n                                        if (newLabel)\r\n                                            labelOverlay.setLabel(newLabel);\r\n                                    }\r\n                                }\r\n                            }\r\n                        ]\r\n                    ];\r\n                };\r\n\r\n                // the definition of source endpoints (the small blue ones)\r\n                var sourceEndpoint = {\r\n                    paintStyle: { fillStyle: \"transparent\", radius: 10, lineWidth: 0 },\r\n                    cssClass: \"sourceEndpoint\",\r\n                    maxConnections: -1,\r\n                    isSource: true,\r\n                    anchor: [\"Continuous\", { faces: [\"top\"] }],\r\n                    overlays: getEndpointOverlays(true)\r\n                };\r\n\r\n                // the definition of target endpoints (will appear when the user drags a connection) \r\n                var targetEndpoint = {\r\n                    paintStyle: { fillStyle: \"transparent\", radius: 10, lineWidth: 0 },\r\n                    cssClass: \"targetEndpoint\",\r\n                    maxConnections: 1,\r\n                    isTarget: true,\r\n                    anchor: [\"Continuous\", { faces: [\"bottom\"] }],\r\n                    overlays: getEndpointOverlays(false),\r\n                    dropOptions: { hoverClass: \"hover\", activeClass: \"active\" }\r\n                };\r\n                // #endregion\r\n\r\n                // make a DataSource with Endpoints, called by the datasource-Directive (which uses a $timeout)\r\n                $scope.makeDataSource = function(dataSource, element) {\r\n                    // suspend drawing and initialise\r\n                \t$scope.jsPlumbInstance.batch(function () {\r\n\r\n                \t\t// make DataSources draggable. Must happen before makeSource()!\r\n                \t\tif (!$scope.readOnly) {\r\n                \t\t\t$scope.jsPlumbInstance.draggable(element, {\r\n                \t\t\t\tgrid: [20, 20],\r\n                \t\t\t\tdrag: $scope.dataSourceDrag\r\n                \t\t\t});\r\n                \t\t}\r\n\r\n                        // Add Out- and In-Endpoints from Definition\r\n                        var dataSourceDefinition = dataSource.Definition();\r\n                        if (dataSourceDefinition !== null) {\r\n                            // Add Out-Endpoints\r\n                            angular.forEach(dataSourceDefinition.Out, function(name) {\r\n                                addEndpoint(element, name, false);\r\n                            });\r\n                            // Add In-Endpoints\r\n                            angular.forEach(dataSourceDefinition.In, function(name) {\r\n                                addEndpoint(element, name, true);\r\n                            });\r\n                            // make the DataSource a Target for new Endpoints (if .In is an Array)\r\n                            if (dataSourceDefinition.In) {\r\n                                var targetEndpointUnlimited = targetEndpoint;\r\n                                targetEndpointUnlimited.maxConnections = -1;\r\n                                $scope.jsPlumbInstance.makeTarget(element, targetEndpointUnlimited);\r\n                            }\r\n\r\n                            $scope.jsPlumbInstance.makeSource(element, sourceEndpoint, { filter: \".ep .glyphicon\" });\r\n                        }\r\n\r\n                        \r\n                    });\r\n\r\n                    $scope.dataSourcesCount++;\r\n                };\r\n\r\n                // Add a jsPlumb Endpoint to an Element\r\n                var addEndpoint = function(element, name, isIn) {\r\n                    if (!element.length) {\r\n                        $log.error({ message: \"Element not found\", selector: element.selector });\r\n                        return;\r\n                    }\r\n                    console.log(element);\r\n\r\n                    var dataSource = $scope.findDataSourceOfElement(element[0]);\r\n\r\n                    var uuid = element[0].id + (isIn ? \"_in_\" : \"_out_\") + name;\r\n                    // old - using jQuery - var uuid = element.attr(\"id\") + (isIn ? \"_in_\" : \"_out_\") + name;\r\n                    var params = {\r\n                        uuid: uuid,\r\n                        enabled: !dataSource.ReadOnly || dataSource.EntityGuid == \"Out\" // Endpoints on Out-DataSource must be always enabled\r\n                    };\r\n                    var endPoint = $scope.jsPlumbInstance.addEndpoint(element, (isIn ? targetEndpoint : sourceEndpoint), params);\r\n                    endPoint.getOverlay(\"endpointLabel\").setLabel(name);\r\n                };\r\n\r\n                // Initialize jsPlumb Connections once after all DataSources were created in the DOM\r\n                $scope.connectionsInitialized = false;\r\n                $scope.$on(\"ngRepeatFinished\", function() {\r\n                    if ($scope.connectionsInitialized) return;\r\n\r\n                    // suspend drawing and initialise\r\n                    $scope.jsPlumbInstance.batch(function() {\r\n                        initWirings($scope.pipelineData.Pipeline.StreamWiring);\r\n                    });\r\n                    $scope.repaint(); // repaint so continuous connections are aligned correctly\r\n\r\n                    $scope.connectionsInitialized = true;\r\n                });\r\n\r\n\r\n                var initWirings = function(streamWiring) {\r\n                    angular.forEach(streamWiring, function(wire) {\r\n                        // read connections from Pipeline\r\n                        var sourceElementId = $scope.dataSourceIdPrefix + wire.From;\r\n                        var fromUuid = sourceElementId + \"_out_\" + wire.Out;\r\n                        var targetElementId = $scope.dataSourceIdPrefix + wire.To;\r\n                        var toUuid = targetElementId + \"_in_\" + wire.In;\r\n\r\n                        // Ensure In- and Out-Endpoint exist\r\n                        if (!$scope.jsPlumbInstance.getEndpoint(fromUuid))\r\n                            addEndpoint(jsPlumb.getSelector(\"#\" + sourceElementId), wire.Out, false);\r\n                        if (!$scope.jsPlumbInstance.getEndpoint(toUuid))\r\n                            addEndpoint(jsPlumb.getSelector(\"#\" + targetElementId), wire.In, true);\r\n\r\n                        try {\r\n                            $scope.jsPlumbInstance.connect({ uuids: [fromUuid, toUuid] });\r\n                        } catch (e) {\r\n                            $log.error({ message: \"Connection failed\", from: fromUuid, to: toUuid });\r\n                        }\r\n                    });\r\n\r\n                    // $scope.jsPlumbInstance.getConnections\r\n\r\n                };\r\n\r\n                // Init a new Pipeline with DataSources and Wirings from Configuration\r\n                var initNewPipeline = function () {\r\n                    var templateForNew = eavConfig.pipelineDesigner.defaultPipeline.dataSources;\r\n                    angular.forEach(templateForNew, function(dataSource) {\r\n                        $scope.addDataSource(dataSource.partAssemblyAndType, dataSource.visualDesignerData, false, dataSource.entityGuid);\r\n                    });\r\n\r\n                    // Wait until all DataSources were created\r\n                    var initWiringsListener = $scope.$on(\"ngRepeatFinished\", function() {\r\n                        $scope.connectionsInitialized = false;\r\n                        initWirings(eavConfig.pipelineDesigner.defaultPipeline.streamWiring);\r\n                        $scope.connectionsInitialized = true;\r\n\r\n                        initWiringsListener(); // unbind the Listener\r\n                    });\r\n                };\r\n\r\n                // Add new DataSource\r\n                $scope.addDataSource = function(partAssemblyAndType, visualDesignerData, autoSave, entityGuid) {\r\n                    if (!partAssemblyAndType) {\r\n                        partAssemblyAndType = $scope.addDataSourceType.PartAssemblyAndType;\r\n                        $scope.addDataSourceType = null;\r\n                    }\r\n                    if (!visualDesignerData)\r\n                        visualDesignerData = { Top: 100, Left: 100 };\r\n\r\n                    var newDataSource = {\r\n                        VisualDesignerData: visualDesignerData,\r\n                        Name: $filter(\"typename\")(partAssemblyAndType, \"className\"),\r\n                        Description: \"\",\r\n                        PartAssemblyAndType: partAssemblyAndType,\r\n                        EntityGuid: entityGuid || \"unsaved\" + ($scope.dataSourcesCount + 1)\r\n                    };\r\n                    // Extend it with a Property to it's Definition\r\n                    newDataSource = angular.extend(newDataSource, pipelineService.getNewDataSource($scope.pipelineData, newDataSource));\r\n\r\n                    $scope.pipelineData.DataSources.push(newDataSource);\r\n\r\n                    if (autoSave !== false)\r\n                        $scope.savePipeline();\r\n                };\r\n\r\n                // Delete a DataSource\r\n                $scope.remove = function(index) {\r\n                    var dataSource = $scope.pipelineData.DataSources[index];\r\n                    if (!confirm(\"Delete DataSource \\\"\" + (dataSource.Name || \"(unnamed)\") + \"\\\"?\")) return;\r\n                    var elementId = $scope.dataSourceIdPrefix + dataSource.EntityGuid;\r\n                    $scope.jsPlumbInstance.selectEndpoints({ element: elementId }).remove();\r\n                    $scope.pipelineData.DataSources.splice(index, 1);\r\n                };\r\n\r\n                // Edit name of a DataSource\r\n                $scope.editName = function(dataSource) {\r\n                    if (dataSource.ReadOnly) return;\r\n\r\n                    var newName = prompt(\"Rename DataSource\", dataSource.Name);\r\n                    if (newName && newName.trim())\r\n                        dataSource.Name = newName.trim();\r\n                };\r\n\r\n                // Edit Description of a DataSource\r\n                $scope.editDescription = function(dataSource) {\r\n                    if (dataSource.ReadOnly) return;\r\n\r\n                    var newDescription = prompt(\"Edit Description\", dataSource.Description);\r\n                    if (newDescription && newDescription.trim())\r\n                        dataSource.Description = newDescription.trim();\r\n                };\r\n\r\n                // Update DataSource Position on Drag\r\n                $scope.dataSourceDrag = function(draggedWrapper) {\r\n                    var offset = getElementOffset(draggedWrapper.el);\r\n                    var dataSource = $scope.findDataSourceOfElement(draggedWrapper.el);\r\n                    $scope.$apply(function() {\r\n                        dataSource.VisualDesignerData.Top = Math.round(offset.top);\r\n                        dataSource.VisualDesignerData.Left = Math.round(offset.left);\r\n                    });\r\n                };\r\n\r\n                // Configure a DataSource\r\n                $scope.configureDataSource = function(dataSource) {\r\n                    if (dataSource.ReadOnly) return;\r\n\r\n                    // Ensure dataSource Entity is saved\r\n                    if (!dataSourceIsPersisted(dataSource)) {\r\n                        $scope.savePipeline();\r\n                        return;\r\n                    }\r\n\r\n                    pipelineService.editDataSourcePart(dataSource);\r\n\r\n                };\r\n\r\n                // Test wether a DataSource is persisted on the Server\r\n                var dataSourceIsPersisted = function(dataSource) {\r\n                    return dataSource.EntityGuid.indexOf(\"unsaved\") === -1;\r\n                };\r\n\r\n                // Show/Hide Endpoint Overlays\r\n                $scope.showEndpointOverlays = true;\r\n                $scope.toggleEndpointOverlays = function() {\r\n                    $scope.showEndpointOverlays = !$scope.showEndpointOverlays;\r\n\r\n                    var endpoints = $scope.jsPlumbInstance.selectEndpoints();\r\n                    if ($scope.showEndpointOverlays)\r\n                        endpoints.showOverlays();\r\n                    else\r\n                        endpoints.hideOverlays();\r\n                };\r\n\r\n                // Edit Pipeline Entity\r\n                $scope.editPipelineEntity = function() {\r\n                    // save Pipeline, then open Edit Dialog\r\n                    $scope.savePipeline().then(function() {\r\n                        vm.saveShortcut.unbind();\r\n                        eavAdminDialogs.openEditItems([{ EntityId: $scope.PipelineEntityId }], function() {\r\n                            pipelineService.getPipeline($scope.PipelineEntityId)\r\n                                .then(pipelineSaved)\r\n                                .then(vm.saveShortcut.rebind);\r\n                        });\r\n\r\n                    });\r\n                };\r\n\r\n                // Sync jsPlumb Connections and StreamsOut to the pipelineData-Object\r\n                var syncPipelineData = function() {\r\n                    var connectionInfos = [];\r\n                    angular.forEach($scope.jsPlumbInstance.getAllConnections(), function(connection) {\r\n                        connectionInfos.push({\r\n                            From: connection.sourceId.substr($scope.dataSourceIdPrefix.length),\r\n                            Out: connection.endpoints[0].getOverlay(\"endpointLabel\").label,\r\n                            To: connection.targetId.substr($scope.dataSourceIdPrefix.length),\r\n                            In: connection.endpoints[1].getOverlay(\"endpointLabel\").label\r\n                        });\r\n                    });\r\n                    $scope.pipelineData.Pipeline.StreamWiring = connectionInfos;\r\n\r\n                    var streamsOut = [];\r\n                    $scope.jsPlumbInstance.selectEndpoints({ target: $scope.dataSourceIdPrefix + \"Out\" }).each(function(endpoint) {\r\n                        streamsOut.push(endpoint.getOverlay(\"endpointLabel\").label);\r\n                    });\r\n                    $scope.pipelineData.Pipeline.StreamsOut = streamsOut.join(\",\");\r\n                };\r\n\r\n                // #region Save Pipeline\r\n                // Save Pipeline\r\n                // returns a Promise about the saving state\r\n                vm.savePipeline = $scope.savePipeline = function (successHandler) {\r\n                    var waitMsg = toastr.info(\"This shouldn't take long\", \"Saving...\");\r\n                    $scope.readOnly = true;\r\n\r\n                    syncPipelineData();\r\n\r\n                    var deferred = $q.defer();\r\n\r\n                    if (typeof successHandler == \"undefined\") // set default success Handler\r\n                        successHandler = pipelineSaved;\r\n\r\n                    pipelineService.savePipeline($scope.pipelineData.Pipeline, $scope.pipelineData.DataSources).then(successHandler, function(reason) {\r\n                        toastr.error(reason, \"Save Pipeline failed\");\r\n                        $scope.readOnly = false;\r\n                        deferred.reject();\r\n                    }).then(function() {\r\n                        deferred.resolve();\r\n                    });\r\n\r\n                    return deferred.promise;\r\n                };\r\n\r\n                // Handle Pipeline Saved, success contains the updated Pipeline Data\r\n                var pipelineSaved = function(success) {\r\n                    // Update PipelineData with data retrieved from the Server\r\n                    $scope.pipelineData.Pipeline = success.Pipeline;\r\n                    $scope.PipelineEntityId = success.Pipeline.EntityId /*EntityId*/;\r\n                    $location.search(\"PipelineId\", success.Pipeline.EntityId /*EntityId*/);\r\n                    $scope.readOnly = !success.Pipeline.AllowEdit;\r\n                    $scope.pipelineData.DataSources = success.DataSources;\r\n                    pipelineService.postProcessDataSources($scope.pipelineData);\r\n\r\n                    toastr.clear();\r\n                    toastr.success(\"Pipeline \" + success.Pipeline.EntityId + \" saved and loaded\", \"Saved\", { autoDismiss: true });\r\n\r\n                    // Reset jsPlumb, re-Init Connections\r\n                    $scope.jsPlumbInstance.reset();\r\n                    $scope.connectionsInitialized = false;\r\n                };\r\n                // #endregion\r\n\r\n                // Repaint jsPlumb\r\n                $scope.repaint = function() {\r\n                    $scope.jsPlumbInstance.repaintEverything();\r\n                };\r\n\r\n                // Show/Hide Debug info\r\n                $scope.toogleDebug = function() {\r\n                    $scope.debug = !$scope.debug;\r\n                };\r\n\r\n                // Query the Pipeline\r\n                $scope.queryPipeline = function() {\r\n                    var query = function() {\r\n                        // Query pipelineService for the result...\r\n                        toastr.info(\"Running Query ...\");\r\n\r\n                        pipelineService.queryPipeline($scope.PipelineEntityId).then(function(success) {\r\n                            // Show Result in a UI-Dialog\r\n                            toastr.clear();\r\n\r\n                            var resolve = eavAdminDialogs.CreateResolve({ testParams: $scope.pipelineData.Pipeline.TestParameters, result: success });\r\n                            eavAdminDialogs.OpenModal(\"pipelines/query-stats.html\", \"QueryStats as vm\", \"lg\", resolve);\r\n\r\n                            $timeout(function() {\r\n                                showEntityCountOnStreams(success);\r\n                            });\r\n                            $log.debug(success);\r\n                        }, function(reason) {\r\n                            toastr.error(reason, \"Query failed\");\r\n                        });\r\n                    };\r\n\r\n\r\n                    var showEntityCountOnStreams = function(result) {\r\n                        angular.forEach(result.Streams, function(stream) {\r\n                            // Find jsPlumb Connection for the current Stream\r\n                            var sourceElementId = $scope.dataSourceIdPrefix + stream.Source;\r\n                            var targetElementId = $scope.dataSourceIdPrefix + stream.Target;\r\n                            if (stream.Target === \"00000000-0000-0000-0000-000000000000\")\r\n                                targetElementId = $scope.dataSourceIdPrefix + \"Out\";\r\n\r\n                            var fromUuid = sourceElementId + \"_out_\" + stream.SourceOut;\r\n                            var toUuid = targetElementId + \"_in_\" + stream.TargetIn;\r\n\r\n                            var sourceEndpoint = $scope.jsPlumbInstance.getEndpoint(fromUuid);\r\n                            var streamFound = false;\r\n                            if (sourceEndpoint) {\r\n                                angular.forEach(sourceEndpoint.connections, function(connection) {\r\n                                    if (connection.endpoints[1].getUuid() === toUuid) {\r\n                                        // when connection found, update it's label with the Entities-Count\r\n                                        connection.setLabel({\r\n                                            label: stream.Count.toString(),\r\n                                            cssClass: \"streamEntitiesCount\"\r\n                                        });\r\n                                        streamFound = true;\r\n                                        return;\r\n                                    }\r\n                                });\r\n                            }\r\n\r\n                            if (!streamFound)\r\n                                $log.error(\"Stream not found\", stream, sourceEndpoint);\r\n                        });\r\n                    };\r\n\r\n                    // Ensure the Pipeline is saved\r\n                    $scope.savePipeline().then(query);\r\n                };\r\n\r\n                // Clone the Pipeline\r\n                $scope.clonePipeline = function() {\r\n                    if (!confirm(\"Clone Pipeline \" + $scope.PipelineEntityId + \"?\")) return;\r\n\r\n                    // Clone and get new PipelineEntityId\r\n                    var clone = function() {\r\n                        return pipelineService.clonePipeline($scope.PipelineEntityId);\r\n                    };\r\n                    // Get the new Pipeline (Pipeline and DataSources)\r\n                    var getClonePipeline = function(success) {\r\n                        return pipelineService.getPipeline(success.EntityId /*EntityId*/);\r\n                    };\r\n\r\n                    // Save, clone, get clone, load clone\r\n                    $scope.savePipeline(null).then(clone).then(getClonePipeline).then(pipelineSaved);\r\n                };\r\n            }]);\r\n})();\n// Config and Controller for the Pipeline Management UI\r\nangular.module(\"PipelineManagement\", [\r\n    \"EavServices\",\r\n    \"EavConfiguration\",\r\n    \"eavNgSvcs\",\r\n    \"EavAdminUi\"\r\n]).\r\n\tcontroller(\"PipelineManagement\", [\"$modalInstance\", \"appId\", \"pipelineService\", \"debugState\", \"eavAdminDialogs\", \"eavConfig\", function ($modalInstance, appId, pipelineService, debugState, eavAdminDialogs, eavConfig) {\r\n\t    var vm = this;\r\n        vm.debug = debugState;\r\n        vm.appId = appId;\r\n\r\n\t    pipelineService.setAppId(appId);\r\n\r\n        // 2016-02-18 2dm - probably not needed\r\n\t    // pipelineService.initContentTypes();\r\n\r\n\t    // 2016-01-14 2dm - commenting out completely, as the getPipelineUrl is probably not used any more\r\n\t    // Make URL-Provider available to the scope\r\n\t    // vm.getPipelineUrl = pipelineService.getPipelineUrl;\r\n\r\n\t    // Refresh List of Pipelines\r\n\t    vm.refresh = function () {\r\n\t        vm.pipelines = pipelineService.getPipelines(appId);\r\n\t    };\r\n\t    vm.refresh();\r\n\r\n\t    // Delete a Pipeline\r\n        vm.delete = function(pipeline) {\r\n            if (!confirm(\"Delete Pipeline \\\"\" + pipeline.Name + \"\\\" (\" + pipeline.Id + \")?\"))\r\n                return;\r\n\r\n            pipelineService.deletePipeline(pipeline.Id).then(function() {\r\n                vm.refresh();\r\n            }, function(reason) {\r\n                alert(reason);\r\n            });\r\n        };\r\n\r\n\t    // Clone a Pipeline\r\n        vm.clone = function(pipeline) {\r\n            pipelineService.clonePipeline(pipeline.Id).then(function() {\r\n                vm.refresh();\r\n            }, function(reason) {\r\n                alert(reason);\r\n            });\r\n        };\r\n\r\n        vm.permissions = function (item) {\r\n            return eavAdminDialogs.openPermissionsForGuid(appId, item.Guid);\r\n        };\r\n\r\n        vm.add = function add() {\r\n            var items = [{\r\n                    ContentTypeName: \"DataPipeline\",\r\n                    Prefill: { TestParameters: eavConfig.pipelineDesigner.testParameters }\r\n                }];\r\n            eavAdminDialogs.openEditItems(items, vm.refresh);\r\n        };\r\n\r\n        vm.edit = function edit(item) {\r\n            eavAdminDialogs.openItemEditWithEntityId(item.Id, vm.refresh);\r\n        }; \r\n\r\n        vm.design = function design(item) {\r\n            return eavAdminDialogs.editPipeline(vm.appId, item.Id, vm.refresh);\r\n        };\r\n        vm.liveEval = function admin() {\r\n            var inp = prompt(\"This is for very advanced operations. Only use this if you know what you're doing. \\n\\n Enter admin commands:\");\r\n            if (inp)\r\n                eval(inp); // jshint ignore:line\r\n        };\r\n        vm.close = function () { $modalInstance.dismiss(\"cancel\"); };\r\n    }]);\n/*jshint laxbreak:true */\r\n(function() {\r\n\r\n    angular.module(\"PipelineDesigner\")\r\n        .controller(\"QueryStats\", [\"testParams\", \"result\", \"$modalInstance\", function (testParams, result, $modalInstance) {\r\n                var vm = this;\r\n                var success = result;\r\n                vm.testParameters = testParams.split(\"\\n\");\r\n                vm.timeUsed = success.QueryTimer.Milliseconds;\r\n                vm.ticksUsed = success.QueryTimer.Ticks;\r\n                vm.result = success.Query;\r\n\r\n                vm.sources = success.Sources;\r\n                vm.streams = success.Streams;\r\n\r\n                vm.connections = \"todo\";\r\n\r\n\r\n                vm.close = function () {\r\n                    $modalInstance.dismiss(\"cancel\");\r\n                };\r\n\r\n            }]\r\n        );\r\n})();\n// Init the main eav services module\r\nangular.module(\"EavServices\", [\r\n    \"ng\",                   // Angular for $http etc.\r\n    \"EavConfiguration\",     // global configuration\r\n    \"pascalprecht.translate\",\r\n    \"ngResource\",           // only needed for the pipeline-service, maybe not necessary any more?\r\n    \"ngAnimate\",\r\n    \"toastr\"\r\n]);\n\r\nangular.module(\"EavServices\")\r\n    .factory(\"contentItemsSvc\", [\"$http\", \"entitiesSvc\", \"metadataSvc\", \"svcCreator\", function($http, entitiesSvc, metadataSvc, svcCreator) {\r\n            return function createContentItemsSvc(appId, contentType) {\r\n                var svc = {};\r\n                svc.contentType = contentType;\r\n\r\n                svc.appId = appId;\r\n\r\n                svc = angular.extend(svc, svcCreator.implementLiveList(function getAll() {\r\n                    return $http.get(\"eav/entities/GetAllOfTypeForAdmin\", { params: { appId: svc.appId, contentType: svc.contentType } });\r\n                }));\r\n                \r\n                // delete, then reload\r\n                svc.delete = function del(id) {\r\n                    return entitiesSvc.delete(svc.contentType, id) // for now must work with get :( - delete doesn't work well in dnn\r\n                        .then(svc.liveListReload);\r\n                };\r\n\r\n                // todo: should use the ContentTypeService instead\r\n                svc.getColumns = function getColumns() {\r\n                    return $http.get(\"eav/contenttype/getfields/\", { params: { \"appid\": svc.appId, \"staticName\": svc.contentType } });\r\n                };\r\n\r\n                return svc;\r\n            };\r\n        }]\r\n    );\n\r\nangular.module(\"EavServices\")\r\n    .factory(\"contentTypeSvc\", [\"$http\", \"eavConfig\", \"svcCreator\", function ($http, eavConfig, svcCreator) {\r\n        return function appSpecificContentTypeSvc(appId, scope) {\r\n            var svc = {};\r\n            svc.scope = scope || eavConfig.contentType.defaultScope;\r\n            svc.appId = appId;\r\n\r\n            svc.retrieveContentTypes = function typeListRetrieve() {\r\n                return $http.get(\"eav/contenttype/get/\", { params: { \"appid\": svc.appId, \"scope\": svc.scope } });\r\n            };\r\n\r\n            svc = angular.extend(svc, svcCreator.implementLiveList(svc.retrieveContentTypes));\r\n\r\n            svc.getDetails = function getDetails(contentTypeName) {\r\n                return $http.get(\"eav/contenttype/GetSingle\", { params: { \"appid\": svc.appId, \"contentTypeStaticName\": contentTypeName } });\r\n            };\r\n\r\n            svc.newItem = function newItem() {\r\n                return {\r\n                    StaticName: \"\",\r\n                    Name: \"\",\r\n                    Description: \"\",\r\n                    Scope: eavConfig.contentType.defaultScope\r\n                };\r\n            };\r\n\r\n            svc.save = function save(item) {\r\n                return $http.post(\"eav/contenttype/save/\", item, { params: { appid: svc.appId } })\r\n                    .then(svc.liveListReload);\r\n            };\r\n\r\n            svc.delete = function del(item) {\r\n                return $http.get(\"eav/contenttype/delete\", { params: { appid: svc.appId, staticName: item.StaticName } })\r\n                    .then(svc.liveListReload);\r\n            };\r\n\r\n            svc.setScope = function setScope(newScope) {\r\n                svc.scope = newScope;\r\n                svc.liveListReload();\r\n            };\r\n\r\n            svc.createGhost = function createGhost(sourceStaticName) {\r\n                return $http.get(\"eav/contenttype/createghost\", { params: { appid: svc.appId, sourceStaticName: sourceStaticName } })\r\n                    .then(svc.liveListReload);\r\n            };\r\n            return svc;\r\n        };\r\n\r\n    }]);\n\r\nangular.module(\"EavServices\")\r\n    .factory(\"contentTypeFieldSvc\", [\"$http\", \"eavConfig\", \"svcCreator\", \"$filter\", function($http, eavConfig, svcCreator, $filter) {\r\n        return function createFieldsSvc(appId, contentType) {\r\n            // start with a basic service which implement the live-list functionality\r\n            var svc = {};\r\n            svc.appId = appId;\r\n            svc.contentType = contentType;\r\n\r\n            svc.typeListRetrieve = function typeListRetrieve() {\r\n                return $http.get(\"eav/contenttype/datatypes/\", { params: { \"appid\": svc.appId } });\r\n            };\r\n\r\n            svc._inputTypesList = [];\r\n            svc.getInputTypesList = function getInputTpes() {\r\n                if (svc._inputTypesList.length > 0)\r\n                    return svc._inputTypesList;\r\n                $http.get(\"eav/contenttype/inputtypes/\", { params: { \"appid\": svc.appId } })\r\n                    .then(function(result) {\r\n                        function addToList(value, key) {\r\n                            var item = {\r\n                                dataType: value.Type.substring(0, value.Type.indexOf(\"-\")),\r\n                                inputType: value.Type,\r\n                                label: value.Label,\r\n                                description: value.Description\r\n                            };\r\n                            svc._inputTypesList.push(item);\r\n                        }\r\n\r\n                        angular.forEach(result.data, addToList);\r\n\r\n                        svc._inputTypesList = $filter(\"orderBy\")(svc._inputTypesList, [\"dataType\", \"inputType\"]);\r\n                    });\r\n                return svc._inputTypesList;\r\n            };\r\n\r\n\t        svc.getFields = function getFields() {\r\n\t            return $http.get(\"eav/contenttype/getfields\", { params: { \"appid\": svc.appId, \"staticName\": svc.contentType.StaticName } })\r\n\t            .then(function(result) {\r\n\t                // merge the settings into one, with correct priority sequence\r\n\t                if (result.data ) {\r\n\t                    for (var i = 0; i < result.data.length; i++) {\r\n\t                        var fld = result.data[i];\r\n\t                        if(!fld.Metadata)\r\n                                continue;\r\n\t                        var md = fld.Metadata;\r\n\t                        var allMd = md.All;\r\n\t                        var typeMd = md[fld.Type];\r\n\t                        var inputMd = md[fld.InputType];\r\n\t                        md.merged = angular.merge({}, allMd, typeMd, inputMd);\r\n\t                    }\r\n\t                }\r\n\t                    return result;\r\n\t                });\r\n\t        };\r\n\r\n            svc = angular.extend(svc, svcCreator.implementLiveList(svc.getFields));\r\n\r\n            svc.types = svcCreator.implementLiveList(svc.typeListRetrieve);\r\n\r\n\r\n            svc.moveUp = function moveUp(item) {\r\n                return $http.get(\"eav/contenttype/reorder\", { params: { appid: svc.appId, contentTypeId: svc.contentType.Id, attributeId: item.Id, direction: \"up\" } })\r\n                    .then(svc.liveListReload);\r\n            };\r\n            svc.moveDown = function moveDown(item) {\r\n                return $http.get(\"eav/contenttype/reorder\", { params: { appid: svc.appId, contentTypeId: svc.contentType.Id, attributeId: item.Id, direction: \"down\" } })\r\n                    .then(svc.liveListReload);\r\n            };\r\n\r\n            svc.delete = function del(item) {\r\n                return $http.get(\"eav/contenttype/delete\", { params: { appid: svc.appId, contentTypeId: svc.contentType.Id, attributeId: item.Id } })\r\n                    .then(svc.liveListReload);\r\n            };\r\n\r\n            svc.addMany = function add(items, count) {\r\n                return $http.get(\"eav/contenttype/addfield/\", { params: items[count] })\r\n                    .then(function() {\r\n                        if (items.length == ++count)\r\n                            svc.liveListReload();\r\n                        else\r\n                            svc.addMany(items, count);\r\n                    });\r\n            };\r\n\r\n            svc.add = function addOne(item) {\r\n                return $http.get(\"eav/contenttype/addfield/\", { params: item })\r\n                    .then(svc.liveListReload);\r\n            };\r\n\r\n            svc.newItemCount = 0;\r\n            svc.newItem = function newItem() {\r\n                return {\r\n                    AppId: svc.appId,\r\n                    ContentTypeId: svc.contentType.Id,\r\n                    Id: 0,\r\n                    Type: \"String\",\r\n                    InputType: \"string-default\",\r\n                    StaticName: \"\",\r\n                    IsTitle: svc.liveList().length === 0,\r\n                    SortOrder: svc.liveList().length + svc.newItemCount++\r\n                };\r\n            };\r\n\r\n\r\n            svc.delete = function del(item) {\r\n                if (item.IsTitle)\r\n                    throw \"Can't delete Title\";\r\n                return $http.get(\"eav/contenttype/deletefield\", { params: { appid: svc.appId, contentTypeId: svc.contentType.Id, attributeId: item.Id } })\r\n                    .then(svc.liveListReload);\r\n            };\r\n\r\n            svc.updateInputType = function updateInputType(item) {\r\n                return $http.get(\"eav/contenttype/updateinputtype\", { params: { appid: svc.appId, attributeId: item.Id, field: item.StaticName, inputType: item.InputType } })\r\n                    .then(svc.liveListReload);\r\n            };\r\n\r\n\r\n            svc.setTitle = function setTitle(item) {\r\n                return $http.get(\"eav/contenttype/setTitle\", { params: { appid: svc.appId, contentTypeId: svc.contentType.Id, attributeId: item.Id } })\r\n                    .then(svc.liveListReload);\r\n            };\r\n\r\n\r\n            return svc;\r\n        };\r\n    }]);\n/* \r\n * \r\n * Simple service which takes care of ctrl+S keyboard shortcuts. \r\n * use it as a service for your controller, then add a line like \r\n         function activate() {\r\n            // add ctrl+s to save\r\n            ctrlS.bind(function() { vm.save(false); });\r\n        }\r\n\r\n */\r\n\r\nangular.module(\"EavServices\")\r\n    .factory(\"ctrlS\", [\"$window\", function ($window) {\r\n\r\n        // Create a capture Ctrl+S and execute action-object\r\n        function createSave(action) {\r\n            var save = {\r\n                _event: null,\r\n                _action: null,\r\n                _isbound: false,\r\n\r\n                // this will be called on each keydown, will check if it was a ctrl+S\r\n                detectCtrlSAndExcecute: function(e) {\r\n                    if (e.keyCode === 83 && (navigator.platform.match(\"Mac\") ? e.metaKey : e.ctrlKey)) {\r\n                        if (save._action === null)\r\n                            return console.log(\"can't do anything on ctrl+S, no action registered\");\r\n                        e.preventDefault();\r\n                        save._action();\r\n                    }\r\n                },\r\n\r\n                bind: function bind(action) {\r\n                    save._action = action;\r\n                    save._isbound = true;\r\n                    save._event = $window.addEventListener(\"keydown\", save.detectCtrlSAndExcecute, false);\r\n\r\n                },\r\n\r\n                unbind: function unbind() {\r\n                    $window.removeEventListener(\"keydown\", save.detectCtrlSAndExcecute);\r\n                    save._isbound = false;\r\n                },\r\n\r\n                // re-attach Ctrl+S if it had already been attached previously\r\n                rebind: function rebind() {\r\n                    if (save._action === null)\r\n                        throw \"can't rebind, as it was never initially bound\";\r\n                    if (!save._isbound)\r\n                        throw \"can't rebind, as it's still bound\";\r\n                    save.bind(save._action);\r\n                }\r\n            };\r\n\r\n            save.bind(action);\r\n\r\n            return save;\r\n        }\r\n\r\n        return createSave;\r\n    }]);\n/* shared debugState = advancedMode\r\n * \r\n * vm.debug -> shows if in debug mode - bind ng-ifs to this\r\n * vm.maybeEnableDebug - a method which checks for ctrl+shift-click and if yes, changes debug state\r\n *\r\n * How to use\r\n * 1. add uiDebug to your controller dependencies like:    contentImportController(appId, ..., debugState, $modalInstance, $filter)\r\n * 2. add a line after creating your vm-object like:       vm.debug = debugState;\r\n * 3. add a click event as far out as possible on html:    <div ng-click=\"vm.debug.autoEnableAsNeeded($event)\">\r\n * 4. wrap your hidden stuff in an ng-if:                  <div ng-if=\"vm.debug.on\">\r\n *\r\n * Note that if you're using it in a directive you'll use $scope instead of vm, so the binding is different.\r\n * For example, instead of <div ng-if=\"vm.debug.on\"> you would write <div ng-if=\"debug.on\">\r\n */\r\n\r\nangular.module(\"EavServices\")\r\n    .factory(\"debugState\", [\"$translate\", \"toastr\", function ($translate, toastr) {\r\n        var svc = {\r\n            on: false\r\n        };\r\n\r\n        svc.toggle = function toggle() {\r\n            svc.on = !svc.on;\r\n            toastr.clear(svc.toast);\r\n            svc.toast = toastr.info($translate.instant(\"AdvancedMode.Info.Turn\" + (svc.on ? \"On\" : \"Off\")), { timeOut: 3000 });\r\n        };\r\n\r\n        svc.autoEnableAsNeeded = function (e) {\r\n            e = window.event || e;\r\n            var ctrlPressed = (navigator.platform.match(\"Mac\") ? e.metaKey : e.ctrlKey);//evt.ctrlKey;\r\n            if (ctrlPressed && !e.alreadySwitchedDebugState) {\r\n                svc.toggle();\r\n                e.alreadySwitchedDebugState = true;\r\n            }\r\n        };\r\n\r\n        return svc;\r\n    }]);\n// This service adds CSS classes to body when something is dragged onto the page\r\nangular.module(\"EavServices\")\r\n    .factory(\"dragClass\", function () {\r\n\r\n        document.addEventListener(\"dragover\", function() {\r\n            if(this === document)\r\n                document.body.classList.add(\"eav-dragging\");\r\n        });\r\n        document.addEventListener(\"dragleave\", function() {\r\n            if(this === document)\r\n                document.body.classList.remove(\"eav-dragging\");\r\n        });\r\n\r\n        return {};\r\n\r\n    });\r\n\n/*  this file contains a service to handle \r\n * How it works\r\n * This service tries to open a modal dialog if it can, otherwise a new window returning a promise to allow\r\n * ...refresh when the window close. \r\n * \r\n * In most cases there is a nice command to open something, like openItemEditWithEntityId(id, callback)\r\n * ...and there is also a more advanced version where you could specify more closely what you wanted\r\n * ...usually ending with an X, so like openItemEditWithEntityIdX(resolve, callbacks)\r\n * \r\n * the simple callback is 1 function (usually to refresh the main list), the complex callbacks have the following structure\r\n * 1. .success (optional)\r\n * 2. .error (optional) \r\n * 3. .notify (optional)\r\n * 4. .close (optional) --> this one is attached to all events if no primary handler is defined \r\n *  \r\n * How to use\r\n * 1. you must already include all js files in your main app - so the controllers you'll need must be preloaded\r\n * 2. Your main app must also  declare the other apps as dependencies, so angular.module('yourname', ['dialog 1', 'diolag 2'])\r\n * 3. your main app must also need this ['EavAdminUI']\r\n * 4. your controller must require eavAdminDialogs\r\n * 5. Then you can call such a dialog\r\n */\r\n\r\n\r\n// Todo\r\n// 1. Import / Export\r\n// 2. Pipeline Designer\r\n\r\n// var contentItemsModule = $eavOnlyHelpers.urlParams.get(\"oldgrid\") ? \"ContentItemsApp\" : \"ContentItemsAppAgnostic\";\r\n\r\nangular.module(\"EavAdminUi\", [\"ng\",\r\n    \"ui.bootstrap\",         // for the $modal etc.\r\n    \"EavServices\",\r\n    \"eavTemplates\",         // Provides all cached templates\r\n    \"PermissionsApp\",       // Permissions dialogs to manage permissions\r\n    \"ContentItemsAppAgnostic\", // contentItemsModule,      // Content-items dialog - not working atm?\r\n    \"PipelineManagement\",   // Manage pipelines\r\n    \"ContentImportApp\",\r\n    \"ContentExportApp\",\r\n    \"HistoryApp\",            // the item-history app\r\n\t\"eavEditEntity\"\t\t\t// the edit-app\r\n])\r\n    .factory(\"eavAdminDialogs\", [\"$modal\", \"eavConfig\", \"$window\", \"entitiesSvc\", \"contentTypeSvc\", \"appId\", function ($modal, eavConfig, $window,\r\n        // these are needed just for simple access to some dialogs\r\n        entitiesSvc,\r\n        contentTypeSvc,\r\n        appId) {\r\n            /*jshint laxbreak:true */\r\n\r\n            var svc = {};\r\n\r\n            //#region List of Content Items dialogs\r\n            svc.openContentItems = function oci(appId, staticName, itemId, closeCallback) {\r\n            \tvar resolve = svc.CreateResolve({ appId: appId, contentType: staticName, contentTypeId: itemId });\r\n            \treturn svc.OpenModal(\"content-items/content-items-agnostic.html\", \"ContentItemsList as vm\", \"fullscreen\", resolve, closeCallback);\r\n            };\r\n            //#endregion\r\n\r\n            //#region content import export\r\n            svc.openContentImport = function ocimp(appId, staticName, closeCallback) {\r\n                var resolve = svc.CreateResolve({ appId: appId, contentType: staticName });\r\n                return svc.OpenModal(\"content-import-export/content-import.html\", \"ContentImport as vm\", \"lg\", resolve, closeCallback);\r\n            };\r\n\r\n            svc.openContentExport = function ocexp(appId, staticName, closeCallback) {\r\n                var resolve = svc.CreateResolve({ appId: appId, contentType: staticName });\r\n                return svc.OpenModal(\"content-import-export/content-export.html\", \"ContentExport as vm\", \"lg\", resolve, closeCallback);\r\n            };\r\n\r\n            //#endregion\r\n\r\n            //#region ContentType dialogs\r\n\r\n            svc.openContentTypeEdit = function octe(item, closeCallback) {\r\n                var resolve = svc.CreateResolve({ item: item });\r\n                return svc.OpenModal(\"content-types/content-types-edit.html\", \"Edit as vm\", \"\", resolve, closeCallback);\r\n            };\r\n\r\n            svc.openContentTypeFields = function octf(item, closeCallback) {\r\n                    var resolve = svc.CreateResolve({ contentType: item });\r\n                    return svc.OpenModal(\"content-types/content-types-fields.html\", \"FieldList as vm\", \"xlg\", resolve, closeCallback);\r\n            };\r\n\r\n            // this one assumes we have a content-item, but must first retrieve content-type-infos\r\n            svc.openContentTypeFieldsOfItems = function octf(item, closeCallback) {\r\n                return entitiesSvc.getManyForEditing(appId, item)\r\n                    .then(function(result) {\r\n                        var ctName = result.data[0].Header.ContentTypeName;\r\n                        var svcForThis = contentTypeSvc(appId); // note: won't specify scope to fallback\r\n                        return svcForThis.getDetails(ctName).then(function(result2) {\r\n                            return svc.openContentTypeFields(result2.data, closeCallback);\r\n                        });\r\n                    });\r\n            };\r\n\r\n\r\n            //#endregion\r\n        \r\n            //#region Item - new, edit\r\n            svc.openItemNew = function oin(contentTypeName, closeCallback) {\r\n                return svc.openEditItems([{ ContentTypeName: contentTypeName }], closeCallback);\r\n            };\r\n\r\n            svc.openItemEditWithEntityId = function oie(entityId, closeCallback) {\r\n                return svc.openEditItems([{ EntityId: entityId }], closeCallback);\r\n            };\r\n\r\n            svc.openEditItems = function oel(items, closeCallback) {\r\n                var resolve = svc.CreateResolve({ items: items });\r\n                return svc.OpenModal(\"form/main-form.html\", \"EditEntityWrapperCtrl as vm\", \"ent-edit\", resolve, closeCallback);\r\n            };\r\n\r\n            svc.openItemHistory = function ioh(entityId, closeCallback) {\r\n                return svc.OpenModal(\"content-items/history.html\", \"History as vm\", \"lg\",\r\n                    svc.CreateResolve({ entityId: entityId }),\r\n                    closeCallback);\r\n            };\r\n            //#endregion\r\n\r\n            //#region Metadata - mainly new\r\n            svc.openMetadataNew = function omdn(appId, targetType, targetId, metadataType, closeCallback) {\r\n                var metadata = {};\r\n                switch (targetType) {\r\n                    case \"entity\":\r\n                        metadata.Key = targetId;\r\n                        metadata.KeyType = \"guid\";\r\n                        metadata.TargetType = eavConfig.metadataOfEntity;\r\n                        break;\r\n                    case \"attribute\":\r\n                        metadata.Key = targetId;\r\n                        metadata.KeyType = \"number\";\r\n                        metadata.TargetType = eavConfig.metadataOfAttribute;\r\n                        break;\r\n                    default: throw \"targetType unknown, only accepts entity or attribute for now\";\r\n                }\r\n                var items = [{\r\n                    ContentTypeName: metadataType,\r\n                    Metadata: metadata\r\n                }];\r\n\r\n                svc.openEditItems(items, closeCallback);\r\n            };\r\n            //#endregion\r\n\r\n            //#region Permissions Dialog\r\n            svc.openPermissionsForGuid = function opfg(appId, targetGuid, closeCallback) {\r\n                var resolve = svc.CreateResolve({ appId: appId, targetGuid: targetGuid });\r\n                return svc.OpenModal(\"permissions/permissions.html\", \"PermissionList as vm\", \"lg\", resolve, closeCallback);\r\n            };\r\n            //#endregion\r\n\r\n            //#region Pipeline Designer\r\n            svc.editPipeline = function ep(appId, pipelineId, closeCallback) {\r\n                var url = svc.derivedUrl({\r\n                    dialog: \"pipeline-designer\",\r\n                    pipelineId: pipelineId\r\n                });\r\n                $window.open(url);\r\n                return;\r\n            };\r\n            //#endregion\r\n\r\n        //#region GenerateUrlBasedOnCurrent\r\n            svc.derivedUrl = function derivedUrl(varsToReplace) {\r\n                var url = window.location.href;\r\n                for (var prop in varsToReplace)\r\n                    if (varsToReplace.hasOwnProperty(prop))\r\n                        url = svc.replaceOrAddOneParam(url, prop, varsToReplace[prop]);\r\n\r\n                return url;\r\n                //url = url\r\n                //    .replace(new RegExp(\"appid=[0-9]*\", \"i\"), \"appid=\" + item.Id) // note: sometimes it doesn't have an appid, so it's [0-9]* instead of [0-9]+\r\n                //    .replace(/approot=[^&]*/, \"approot=\" + item.AppRoot + \"/\")\r\n                //    .replace(\"dialog=zone\", \"dialog=app\");\r\n            };\r\n\r\n            svc.replaceOrAddOneParam = function replaceOneParam(original, param, value) {\r\n                var rule = new RegExp(\"(\" + param + \"=).*?(&)\", \"i\");\r\n                var newText = rule.test(original)\r\n                    ? original.replace(rule, \"$1\" + value + \"$2\")\r\n                    : original + \"&\" + param + \"=\" + value;\r\n                return newText;\r\n            };\r\n        //#endregion\r\n\r\n\r\n        //#region Internal helpers\r\n            svc._attachCallbacks = function attachCallbacks(promise, callbacks) {\r\n                if (typeof (callbacks) === \"undefined\")\r\n                    return;\r\n                if (typeof (callbacks) === \"function\") // if it's only one callback, use it for all close-cases\r\n                    callbacks = { close: callbacks };\r\n                return promise.result.then(callbacks.success || callbacks.close, callbacks.error || callbacks.close, callbacks.notify || callbacks.close);\r\n            };\r\n\r\n        // Will open a modal window. Has various specials, like\r\n        // 1. If the templateUrl begins with \"~/\" - this will be re-mapped to the ng-app root. Only use this for not-inline stuff\r\n        // 2. The controller can be written as \"something as vm\" and this will be split and configured corectly\r\n            svc.OpenModal = function openModal(templateUrl, controller, size, resolveValues, callbacks) {\r\n                var foundAs = controller.indexOf(\" as \");\r\n                var contAs = foundAs > 0 ?\r\n                    controller.substring(foundAs + 4)\r\n                    : null;\r\n                if (foundAs > 0)\r\n                    controller = controller.substring(0, foundAs);\r\n\r\n                var modalInstance = $modal.open({\r\n                    animation: true,\r\n                    templateUrl: templateUrl,\r\n                    controller: controller,\r\n                    controllerAs: contAs,\r\n                    size: size,\r\n                    resolve: resolveValues\r\n                });\r\n\r\n                return svc._attachCallbacks(modalInstance, callbacks);\r\n            };\r\n\r\n        /// This will create a resolve-object containing return function()... for each property in the array\r\n            svc.CreateResolve = function createResolve() {\r\n                var fns = {}, list = arguments[0];\r\n                for (var prop in list) \r\n                    if (list.hasOwnProperty(prop))\r\n                        fns[prop] = svc._create1Resolve(list[prop]);\r\n                return fns;\r\n            };\r\n\r\n            svc._create1Resolve = function (value) {\r\n                return function () { return value; };\r\n            };\r\n        //#endregion\r\n\r\n\r\n        return svc;\r\n    }])\r\n\r\n;\n/*  this file contains various eav-angular services\r\n *  1. the basic configuration enforcing html5 mode\r\n */\r\n\r\nangular.module(\"eavNgSvcs\", [\"ng\"])\r\n\r\n    /// Config to ensure that $location can work and give url-parameters\r\n    .config([\"$locationProvider\", function ($locationProvider) {\r\n            $locationProvider.html5Mode({\r\n                enabled: true,\r\n                requireBase: false\r\n            });\r\n        } ])\r\n\r\n\r\n;\r\n\n\r\n/* File Type Services\r\n * Helps check if something is an image (then the UI usually wants a thumbnail)\r\n * ...or if it has an icon in the font-library - then it can provide the class name for the icon\r\n */\r\nangular.module(\"EavServices\").service(\"fileType\", function () {\r\n    var svc = {};\r\n    svc.iconPrefix = \"icon-\";\r\n    svc.defaultIcon = \"file\";\r\n    svc.checkImgRegEx = /(?:([^:\\/?#]+):)?(?:\\/\\/([^\\/?#]*))?([^?#]*\\.(?:jpg|jpeg|gif|png))(?:\\?([^#]*))?(?:#(.*))?/i;\r\n    svc.extensions = {\r\n        doc: \"file-word\",\r\n        docx: \"file-word\",\r\n        xls: \"file-excel\",\r\n        xlsx: \"file-excel\",\r\n        ppt: \"file-powerpoint\",\r\n        pptx: \"file-powerpoint\",\r\n        pdf: \"file-pdf\",\r\n        mp3: \"file-audio\",\r\n        avi: \"file-video\",\r\n        mpg: \"file-video\",\r\n        mpeg: \"file-video\",\r\n        mov: \"file-video\",\r\n        mp4: \"file-video\",\r\n        zip: \"file-archive\",\r\n        rar: \"file-archive\",\r\n        txt: \"file-text\",\r\n        html: \"file-code\",\r\n        css: \"file-code\",\r\n        xml: \"file-code\",\r\n        xsl: \"file-code\",\r\n        vcf: \"user\"\r\n    };\r\n\r\n    svc.getExtension = function(filename) {\r\n        return filename.substr(filename.lastIndexOf(\".\") + 1).toLowerCase();\r\n    };\r\n\r\n    svc.getIconClass = function getClass(filename) {\r\n        return svc.iconPrefix + (svc.extensions[svc.getExtension(filename)] || svc.defaultIcon);\r\n    };\r\n    \r\n    svc.isKnownType = function(filename) {\r\n        return svc.extensions.indexOf[svc.getExtension(filename)] !== -1;\r\n    };\r\n\r\n    svc.isImage = function(filename) {\r\n        return svc.checkImgRegEx.test(filename);\r\n    };\r\n\r\n    // not used yet, so commented out\r\n    //svc.type = function(url) {\r\n    //    if (svc.isImage(url))\r\n    //        return \"image\";\r\n    //    return \"file\";\r\n    //};\r\n\r\n    return svc;\r\n});\n\r\nangular.module(\"EavServices\")\r\n    .factory(\"historySvc\", [\"$http\", \"svcCreator\", function($http, svcCreator) { \r\n        //var eavConf = eavConfig;\r\n\r\n        // Construct a service for this specific targetGuid\r\n        return function createSvc(appId, entityId) {\r\n            var svc = {\r\n                appId: appId,\r\n                entityId: entityId\r\n            };\r\n\r\n            // When we get the list, reverse-number the results to give it a nice version number\r\n            svc = angular.extend(svc, svcCreator.implementLiveList(function getAll() {\r\n                return $http.get(\"eav/entities/history\", { params: { \"appId\": svc.appId, \"entityId\": svc.entityId } })\r\n                .then(function(result) {\r\n                    var list = result.data;\r\n                        for (var i = 0; i < list.length; i++)\r\n                            list[i].VirtualVersion = list.length - i;\r\n                        return result;\r\n                    });\r\n            }));\r\n\r\n            svc.getVersionDetails = function getVersionDetails(changeId) {\r\n                return $http.get(\"eav/entities/historydetails\", { params: { \"appId\": svc.appId, \"entityId\": svc.entityId, \"changeId\": changeId } });\r\n            };\r\n\r\n            return svc;\r\n        };\r\n    }]);\n/* The main component for language inclusion\r\n * Ensure the dependencies work, that the url-schema is prepared etc.\r\n * \r\n */\r\n\r\n(function () {\r\n    angular.module(\"EavServices\")\r\n        .config([\"$translateProvider\", \"languages\", \"$translatePartialLoaderProvider\", function($translateProvider, languages, $translatePartialLoaderProvider) {\r\n            $translateProvider\r\n                .preferredLanguage(languages.currentLanguage.split(\"-\")[0])\r\n                .useSanitizeValueStrategy(\"escapeParameters\") // this is very important to allow html in the JSON files\r\n                .fallbackLanguage(languages.fallbackLanguage)\r\n                .useLoader(\"$translatePartialLoader\", {\r\n                    urlTemplate: languages.i18nRoot + \"{part}-{lang}.js\"\r\n                })\r\n                .useLoaderCache(true); // should cache json\r\n            $translatePartialLoaderProvider // these parts are always required\r\n                .addPart(\"admin\")\r\n                .addPart(\"edit\");\r\n        }])\r\n\r\n        // ensure that adding parts will load the missing files\r\n        .run([\"$rootScope\", \"$translate\", function($rootScope, $translate) {\r\n            $rootScope.$on(\"$translatePartialLoaderStructureChanged\", function() {\r\n                $translate.refresh();\r\n            });\r\n        }]);\r\n})();\n// By default, eav-controls assume that all their parameters (appId, etc.) are instantiated by the bootstrapper\r\n// but the \"root\" component must get it from the url\r\n// Since different objects could be the root object (this depends on the initial loader), the root-one must have\r\n// a connection to the Url, but only when it is the root\r\n// So the trick is to just include this file - which will provide values for the important attribute\r\n//\r\n// As of now, it only supplies\r\n// * appId\r\n(function () {\r\n    angular.module(\"InitParametersFromUrl\", [])\r\n        //#region properties\r\n        .factory(\"appId\", function () {\r\n            return getParameterByName(\"appId\");\r\n        })\r\n        .factory(\"zoneId\", function () {\r\n            return getParameterByName(\"zoneId\");\r\n        })\r\n        .factory(\"entityId\", function () {\r\n            return getParameterByName(\"entityid\");\r\n        })\r\n        .factory(\"contentTypeName\", function () {\r\n            return getParameterByName(\"contenttypename\");\r\n        })\r\n\r\n        .factory(\"pipelineId\", function () {\r\n            return getParameterByName(\"pipelineId\");\r\n        })\r\n        .factory(\"dialog\", function () {\r\n            return getParameterByName(\"dialog\");\r\n        })\r\n        //#endregion\r\n        //#region helpers / dummy objects\r\n        // This is a dummy object, because it's needed for dialogs\r\n        .factory(\"$modalInstance\", function () {\r\n            return null;\r\n        })\r\n    //#endregion\r\n    ;\r\n\r\n    function getParameterByName(name) {\r\n        if (window.$2sxc)\r\n            return window.$2sxc.urlParams.get(name);\r\n        return getParameterByNameDuplicate(name);\r\n    }\r\n\r\n    // this is a duplicate fn of the 2sxc-version, should only be used if 2sxc doesn't exist\r\n    function getParameterByNameDuplicate(name) {\r\n        name = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\r\n        var searchRx = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\", \"i\");\r\n        var results = searchRx.exec(location.search);\r\n\r\n        if (results === null) {\r\n            var hashRx = new RegExp(\"[#&]\" + name + \"=([^&#]*)\", \"i\");\r\n            results = hashRx.exec(location.hash);\r\n        }\r\n\r\n        // if nothing found, try normal URL because DNN places parameters in /key/value notation\r\n        if (results === null) {\r\n            // Otherwise try parts of the URL\r\n            var matches = window.location.pathname.match(new RegExp(\"/\" + name + \"/([^/]+)\", \"i\"));\r\n\r\n            // Check if we found anything, if we do find it, we must reverse the results so we get the \"last\" one in case there are multiple hits\r\n            if (matches !== null && matches.length > 1)\r\n                results = matches.reverse()[0];\r\n        } else\r\n            results = results[1];\r\n\r\n        return results === null ? \"\" : decodeURIComponent(results.replace(/\\+/g, \" \"));\r\n    }\r\n}());\n/*\r\n * Cleans up all kinds of texts containing non-latin characters like umlauts or romanian characters etc.\r\n * \r\n * based on http://stackoverflow.com/questions/286921/efficiently-replace-all-accented-characters-in-a-string\r\n * \r\n */\r\n\r\nangular.module(\"EavServices\")\r\n    .factory(\"latinizeText\", function() {\r\n        return function(input) {\r\n            var latinMap = { \"Á\": \"A\", \"Ă\": \"A\", \"Ắ\": \"A\", \"Ặ\": \"A\", \"Ằ\": \"A\", \"Ẳ\": \"A\", \"Ẵ\": \"A\", \"Ǎ\": \"A\", \"Â\": \"A\", \"Ấ\": \"A\", \"Ậ\": \"A\", \"Ầ\": \"A\", \"Ẩ\": \"A\", \"Ẫ\": \"A\", \"Ä\": \"Ae\", \"Ǟ\": \"A\", \"Ȧ\": \"A\", \"Ǡ\": \"A\", \"Ạ\": \"A\", \"Ȁ\": \"A\", \"À\": \"A\", \"Ả\": \"A\", \"Ȃ\": \"A\", \"Ā\": \"A\", \"Ą\": \"A\", \"Å\": \"A\", \"Ǻ\": \"A\", \"Ḁ\": \"A\", \"Ⱥ\": \"A\", \"Ã\": \"A\", \"Ꜳ\": \"AA\", \"Æ\": \"AE\", \"Ǽ\": \"AE\", \"Ǣ\": \"AE\", \"Ꜵ\": \"AO\", \"Ꜷ\": \"AU\", \"Ꜹ\": \"AV\", \"Ꜻ\": \"AV\", \"Ꜽ\": \"AY\", \"Ḃ\": \"B\", \"Ḅ\": \"B\", \"Ɓ\": \"B\", \"Ḇ\": \"B\", \"Ƀ\": \"B\", \"Ƃ\": \"B\", \"Ć\": \"C\", \"Č\": \"C\", \"Ç\": \"C\", \"Ḉ\": \"C\", \"Ĉ\": \"C\", \"Ċ\": \"C\", \"Ƈ\": \"C\", \"Ȼ\": \"C\", \"Ď\": \"D\", \"Ḑ\": \"D\", \"Ḓ\": \"D\", \"Ḋ\": \"D\", \"Ḍ\": \"D\", \"Ɗ\": \"D\", \"Ḏ\": \"D\", \"ǲ\": \"D\", \"ǅ\": \"D\", \"Đ\": \"D\", \"Ƌ\": \"D\", \"Ǳ\": \"DZ\", \"Ǆ\": \"DZ\", \"É\": \"E\", \"Ĕ\": \"E\", \"Ě\": \"E\", \"Ȩ\": \"E\", \"Ḝ\": \"E\", \"Ê\": \"E\", \"Ế\": \"E\", \"Ệ\": \"E\", \"Ề\": \"E\", \"Ể\": \"E\", \"Ễ\": \"E\", \"Ḙ\": \"E\", \"Ë\": \"E\", \"Ė\": \"E\", \"Ẹ\": \"E\", \"Ȅ\": \"E\", \"È\": \"E\", \"Ẻ\": \"E\", \"Ȇ\": \"E\", \"Ē\": \"E\", \"Ḗ\": \"E\", \"Ḕ\": \"E\", \"Ę\": \"E\", \"Ɇ\": \"E\", \"Ẽ\": \"E\", \"Ḛ\": \"E\", \"Ꝫ\": \"ET\", \"Ḟ\": \"F\", \"Ƒ\": \"F\", \"Ǵ\": \"G\", \"Ğ\": \"G\", \"Ǧ\": \"G\", \"Ģ\": \"G\", \"Ĝ\": \"G\", \"Ġ\": \"G\", \"Ɠ\": \"G\", \"Ḡ\": \"G\", \"Ǥ\": \"G\", \"Ḫ\": \"H\", \"Ȟ\": \"H\", \"Ḩ\": \"H\", \"Ĥ\": \"H\", \"Ⱨ\": \"H\", \"Ḧ\": \"H\", \"Ḣ\": \"H\", \"Ḥ\": \"H\", \"Ħ\": \"H\", \"Í\": \"I\", \"Ĭ\": \"I\", \"Ǐ\": \"I\", \"Î\": \"I\", \"Ï\": \"I\", \"Ḯ\": \"I\", \"İ\": \"I\", \"Ị\": \"I\", \"Ȉ\": \"I\", \"Ì\": \"I\", \"Ỉ\": \"I\", \"Ȋ\": \"I\", \"Ī\": \"I\", \"Į\": \"I\", \"Ɨ\": \"I\", \"Ĩ\": \"I\", \"Ḭ\": \"I\", \"Ꝺ\": \"D\", \"Ꝼ\": \"F\", \"Ᵹ\": \"G\", \"Ꞃ\": \"R\", \"Ꞅ\": \"S\", \"Ꞇ\": \"T\", \"Ꝭ\": \"IS\", \"Ĵ\": \"J\", \"Ɉ\": \"J\", \"Ḱ\": \"K\", \"Ǩ\": \"K\", \"Ķ\": \"K\", \"Ⱪ\": \"K\", \"Ꝃ\": \"K\", \"Ḳ\": \"K\", \"Ƙ\": \"K\", \"Ḵ\": \"K\", \"Ꝁ\": \"K\", \"Ꝅ\": \"K\", \"Ĺ\": \"L\", \"Ƚ\": \"L\", \"Ľ\": \"L\", \"Ļ\": \"L\", \"Ḽ\": \"L\", \"Ḷ\": \"L\", \"Ḹ\": \"L\", \"Ⱡ\": \"L\", \"Ꝉ\": \"L\", \"Ḻ\": \"L\", \"Ŀ\": \"L\", \"Ɫ\": \"L\", \"ǈ\": \"L\", \"Ł\": \"L\", \"Ǉ\": \"LJ\", \"Ḿ\": \"M\", \"Ṁ\": \"M\", \"Ṃ\": \"M\", \"Ɱ\": \"M\", \"Ń\": \"N\", \"Ň\": \"N\", \"Ņ\": \"N\", \"Ṋ\": \"N\", \"Ṅ\": \"N\", \"Ṇ\": \"N\", \"Ǹ\": \"N\", \"Ɲ\": \"N\", \"Ṉ\": \"N\", \"Ƞ\": \"N\", \"ǋ\": \"N\", \"Ñ\": \"N\", \"Ǌ\": \"NJ\", \"Ó\": \"O\", \"Ŏ\": \"O\", \"Ǒ\": \"O\", \"Ô\": \"O\", \"Ố\": \"O\", \"Ộ\": \"O\", \"Ồ\": \"O\", \"Ổ\": \"O\", \"Ỗ\": \"O\", \"Öe\": \"O\", \"Ȫ\": \"O\", \"Ȯ\": \"O\", \"Ȱ\": \"O\", \"Ọ\": \"O\", \"Ő\": \"O\", \"Ȍ\": \"O\", \"Ò\": \"O\", \"Ỏ\": \"O\", \"Ơ\": \"O\", \"Ớ\": \"O\", \"Ợ\": \"O\", \"Ờ\": \"O\", \"Ở\": \"O\", \"Ỡ\": \"O\", \"Ȏ\": \"O\", \"Ꝋ\": \"O\", \"Ꝍ\": \"O\", \"Ō\": \"O\", \"Ṓ\": \"O\", \"Ṑ\": \"O\", \"Ɵ\": \"O\", \"Ǫ\": \"O\", \"Ǭ\": \"O\", \"Ø\": \"O\", \"Ǿ\": \"O\", \"Õ\": \"O\", \"Ṍ\": \"O\", \"Ṏ\": \"O\", \"Ȭ\": \"O\", \"Ƣ\": \"OI\", \"Ꝏ\": \"OO\", \"Ɛ\": \"E\", \"Ɔ\": \"O\", \"Ȣ\": \"OU\", \"Ṕ\": \"P\", \"Ṗ\": \"P\", \"Ꝓ\": \"P\", \"Ƥ\": \"P\", \"Ꝕ\": \"P\", \"Ᵽ\": \"P\", \"Ꝑ\": \"P\", \"Ꝙ\": \"Q\", \"Ꝗ\": \"Q\", \"Ŕ\": \"R\", \"Ř\": \"R\", \"Ŗ\": \"R\", \"Ṙ\": \"R\", \"Ṛ\": \"R\", \"Ṝ\": \"R\", \"Ȑ\": \"R\", \"Ȓ\": \"R\", \"Ṟ\": \"R\", \"Ɍ\": \"R\", \"Ɽ\": \"R\", \"Ꜿ\": \"C\", \"Ǝ\": \"E\", \"Ś\": \"S\", \"Ṥ\": \"S\", \"Š\": \"S\", \"Ṧ\": \"S\", \"Ş\": \"S\", \"Ŝ\": \"S\", \"Ș\": \"S\", \"Ṡ\": \"S\", \"Ṣ\": \"S\", \"Ṩ\": \"S\", \"Ť\": \"T\", \"Ţ\": \"T\", \"Ṱ\": \"T\", \"Ț\": \"T\", \"Ⱦ\": \"T\", \"Ṫ\": \"T\", \"Ṭ\": \"T\", \"Ƭ\": \"T\", \"Ṯ\": \"T\", \"Ʈ\": \"T\", \"Ŧ\": \"T\", \"Ɐ\": \"A\", \"Ꞁ\": \"L\", \"Ɯ\": \"M\", \"Ʌ\": \"V\", \"Ꜩ\": \"TZ\", \"Ú\": \"U\", \"Ŭ\": \"U\", \"Ǔ\": \"U\", \"Û\": \"U\", \"Ṷ\": \"U\", \"Ü\": \"Ue\", \"Ǘ\": \"U\", \"Ǚ\": \"U\", \"Ǜ\": \"U\", \"Ǖ\": \"U\", \"Ṳ\": \"U\", \"Ụ\": \"U\", \"Ű\": \"U\", \"Ȕ\": \"U\", \"Ù\": \"U\", \"Ủ\": \"U\", \"Ư\": \"U\", \"Ứ\": \"U\", \"Ự\": \"U\", \"Ừ\": \"U\", \"Ử\": \"U\", \"Ữ\": \"U\", \"Ȗ\": \"U\", \"Ū\": \"U\", \"Ṻ\": \"U\", \"Ų\": \"U\", \"Ů\": \"U\", \"Ũ\": \"U\", \"Ṹ\": \"U\", \"Ṵ\": \"U\", \"Ꝟ\": \"V\", \"Ṿ\": \"V\", \"Ʋ\": \"V\", \"Ṽ\": \"V\", \"Ꝡ\": \"VY\", \"Ẃ\": \"W\", \"Ŵ\": \"W\", \"Ẅ\": \"W\", \"Ẇ\": \"W\", \"Ẉ\": \"W\", \"Ẁ\": \"W\", \"Ⱳ\": \"W\", \"Ẍ\": \"X\", \"Ẋ\": \"X\", \"Ý\": \"Y\", \"Ŷ\": \"Y\", \"Ÿ\": \"Y\", \"Ẏ\": \"Y\", \"Ỵ\": \"Y\", \"Ỳ\": \"Y\", \"Ƴ\": \"Y\", \"Ỷ\": \"Y\", \"Ỿ\": \"Y\", \"Ȳ\": \"Y\", \"Ɏ\": \"Y\", \"Ỹ\": \"Y\", \"Ź\": \"Z\", \"Ž\": \"Z\", \"Ẑ\": \"Z\", \"Ⱬ\": \"Z\", \"Ż\": \"Z\", \"Ẓ\": \"Z\", \"Ȥ\": \"Z\", \"Ẕ\": \"Z\", \"Ƶ\": \"Z\", \"Ĳ\": \"IJ\", \"Œ\": \"OE\", \"ᴀ\": \"A\", \"ᴁ\": \"AE\", \"ʙ\": \"B\", \"ᴃ\": \"B\", \"ᴄ\": \"C\", \"ᴅ\": \"D\", \"ᴇ\": \"E\", \"ꜰ\": \"F\", \"ɢ\": \"G\", \"ʛ\": \"G\", \"ʜ\": \"H\", \"ɪ\": \"I\", \"ʁ\": \"R\", \"ᴊ\": \"J\", \"ᴋ\": \"K\", \"ʟ\": \"L\", \"ᴌ\": \"L\", \"ᴍ\": \"M\", \"ɴ\": \"N\", \"ᴏ\": \"O\", \"ɶ\": \"OE\", \"ᴐ\": \"O\", \"ᴕ\": \"OU\", \"ᴘ\": \"P\", \"ʀ\": \"R\", \"ᴎ\": \"N\", \"ᴙ\": \"R\", \"ꜱ\": \"S\", \"ᴛ\": \"T\", \"ⱻ\": \"E\", \"ᴚ\": \"R\", \"ᴜ\": \"U\", \"ᴠ\": \"V\", \"ᴡ\": \"W\", \"ʏ\": \"Y\", \"ᴢ\": \"Z\", \"á\": \"a\", \"ă\": \"a\", \"ắ\": \"a\", \"ặ\": \"a\", \"ằ\": \"a\", \"ẳ\": \"a\", \"ẵ\": \"a\", \"ǎ\": \"a\", \"â\": \"a\", \"ấ\": \"a\", \"ậ\": \"a\", \"ầ\": \"a\", \"ẩ\": \"a\", \"ẫ\": \"a\", \"ä\": \"ae\", \"ǟ\": \"a\", \"ȧ\": \"a\", \"ǡ\": \"a\", \"ạ\": \"a\", \"ȁ\": \"a\", \"à\": \"a\", \"ả\": \"a\", \"ȃ\": \"a\", \"ā\": \"a\", \"ą\": \"a\", \"ᶏ\": \"a\", \"ẚ\": \"a\", \"å\": \"a\", \"ǻ\": \"a\", \"ḁ\": \"a\", \"ⱥ\": \"a\", \"ã\": \"a\", \"ꜳ\": \"aa\", \"æ\": \"ae\", \"ǽ\": \"ae\", \"ǣ\": \"ae\", \"ꜵ\": \"ao\", \"ꜷ\": \"au\", \"ꜹ\": \"av\", \"ꜻ\": \"av\", \"ꜽ\": \"ay\", \"ḃ\": \"b\", \"ḅ\": \"b\", \"ɓ\": \"b\", \"ḇ\": \"b\", \"ᵬ\": \"b\", \"ᶀ\": \"b\", \"ƀ\": \"b\", \"ƃ\": \"b\", \"ɵ\": \"o\", \"ć\": \"c\", \"č\": \"c\", \"ç\": \"c\", \"ḉ\": \"c\", \"ĉ\": \"c\", \"ɕ\": \"c\", \"ċ\": \"c\", \"ƈ\": \"c\", \"ȼ\": \"c\", \"ď\": \"d\", \"ḑ\": \"d\", \"ḓ\": \"d\", \"ȡ\": \"d\", \"ḋ\": \"d\", \"ḍ\": \"d\", \"ɗ\": \"d\", \"ᶑ\": \"d\", \"ḏ\": \"d\", \"ᵭ\": \"d\", \"ᶁ\": \"d\", \"đ\": \"d\", \"ɖ\": \"d\", \"ƌ\": \"d\", \"ı\": \"i\", \"ȷ\": \"j\", \"ɟ\": \"j\", \"ʄ\": \"j\", \"ǳ\": \"dz\", \"ǆ\": \"dz\", \"é\": \"e\", \"ĕ\": \"e\", \"ě\": \"e\", \"ȩ\": \"e\", \"ḝ\": \"e\", \"ê\": \"e\", \"ế\": \"e\", \"ệ\": \"e\", \"ề\": \"e\", \"ể\": \"e\", \"ễ\": \"e\", \"ḙ\": \"e\", \"ë\": \"e\", \"ė\": \"e\", \"ẹ\": \"e\", \"ȅ\": \"e\", \"è\": \"e\", \"ẻ\": \"e\", \"ȇ\": \"e\", \"ē\": \"e\", \"ḗ\": \"e\", \"ḕ\": \"e\", \"ⱸ\": \"e\", \"ę\": \"e\", \"ᶒ\": \"e\", \"ɇ\": \"e\", \"ẽ\": \"e\", \"ḛ\": \"e\", \"ꝫ\": \"et\", \"ḟ\": \"f\", \"ƒ\": \"f\", \"ᵮ\": \"f\", \"ᶂ\": \"f\", \"ǵ\": \"g\", \"ğ\": \"g\", \"ǧ\": \"g\", \"ģ\": \"g\", \"ĝ\": \"g\", \"ġ\": \"g\", \"ɠ\": \"g\", \"ḡ\": \"g\", \"ᶃ\": \"g\", \"ǥ\": \"g\", \"ḫ\": \"h\", \"ȟ\": \"h\", \"ḩ\": \"h\", \"ĥ\": \"h\", \"ⱨ\": \"h\", \"ḧ\": \"h\", \"ḣ\": \"h\", \"ḥ\": \"h\", \"ɦ\": \"h\", \"ẖ\": \"h\", \"ħ\": \"h\", \"ƕ\": \"hv\", \"í\": \"i\", \"ĭ\": \"i\", \"ǐ\": \"i\", \"î\": \"i\", \"ï\": \"i\", \"ḯ\": \"i\", \"ị\": \"i\", \"ȉ\": \"i\", \"ì\": \"i\", \"ỉ\": \"i\", \"ȋ\": \"i\", \"ī\": \"i\", \"į\": \"i\", \"ᶖ\": \"i\", \"ɨ\": \"i\", \"ĩ\": \"i\", \"ḭ\": \"i\", \"ꝺ\": \"d\", \"ꝼ\": \"f\", \"ᵹ\": \"g\", \"ꞃ\": \"r\", \"ꞅ\": \"s\", \"ꞇ\": \"t\", \"ꝭ\": \"is\", \"ǰ\": \"j\", \"ĵ\": \"j\", \"ʝ\": \"j\", \"ɉ\": \"j\", \"ḱ\": \"k\", \"ǩ\": \"k\", \"ķ\": \"k\", \"ⱪ\": \"k\", \"ꝃ\": \"k\", \"ḳ\": \"k\", \"ƙ\": \"k\", \"ḵ\": \"k\", \"ᶄ\": \"k\", \"ꝁ\": \"k\", \"ꝅ\": \"k\", \"ĺ\": \"l\", \"ƚ\": \"l\", \"ɬ\": \"l\", \"ľ\": \"l\", \"ļ\": \"l\", \"ḽ\": \"l\", \"ȴ\": \"l\", \"ḷ\": \"l\", \"ḹ\": \"l\", \"ⱡ\": \"l\", \"ꝉ\": \"l\", \"ḻ\": \"l\", \"ŀ\": \"l\", \"ɫ\": \"l\", \"ᶅ\": \"l\", \"ɭ\": \"l\", \"ł\": \"l\", \"ǉ\": \"lj\", \"ſ\": \"s\", \"ẜ\": \"s\", \"ẛ\": \"s\", \"ẝ\": \"s\", \"ḿ\": \"m\", \"ṁ\": \"m\", \"ṃ\": \"m\", \"ɱ\": \"m\", \"ᵯ\": \"m\", \"ᶆ\": \"m\", \"ń\": \"n\", \"ň\": \"n\", \"ņ\": \"n\", \"ṋ\": \"n\", \"ȵ\": \"n\", \"ṅ\": \"n\", \"ṇ\": \"n\", \"ǹ\": \"n\", \"ɲ\": \"n\", \"ṉ\": \"n\", \"ƞ\": \"n\", \"ᵰ\": \"n\", \"ᶇ\": \"n\", \"ɳ\": \"n\", \"ñ\": \"n\", \"ǌ\": \"nj\", \"ó\": \"o\", \"ŏ\": \"o\", \"ǒ\": \"o\", \"ô\": \"o\", \"ố\": \"o\", \"ộ\": \"o\", \"ồ\": \"o\", \"ổ\": \"o\", \"ỗ\": \"o\", \"ö\": \"oe\", \"ȫ\": \"o\", \"ȯ\": \"o\", \"ȱ\": \"o\", \"ọ\": \"o\", \"ő\": \"o\", \"ȍ\": \"o\", \"ò\": \"o\", \"ỏ\": \"o\", \"ơ\": \"o\", \"ớ\": \"o\", \"ợ\": \"o\", \"ờ\": \"o\", \"ở\": \"o\", \"ỡ\": \"o\", \"ȏ\": \"o\", \"ꝋ\": \"o\", \"ꝍ\": \"o\", \"ⱺ\": \"o\", \"ō\": \"o\", \"ṓ\": \"o\", \"ṑ\": \"o\", \"ǫ\": \"o\", \"ǭ\": \"o\", \"ø\": \"o\", \"ǿ\": \"o\", \"õ\": \"o\", \"ṍ\": \"o\", \"ṏ\": \"o\", \"ȭ\": \"o\", \"ƣ\": \"oi\", \"ꝏ\": \"oo\", \"ɛ\": \"e\", \"ᶓ\": \"e\", \"ɔ\": \"o\", \"ᶗ\": \"o\", \"ȣ\": \"ou\", \"ṕ\": \"p\", \"ṗ\": \"p\", \"ꝓ\": \"p\", \"ƥ\": \"p\", \"ᵱ\": \"p\", \"ᶈ\": \"p\", \"ꝕ\": \"p\", \"ᵽ\": \"p\", \"ꝑ\": \"p\", \"ꝙ\": \"q\", \"ʠ\": \"q\", \"ɋ\": \"q\", \"ꝗ\": \"q\", \"ŕ\": \"r\", \"ř\": \"r\", \"ŗ\": \"r\", \"ṙ\": \"r\", \"ṛ\": \"r\", \"ṝ\": \"r\", \"ȑ\": \"r\", \"ɾ\": \"r\", \"ᵳ\": \"r\", \"ȓ\": \"r\", \"ṟ\": \"r\", \"ɼ\": \"r\", \"ᵲ\": \"r\", \"ᶉ\": \"r\", \"ɍ\": \"r\", \"ɽ\": \"r\", \"ↄ\": \"c\", \"ꜿ\": \"c\", \"ɘ\": \"e\", \"ɿ\": \"r\", \"ß\": \"ss\", \"ś\": \"s\", \"ṥ\": \"s\", \"š\": \"s\", \"ṧ\": \"s\", \"ş\": \"s\", \"ŝ\": \"s\", \"ș\": \"s\", \"ṡ\": \"s\", \"ṣ\": \"s\", \"ṩ\": \"s\", \"ʂ\": \"s\", \"ᵴ\": \"s\", \"ᶊ\": \"s\", \"ȿ\": \"s\", \"ɡ\": \"g\", \"ᴑ\": \"o\", \"ᴓ\": \"o\", \"ᴝ\": \"u\", \"ť\": \"t\", \"ţ\": \"t\", \"ṱ\": \"t\", \"ț\": \"t\", \"ȶ\": \"t\", \"ẗ\": \"t\", \"ⱦ\": \"t\", \"ṫ\": \"t\", \"ṭ\": \"t\", \"ƭ\": \"t\", \"ṯ\": \"t\", \"ᵵ\": \"t\", \"ƫ\": \"t\", \"ʈ\": \"t\", \"ŧ\": \"t\", \"ᵺ\": \"th\", \"ɐ\": \"a\", \"ᴂ\": \"ae\", \"ǝ\": \"e\", \"ᵷ\": \"g\", \"ɥ\": \"h\", \"ʮ\": \"h\", \"ʯ\": \"h\", \"ᴉ\": \"i\", \"ʞ\": \"k\", \"ꞁ\": \"l\", \"ɯ\": \"m\", \"ɰ\": \"m\", \"ᴔ\": \"oe\", \"ɹ\": \"r\", \"ɻ\": \"r\", \"ɺ\": \"r\", \"ⱹ\": \"r\", \"ʇ\": \"t\", \"ʌ\": \"v\", \"ʍ\": \"w\", \"ʎ\": \"y\", \"ꜩ\": \"tz\", \"ú\": \"u\", \"ŭ\": \"u\", \"ǔ\": \"u\", \"û\": \"u\", \"ṷ\": \"u\", \"ü\": \"ue\", \"ǘ\": \"u\", \"ǚ\": \"u\", \"ǜ\": \"u\", \"ǖ\": \"u\", \"ṳ\": \"u\", \"ụ\": \"u\", \"ű\": \"u\", \"ȕ\": \"u\", \"ù\": \"u\", \"ủ\": \"u\", \"ư\": \"u\", \"ứ\": \"u\", \"ự\": \"u\", \"ừ\": \"u\", \"ử\": \"u\", \"ữ\": \"u\", \"ȗ\": \"u\", \"ū\": \"u\", \"ṻ\": \"u\", \"ų\": \"u\", \"ᶙ\": \"u\", \"ů\": \"u\", \"ũ\": \"u\", \"ṹ\": \"u\", \"ṵ\": \"u\", \"ᵫ\": \"ue\", \"ꝸ\": \"um\", \"ⱴ\": \"v\", \"ꝟ\": \"v\", \"ṿ\": \"v\", \"ʋ\": \"v\", \"ᶌ\": \"v\", \"ⱱ\": \"v\", \"ṽ\": \"v\", \"ꝡ\": \"vy\", \"ẃ\": \"w\", \"ŵ\": \"w\", \"ẅ\": \"w\", \"ẇ\": \"w\", \"ẉ\": \"w\", \"ẁ\": \"w\", \"ⱳ\": \"w\", \"ẘ\": \"w\", \"ẍ\": \"x\", \"ẋ\": \"x\", \"ᶍ\": \"x\", \"ý\": \"y\", \"ŷ\": \"y\", \"ÿ\": \"y\", \"ẏ\": \"y\", \"ỵ\": \"y\", \"ỳ\": \"y\", \"ƴ\": \"y\", \"ỷ\": \"y\", \"ỿ\": \"y\", \"ȳ\": \"y\", \"ẙ\": \"y\", \"ɏ\": \"y\", \"ỹ\": \"y\", \"ź\": \"z\", \"ž\": \"z\", \"ẑ\": \"z\", \"ʑ\": \"z\", \"ⱬ\": \"z\", \"ż\": \"z\", \"ẓ\": \"z\", \"ȥ\": \"z\", \"ẕ\": \"z\", \"ᵶ\": \"z\", \"ᶎ\": \"z\", \"ʐ\": \"z\", \"ƶ\": \"z\", \"ɀ\": \"z\", \"ﬀ\": \"ff\", \"ﬃ\": \"ffi\", \"ﬄ\": \"ffl\", \"ﬁ\": \"fi\", \"ﬂ\": \"fl\", \"ĳ\": \"ij\", \"œ\": \"oe\", \"ﬆ\": \"st\", \"ₐ\": \"a\", \"ₑ\": \"e\", \"ᵢ\": \"i\", \"ⱼ\": \"j\", \"ₒ\": \"o\", \"ᵣ\": \"r\", \"ᵤ\": \"u\", \"ᵥ\": \"v\", \"ₓ\": \"x\" };\r\n            return input.replace(/[^A-Za-z0-9\\[\\] ]/g, function(a) { return latinMap[a] || a; });\r\n        };\r\n    });\r\n\n// metadata\r\n// retrieves metadata for an entity or an attribute\r\n\r\nangular.module(\"EavServices\")\r\n    /// Management actions which are rather advanced metadata kind of actions\r\n    .factory(\"metadataSvc\", [\"$http\", \"appId\", function($http, appId) {\r\n        var svc = {};\r\n\r\n        // Find all items assigned to a GUID\r\n        svc.getMetadata = function getMetadata(assignedToId, keyGuid, contentTypeName) {\r\n            return $http.get(\"eav/metadata/getassignedentities\", {\r\n                params: {\r\n                    appId: appId,\r\n                    assignmentObjectTypeId: assignedToId,\r\n                    keyType: \"guid\",\r\n                    key: keyGuid,\r\n                    contentType: contentTypeName\r\n                }\r\n            });\r\n        };\r\n        return svc;\r\n    }]);\n\r\nangular.module(\"EavServices\")\r\n    .factory(\"permissionsSvc\", [\"$http\", \"eavConfig\", \"entitiesSvc\", \"metadataSvc\", \"svcCreator\", \"contentTypeSvc\", function($http, eavConfig, entitiesSvc, metadataSvc, svcCreator, contentTypeSvc) {\r\n        var eavConf = eavConfig;\r\n\r\n        // Construct a service for this specific targetGuid\r\n        return function createSvc(appId, permissionTargetGuid) {\r\n            var svc = {\r\n                PermissionTargetGuid: permissionTargetGuid,\r\n                ctName: \"PermissionConfiguration\",\r\n                ctId: 0,\r\n                EntityAssignment: eavConf.metadataOfEntity,\r\n                ctSvc: contentTypeSvc(appId)\r\n            };\r\n\r\n            svc = angular.extend(svc, svcCreator.implementLiveList(function getAll() {\r\n                // todo: refactor this - get out of the eavmanagemnetsvc\r\n                return metadataSvc.getMetadata(svc.EntityAssignment, svc.PermissionTargetGuid, svc.ctName).then(svc.updateLiveAll);\r\n            }));\r\n\r\n            // 2016-02-14 2dm commented out, don't think the ctId is ever used...\r\n            // Get ID of this content-type \r\n            svc.ctSvc.getDetails(svc.ctName).then(function (result) {\r\n                svc.ctId = result.data.Id; // 2016-02-14 previously AttributeSetId;\r\n            });\r\n\r\n            // delete, then reload\r\n            svc.delete = function del(id) {\r\n                return entitiesSvc.delete(svc.ctName, id)\r\n                    .then(svc.liveListReload);\r\n            };\r\n            return svc;\r\n        };\r\n    }]);\n// PipelineService provides an interface to the Server Backend storing Pipelines and their Pipeline Parts\r\n\r\nangular.module(\"EavServices\")\r\n    .factory(\"pipelineService\", [\"$resource\", \"$q\", \"$filter\", \"eavConfig\", \"$http\", \"contentTypeSvc\", \"metadataSvc\", \"eavAdminDialogs\", function ($resource, $q, $filter, eavConfig, $http, contentTypeSvc, metadataSvc, eavAdminDialogs) {\r\n        \"use strict\";\r\n        var svc = {};\r\n        // Web API Service\r\n        svc.pipelineResource = $resource(\"eav/PipelineDesigner/:action\");\r\n        svc.entitiesResource = $resource(\"eav/Entities/:action\");\r\n\r\n        // 2016-02-18 2dm - not needed?\r\n        // svc.dataPipelineAttributeSetId = 0;\r\n        svc.appId = 0;\r\n\r\n        // Get the Definition of a DataSource\r\n        svc.getDataSourceDefinitionProperty = function (model, dataSource) {\r\n        \tvar definition = $filter(\"filter\")(model.InstalledDataSources, function (d) { return d.PartAssemblyAndType == dataSource.PartAssemblyAndType; })[0];\r\n        \tif (!definition)\r\n        \t\tthrow \"DataSource Definition not found: \" + dataSource.PartAssemblyAndType;\r\n        \treturn definition;\r\n        };\r\n\r\n        // todo refactor: why do we have 2 methods with same name?\r\n        // Extend Pipeline-Model retrieved from the Server\r\n        var postProcessDataSources = function(model) {\r\n            // Append Out-DataSource for the UI\r\n            model.DataSources.push({\r\n                Name: eavConfig.pipelineDesigner.outDataSource.name,\r\n                Description: eavConfig.pipelineDesigner.outDataSource.description,\r\n                EntityGuid: \"Out\",\r\n                PartAssemblyAndType: eavConfig.pipelineDesigner.outDataSource.className,\r\n                VisualDesignerData: eavConfig.pipelineDesigner.outDataSource.visualDesignerData,\r\n                ReadOnly: true\r\n            });\r\n\r\n            // Extend each DataSource with Definition-Property and ReadOnly Status\r\n            angular.forEach(model.DataSources, function(dataSource) {\r\n                dataSource.Definition = function() { return svc.getDataSourceDefinitionProperty(model, dataSource); };\r\n                dataSource.ReadOnly = dataSource.ReadOnly || !model.Pipeline.AllowEdit;\r\n            });\r\n        };\r\n\r\n        angular.extend(svc, { \r\n            \r\n            // get a Pipeline with Pipeline Info with Pipeline Parts and Installed DataSources\r\n            getPipeline: function(pipelineEntityId) {\r\n                var deferred = $q.defer();\r\n\r\n                var getPipeline = svc.pipelineResource.get({ action: \"GetPipeline\", id: pipelineEntityId, appId: svc.appId });\r\n                var getInstalledDataSources = svc.pipelineResource.query({ action: \"GetInstalledDataSources\" });\r\n\r\n                // Join and modify retrieved Data\r\n                $q.all([getPipeline.$promise, getInstalledDataSources.$promise]).then(function(results) {\r\n                    var model = JSON.parse(angular.toJson(results[0])); // workaround to remove AngularJS Promise from the result-Objects\r\n                    model.InstalledDataSources = JSON.parse(angular.toJson(results[1]));\r\n\r\n                    // Init new Pipeline Object\r\n                    if (!pipelineEntityId) {\r\n                        model.Pipeline = {\r\n                            AllowEdit: \"True\"\r\n                        };\r\n                    }\r\n\r\n                    // Add Out-DataSource for the UI\r\n                    model.InstalledDataSources.push({\r\n                        PartAssemblyAndType: eavConfig.pipelineDesigner.outDataSource.className,\r\n                        ClassName: eavConfig.pipelineDesigner.outDataSource.className,\r\n                        In: eavConfig.pipelineDesigner.outDataSource.in,\r\n                        Out: null,\r\n                        allowNew: false\r\n                    });\r\n\r\n                    postProcessDataSources(model);\r\n\r\n                    deferred.resolve(model);\r\n                }, function(reason) {\r\n                    deferred.reject(reason);\r\n                });\r\n\r\n                return deferred.promise;\r\n            },\r\n            // Ensure Model has all DataSources and they're linked to their Definition-Object\r\n            postProcessDataSources: function(model) {\r\n                // stop Post-Process if the model already contains the Out-DataSource\r\n                if ($filter(\"filter\")(model.DataSources, function(d) { return d.EntityGuid == \"Out\"; })[0])\r\n                    return;\r\n\r\n                postProcessDataSources(model);\r\n            },\r\n            // Get a JSON for a DataSource with Definition-Property\r\n            getNewDataSource: function(model, dataSourceBase) {\r\n                return {\r\n                    Definition: function() { return svc.getDataSourceDefinitionProperty(model, dataSourceBase); }\r\n                };\r\n            },\r\n            // Save whole Pipline\r\n            savePipeline: function(pipeline, dataSources) {\r\n                if (!svc.appId)\r\n                    return $q.reject(\"appId must be set to save a Pipeline\");\r\n\r\n                // Remove some Properties from the DataSource before Saving\r\n                var dataSourcesPrepared = [];\r\n                angular.forEach(dataSources, function(dataSource) {\r\n                    var dataSourceClone = angular.copy(dataSource);\r\n                    delete dataSourceClone.ReadOnly;\r\n                    dataSourcesPrepared.push(dataSourceClone);\r\n                });\r\n\r\n                return svc.pipelineResource.save({\r\n                    action: \"SavePipeline\",\r\n                    appId: svc.appId,\r\n                    Id: pipeline.EntityId /*id later EntityId */\r\n                }, { pipeline: pipeline, dataSources: dataSourcesPrepared }).$promise;\r\n            },\r\n            // clone a whole Pipeline\r\n            clonePipeline: function(pipelineEntityId) {\r\n                return svc.pipelineResource.get({ action: \"ClonePipeline\", appId: svc.appId, Id: pipelineEntityId }).$promise;\r\n            },\r\n\r\n\r\n            // Get the URL to configure a DataSource\r\n            editDataSourcePart: function(dataSource) {\r\n                var dataSourceFullName = $filter(\"typename\")(dataSource.PartAssemblyAndType, \"classFullName\");\r\n                var contentTypeName = \"|Config \" + dataSourceFullName; // todo refactor centralize\r\n                var assignmentObjectTypeId = 4; // todo refactor centralize\r\n                var keyGuid = dataSource.EntityGuid;\r\n\r\n                // Query for existing Entity\r\n                metadataSvc.getMetadata(assignmentObjectTypeId, keyGuid, contentTypeName).then(function (result) { \r\n                    var success = result.data;\r\n                    if (success.length) // Edit existing Entity\r\n                        eavAdminDialogs.openItemEditWithEntityId(success[0].Id);\r\n                    else { // Create new Entity\r\n                        var items = [{\r\n                                ContentTypeName: contentTypeName,\r\n                                Metadata: {\r\n                                    TargetType: assignmentObjectTypeId,\r\n                                    KeyType: \"guid\",\r\n                                    Key: keyGuid\r\n                                }}];\r\n                        eavAdminDialogs.openEditItems(items);\r\n                    }\r\n                });\r\n            }\r\n\r\n        });\r\n\r\n        angular.extend(svc, {\r\n            // Query the Data of a Pipeline\r\n            queryPipeline: function (id) {\r\n                return svc.pipelineResource.get({ action: \"QueryPipeline\", appId: svc.appId, id: id }).$promise;\r\n            },\r\n            // set appId and init some dynamic configurations\r\n            setAppId: function (newAppId) {\r\n                svc.appId = newAppId;\r\n            },\r\n\r\n            // 2016-01-14 2dm - commenting out completely, as the getPipelineUrl is probably not used any more\r\n            // Init some Content Types, currently only used for getPipelineUrl('new', ...)\r\n            //initContentTypes: function initContentTypes() {\r\n            //    return contentTypeSvc(svc.appId).getDetails(\"DataPipeline\").then(function (result) {\r\n            //        svc.dataPipelineAttributeSetId = result.data.Id; // 2016-02-14 previously AttributeSetId;\r\n            //    });\r\n            //},\r\n\r\n\r\n            // Get all Pipelines of current App\r\n            getPipelines: function () {\r\n                return svc.entitiesResource.query({ action: \"GetEntities\", appId: svc.appId, contentType: \"DataPipeline\" });\r\n            },\r\n            // Delete a Pipeline on current App\r\n            deletePipeline: function (id) {\r\n                return svc.pipelineResource.get({ action: \"DeletePipeline\", appId: svc.appId, id: id }).$promise;\r\n            }\r\n        });\r\n\r\n        return svc;\r\n    }]);\n/*  this file contains the svcCreator - a helper to quickly create services\r\n */\r\n\r\nangular.module(\"EavServices\")\r\n    // This is a helper-factory to create services which manage one live list\r\n    // check examples with the permissions-service or the content-type-service how we use it\r\n    .factory(\"svcCreator\", [\"toastr\", \"$translate\", \"$timeout\", function (toastr, $translate, $timeout) {\r\n        var creator = {};\r\n\r\n        // construct a object which has liveListCache, liveListReload(), liveListReset(),  \r\n        creator.implementLiveList = function (getLiveList, disableToastr) {\r\n            var t = {};\r\n            t.disableToastr = !!disableToastr;\r\n            t.liveListCache = [];                   // this is the cached list\r\n            t.liveListCache.isLoaded = false;\r\n\r\n            t.liveList = function getAllLive() {\r\n                if (t.liveListCache.length === 0)\r\n                    t.liveListReload();\r\n                return t.liveListCache;\r\n            };\r\n\r\n            // use a promise-result to re-fill the live list of all items, return the promise again\r\n            t._liveListUpdateWithResult = function updateLiveAll(result) {\r\n                if (t.msg.isOpened)\r\n                    toastr.clear(t.msg);\r\n                else {\r\n                    $timeout(300).then(function() {\r\n                            toastr.clear(t.msg);\r\n                        }\r\n                    );\r\n                }\r\n                t.liveListCache.length = 0; // clear\r\n                for (var i = 0; i < result.data.length; i++)\r\n                    t.liveListCache.push(result.data[i]);\r\n                t.liveListCache.isLoaded = true;\r\n                return result;\r\n            };\r\n\r\n            t.liveListSourceRead = getLiveList;\r\n\r\n            t.liveListReload = function getAll() {\r\n                // show loading - must use the promise-mode because this may be used early before the language has arrived\r\n                $translate(\"General.Messages.Loading\").then(function(msg) {\r\n                    t.msg = toastr.info(msg);\r\n                });\r\n                return t.liveListSourceRead()\r\n                    .then(t._liveListUpdateWithResult);\r\n            };\r\n\r\n            t.liveListReset = function resetList() {\r\n                t.liveListCache = [];\r\n            };\r\n\r\n            return t;\r\n        };\r\n        return creator;\r\n\r\n    }])\r\n\r\n;\n\r\nangular.module(\"EavServices\")\r\n    // the config is important to ensure our toaster has a common setup\r\n    .config([\"toastrConfig\", function(toastrConfig) {\r\n        angular.extend(toastrConfig, {\r\n            autoDismiss: false,\r\n            containerId: \"toast-container\",\r\n            maxOpened: 5, // def is 0    \r\n            newestOnTop: true,\r\n            positionClass: \"toast-top-right\",\r\n            preventDuplicates: false,\r\n            preventOpenDuplicates: false,\r\n            target: \"body\"\r\n        });\r\n    }])\r\n\r\n    .factory(\"toastrWithHttpErrorHandling\", [\"toastr\", function (toastr) {\r\n        toastr.originalError = toastr.error;\r\n        toastr.error = function errorWithHttpErrorDisplay(messageOrHttpError, title, optionsOverride) {\r\n            var message;\r\n            // test whether bodyOrError is an Error from Web API\r\n            if (messageOrHttpError && messageOrHttpError.data && messageOrHttpError.data.Message) {\r\n                message = messageOrHttpError.data.Message;\r\n                if (messageOrHttpError.data.ExceptionMessage)\r\n                    message += \"\\n\" + messageOrHttpError.data.ExceptionMessage;\r\n            } else\r\n                message = messageOrHttpError;\r\n\r\n            toastr.originalError(message, title, optionsOverride);\r\n        };\r\n        return toastr;\r\n    }])\r\n\r\n    \r\n    .factory(\"saveToastr\", [\"toastr\", \"$translate\", function (toastr, $translate) {\r\n        function saveWithToaster(promise) {\r\n            // todo: replace all this with a single-line calling the promise-toaster below...\r\n            // ? return saveWithToaster(promise, \"Message.Saving\", \"Message.Saved\", \"Message.ErrorWhileSaving\", null, 3000, null);\r\n                var saving = toastr.info($translate.instant(\"Message.Saving\"));\r\n                return promise.then(function(result) {\r\n                    toastr.clear(saving);\r\n                    toastr.success($translate.instant(\"Message.Saved\"), { timeOut: 3000 });\r\n                    return result;\r\n                }, function errorWhileSaving(result) {\r\n                    toastr.clear(saving);\r\n                    toastr.error($translate.instant(\"Message.ErrorWhileSaving\"));\r\n                    return result;\r\n                });\r\n            }\r\n\r\n            return saveWithToaster;\r\n    }])\r\n\r\n    .factory(\"promiseToastr\", [\"toastrWithHttpErrorHandling\", \"$translate\", function (toastrWithHttpErrorHandling, $translate) {\r\n        function saveWithToaster(promise, keyInfo, keyOk, keyError, durInfo, durOk, durError) {\r\n            var toastr = toastrWithHttpErrorHandling;\r\n            var saving = toastr.info($translate.instant(keyInfo));\r\n            return promise.then(function (result) {\r\n                toastr.clear(saving);\r\n                toastr.success($translate.instant(keyOk), { timeOut: durOk || 1000 });\r\n                return result;\r\n            }, function errorWhileSaving(result) {\r\n                toastr.clear(saving);\r\n                toastr.error(result, $translate.instant(keyError));\r\n                return result;\r\n            });\r\n        }\r\n\r\n        return saveWithToaster;\r\n    }])\r\n;\nangular.module(\"eavTemplates\", []).run([\"$templateCache\", function($templateCache) {$templateCache.put(\"content-import-export/content-export.html\",\"\\r\\n<div class=\\\"modal-header\\\">\\r\\n    <button class=\\\"btn btn-default btn-square btn-subtle pull-right\\\" type=\\\"button\\\" icon=\\\"remove\\\" ng-click=\\\"vm.close()\\\"></button>\\r\\n    <h3 class=\\\"modal-title\\\" translate=\\\"Content.Export.Title\\\">cc</h3>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"modal-body\\\">\\r\\n    <div translate=\\\"Content.Export.Help\\\"></div>\\r\\n    <formly-form form=\\\"vm.form\\\" model=\\\"vm.formValues\\\" fields=\\\"vm.formFields\\\">\\r\\n    </formly-form>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"modal-footer\\\">\\r\\n    <button type=\\\"button\\\" class=\\\"btn btn-primary pull-left\\\" ng-click=\\\"vm.exportContent()\\\" translate=\\\"Content.Export.Commands.Export\\\"></button>\\r\\n</div>\");\n$templateCache.put(\"content-import-export/content-import.html\",\"<div ng-click=\\\"vm.debug.autoEnableAsNeeded($event)\\\">\\r\\n    <!-- HEADER -->\\r\\n    <div class=\\\"modal-header\\\">\\r\\n        <button class=\\\"btn btn-default btn-square btn-subtle pull-right\\\" type=\\\"button\\\" icon=\\\"remove\\\" ng-click=\\\"vm.close()\\\"></button>\\r\\n        <h3 class=\\\"modal-title\\\"><span  translate=\\\"Content.Import.Title\\\"></span> <span ng-show=\\\"vm.viewStateSelected > 0\\\" translate=\\\"Content.Import.TitleSteps\\\" translate-values=\\\"{step: vm.viewStateSelected}\\\"></span></h3>\\r\\n    </div>\\r\\n    <!-- END HEADER -->\\r\\n\\r\\n    <div ng-switch=\\\"vm.viewStateSelected\\\">\\r\\n\\r\\n        <!-- FORM -->\\r\\n        <div ng-switch-when=\\\"1\\\">\\r\\n            <div class=\\\"modal-body\\\">\\r\\n                <div translate=\\\"Content.Import.Help\\\"></div>\\r\\n                <formly-form form=\\\"vm.form\\\" model=\\\"vm.formValues\\\" fields=\\\"vm.formFields\\\"></formly-form>\\r\\n                <div class=\\\"text-warning\\\" translate=\\\"Content.Import.Messages.BackupContentBefore\\\"></div>\\r\\n            </div>\\r\\n            <div class=\\\"modal-footer\\\">\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-primary pull-left\\\" ng-click=\\\"vm.evaluateContent()\\\" ng-disabled=\\\"!vm.formValues.File || !vm.formValues.File.filename\\\" translate=\\\"Content.Import.Commands.Preview\\\"></button>\\r\\n            </div>\\r\\n        </div>\\r\\n        <!-- END FORM -->\\r\\n\\r\\n\\r\\n        <!-- WAITING -->\\r\\n        <div ng-switch-when=\\\"0\\\">\\r\\n            <div class=\\\"modal-body\\\"> {{\\'Content.Import.Messages.WaitingForResponse\\' | translate}}\\r\\n            </div>\\r\\n        </div>\\r\\n        <!-- END WAITING -->\\r\\n\\r\\n\\r\\n        <!-- EVALUATION RESULT -->\\r\\n        <div ng-switch-when=\\\"2\\\">\\r\\n            <div class=\\\"modal-body\\\">\\r\\n                <!-- DETAILS / STATISTICS -->\\r\\n                <div ng-if=\\\"vm.evaluationResult.Succeeded\\\">\\r\\n                    <h4 translate=\\\"Content.Import.Evaluation.Detail.Title\\\" translate-values=\\\"{filename: vm.formValues.File.filename}\\\"></h4>\\r\\n                    <h5 translate=\\\"Content.Import.Evaluation.Detail.File.Title\\\"></h5>\\r\\n                    <ul>\\r\\n                        <li translate=\\\"Content.Import.Evaluation.Detail.File.ElementCount\\\" translate-values=\\\"{count: vm.evaluationResult.Detail.DocumentElementsCount}\\\"></li>\\r\\n                        <li translate=\\\"Content.Import.Evaluation.Detail.File.LanguageCount\\\" translate-values=\\\"{count: vm.evaluationResult.Detail.LanguagesInDocumentCount}\\\"></li>\\r\\n                        <li translate=\\\"Content.Import.Evaluation.Detail.File.Attributes\\\" translate-values=\\\"{count: vm.evaluationResult.Detail.AttributeNamesInDocument.length, attributes: vm.evaluationResult.Detail.AttributeNamesInDocument.join(\\', \\')}\\\"></li>\\r\\n                    </ul>\\r\\n                    <h5 translate=\\\"Content.Import.Evaluation.Detail.Entities.Title\\\"></h5>\\r\\n                    <ul>\\r\\n                        <li translate=\\\"Content.Import.Evaluation.Detail.Entities.Create\\\" translate-values=\\\"{count: vm.evaluationResult.Detail.AmountOfEntitiesCreated}\\\"></li>\\r\\n                        <li translate=\\\"Content.Import.Evaluation.Detail.Entities.Update\\\" translate-values=\\\"{count: vm.evaluationResult.Detail.AmountOfEntitiesUpdated}\\\"></li>\\r\\n                        <li translate=\\\"Content.Import.Evaluation.Detail.Entities.Delete\\\" translate-values=\\\"{count: vm.evaluationResult.Detail.AmountOfEntitiesDeleted}\\\"></li>\\r\\n                        <li translate=\\\"Content.Import.Evaluation.Detail.Entities.AttributesIgnored\\\" translate-values=\\\"{count: vm.evaluationResult.Detail.AttributeNamesNotImported.length, attributes: vm.evaluationResult.Detail.AttributeNamesNotImported.join(\\', \\')}\\\"></li>\\r\\n                    </ul>\\r\\n                    <div class=\\\"text-warning\\\" translate=\\\"Content.Import.Messages.ImportCanTakeSomeTime\\\"></div>\\r\\n                </div>\\r\\n                <!-- END DETAILS / STATISTICS -->\\r\\n                <!-- ERRORS -->\\r\\n                <div ng-if=\\\"!vm.evaluationResult.Succeeded\\\">\\r\\n                    <h4 translate=\\\"Content.Import.Evaluation.Error.Title\\\" translate-values=\\\"{filename: vm.formValues.File.filename}\\\"></h4>\\r\\n                    <ul>\\r\\n                        <li ng-repeat=\\\"error in vm.evaluationResult.Detail\\\">\\r\\n                            <div><span translate=\\\"Content.Import.Evaluation.Error.Codes.{{error.ErrorCode}}\\\"></span></div>\\r\\n                            <div ng-if=\\\"error.ErrorDetail\\\"><i translate=\\\"Content.Import.Evaluation.Error.Detail\\\" translate-values=\\\"{detail: error.ErrorDetail}\\\"></i>\\r\\n                            </div>\\r\\n                            <div ng-if=\\\"error.LineNumber\\\"><i translate=Content.Import.Evaluation.Error.LineNumber\\\" translate-values=\\\"{number: error.LineNumber}\\\"></i>\\r\\n                            </div>\\r\\n                            <div ng-if=\\\"error.LineDetail\\\"><i translate=\\\"Content.Import.Evaluation.Error.LineDetail\\\" translate-values=\\\"{detail: error.LineDetail}\\\"></i>\\r\\n                            </div>\\r\\n                        </li>\\r\\n                    </ul>\\r\\n                </div>\\r\\n                <!-- END ERRORS -->\\r\\n            </div>\\r\\n            <div class=\\\"modal-footer\\\">\\r\\n                <button type=\\\"button\\\" class=\\\"btn pull-left\\\" ng-click=\\\"vm.back()\\\" icon=\\\"arrow-left\\\"></button>\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-default pull-left\\\" ng-click=\\\"vm.importContent()\\\" translate=\\\"Content.Import.Commands.Import\\\" ng-disabled=\\\"!vm.evaluationResult.Succeeded\\\"></button>\\r\\n            </div>\\r\\n        </div>\\r\\n        <!-- END EVALUATION RESULT -->\\r\\n\\r\\n\\r\\n        <!-- IMPORT RESULT -->\\r\\n        <div ng-switch-when=\\\"3\\\">\\r\\n            <div class=\\\"modal-body\\\">\\r\\n                <span ng-show=\\\"vm.importResult.Succeeded\\\" translate=\\\"Content.Import.Messages.ImportSucceeded\\\"></span>\\r\\n                <span ng-hide=\\\"vm.importResult.Succeeded\\\" translate=\\\"Content.Import.Messages.ImportFailed\\\"></span>\\r\\n            </div>\\r\\n        </div>\\r\\n        <!-- END IMPORT RESULT -->\\r\\n\\r\\n        <div ng-if=\\\"vm.debug.on\\\">\\r\\n            <h3>Debug infos</h3>\\r\\n            <pre>{{vm.formValues | json}}</pre>\\r\\n        </div>\\r\\n    </div>\\r\\n</div>\");\n$templateCache.put(\"content-types/content-types-edit.html\",\"<div ng-click=\\\"vm.debug.autoEnableAsNeeded($event)\\\">\\r\\n    <div class=\\\"modal-header\\\">\\r\\n        <button class=\\\"btn btn-default btn-square btn-subtle pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.close()\\\"><i icon=\\\"remove\\\"></i></button>\\r\\n        <h3 class=\\\"modal-title\\\" translate=\\\"ContentTypeEdit.Title\\\"></h3>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"modal-body\\\">\\r\\n        {{ \\\"ContentTypeEdit.Name\\\" | translate }}: <br />\\r\\n        <input ng-model=\\\"vm.item.Name\\\" class=\\\"input-lg\\\" />\\r\\n        <br />\\r\\n        {{ \\\"ContentTypeEdit.Description\\\" | translate }}: <br />\\r\\n        <input ng-model=\\\"vm.item.Description\\\" class=\\\"input-lg\\\"/><br/>\\r\\n\\r\\n        <div>\\r\\n            {{ \\\"ContentTypeEdit.Scope\\\" | translate }}: <br />\\r\\n            <span ng-if=\\\"vm.debug.on\\\">\\r\\n                <div class=\\\"alert alert-danger\\\">the scope should almost never be changed - <a href=\\\"http://2sxc.org/help?tag=scope\\\" _target=\\\"_blank\\\">see help</a></div>\\r\\n            </span>\\r\\n            <input ng-disabled=\\\"!vm.debug.on\\\" ng-model=\\\"vm.item.Scope\\\" class=\\\"input-lg\\\" />\\r\\n        </div>\\r\\n\\r\\n        <div ng-if=\\\"vm.debug.on\\\" class=\\\"alert-danger\\\">\\r\\n            <h3>Static Name</h3>\\r\\n            <input type=\\\"checkbox\\\" class=\\\"input-lg\\\" ng-model=\\\"vm.item.ChangeStaticName\\\"/> Really edit StaticName??? - this is usually a very bad idea\\r\\n            <br/>\\r\\n            <input ng-model=\\\"vm.item.NewStaticName\\\" ng-disabled=\\\"!vm.item.ChangeStaticName\\\" class=\\\"input-lg\\\"/>\\r\\n        </div>\\r\\n        <div ng-if=\\\"vm.debug.on\\\" class=\\\"alert-danger\\\">\\r\\n            <h3>Shared Content Type (Ghost)</h3>\\r\\n            <div>Note: this can\\'t be edited in the UI, for now if you really know what you\\'re doing, do it in the DB</div>\\r\\n            <div>Uses Type Definition of: {{vm.item.SharedDefId}}</div> \\r\\n        </div>\\r\\n    </div>\\r\\n    <div class=\\\"modal-footer\\\">\\r\\n        <button class=\\\"btn btn-primary btn-square pull-left btn-lg\\\" type=\\\"button\\\" ng-click=\\\"vm.ok()\\\"><i icon=\\\"ok\\\"></i></button>\\r\\n        <show-debug-availability class=\\\"pull-right\\\" style=\\\"margin-top: 20px;\\\"></show-debug-availability>\\r\\n    </div>\\r\\n</div>\");\n$templateCache.put(\"content-types/content-types-field-edit.html\",\"<div class=\\\"modal-header\\\">\\r\\n    <button icon=\\\"remove\\\" class=\\\"btn btn-default btn-square btn-subtle pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.close()\\\"></button>\\r\\n    <h3 class=\\\"modal-title\\\" translate=\\\"Fields.TitleEdit\\\"></h3>\\r\\n</div>\\r\\n<div class=\\\"modal-body\\\">\\r\\n    <table class=\\\"table table-hover table-manage-eav\\\">\\r\\n        <thead>\\r\\n        <tr>\\r\\n            <th translate=\\\"Fields.Table.Name\\\" style=\\\"width: 33%\\\"></th>\\r\\n            <th translate=\\\"Fields.Table.DataType\\\" style=\\\"width: 33%\\\">Data Type</th>\\r\\n            <th translate=\\\"Fields.Table.InputType\\\" style=\\\"width: 33%\\\">Input Type</th>\\r\\n        </tr>\\r\\n        </thead>\\r\\n        <tbody>\\r\\n        <tr ng-repeat=\\\"item in vm.items\\\">\\r\\n            <td>\\r\\n                <input ng-model=\\\"item.StaticName\\\" ng-required=\\\"true\\\" class=\\\"input-lg\\\" style=\\\"width: 100%\\\" disabled=\\\"disabled\\\"/>\\r\\n            </td>\\r\\n            <td>\\r\\n                <input ng-model=\\\"item.Type\\\" disabled=\\\"disabled\\\" class=\\\"input-lg\\\" style=\\\"width: 100%\\\"/>\\r\\n            </td>\\r\\n            <td>\\r\\n                <select class=\\\"input-lg\\\" ng-model=\\\"item.InputType\\\" style=\\\"width: 100%\\\"\\r\\n                        tooltip=\\\"{{ (vm.allInputTypes | filter: { inputType: item.InputType})[0].description }}\\\"\\r\\n                        ng-options=\\\"o.inputType as o.label for o in vm.allInputTypes | filter: {dataType: item.Type.toLowerCase() } \\\">\\r\\n                </select>\\r\\n\\r\\n            </td>\\r\\n        </tr>\\r\\n        </tbody>\\r\\n    </table>\\r\\n</div>\\r\\n<div class=\\\"modal-footer\\\">\\r\\n    <button icon=\\\"ok\\\" class=\\\"btn btn-lg btn-primary btn-square pull-left\\\" type=\\\"button\\\" ng-click=\\\"vm.ok()\\\"></button>\\r\\n</div>\");\n$templateCache.put(\"content-types/content-types-fields-add.html\",\"<div class=\\\"modal-header\\\">\\r\\n    <button icon=\\\"remove\\\" class=\\\"btn btn-default btn-square btn-subtle pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.close()\\\"></button>\\r\\n    <h3 class=\\\"modal-title\\\" translate=\\\"Fields.TitleEdit\\\"></h3>\\r\\n</div>\\r\\n<div class=\\\"modal-body\\\">\\r\\n    <table class=\\\"table table-hover table-manage-eav\\\">\\r\\n        <thead>\\r\\n        <tr>\\r\\n            <th translate=\\\"Fields.Table.Name\\\" style=\\\"width: 33%\\\"></th>\\r\\n            <th translate=\\\"Fields.Table.DataType\\\" style=\\\"width: 33%\\\">Data Type</th>\\r\\n            <th translate=\\\"Fields.Table.InputType\\\" style=\\\"width: 33%\\\">Input Type</th>\\r\\n        </tr>\\r\\n        </thead>\\r\\n        <tbody>\\r\\n        <tr ng-repeat=\\\"item in vm.items\\\">\\r\\n            <td>\\r\\n                <input ng-model=\\\"item.StaticName\\\" ng-required=\\\"true\\\" class=\\\"input-lg\\\" style=\\\"width: 100%\\\"/>\\r\\n            </td>\\r\\n            <td>\\r\\n                <select class=\\\"input-lg\\\" ng-model=\\\"item.Type\\\" style=\\\"width: 100%\\\"\\r\\n                        tooltip=\\\"{{ \\'DataType.\\' + item.Type + \\'.Explanation\\' | translate }}\\\"\\r\\n                        ng-options=\\\"o as \\'DataType.\\' + o + \\'.Choice\\' | translate for o in vm.types | orderBy: \\'toString()\\' \\\"\\r\\n                        ng-change=\\\"vm.resetSubTypes(item)\\\">\\r\\n                    <option>-- select --</option>\\r\\n                </select>\\r\\n            </td>\\r\\n            <td>\\r\\n                <select class=\\\"input-lg\\\" ng-model=\\\"item.InputType\\\" style=\\\"width: 100%\\\"\\r\\n                        tooltip=\\\"{{ (vm.allInputTypes | filter: { inputType: item.InputType})[0].description }}\\\"\\r\\n                        ng-options=\\\"o.inputType as o.label for o in vm.allInputTypes | filter: {dataType: item.Type.toLowerCase() } \\\">\\r\\n                </select>\\r\\n\\r\\n            </td>\\r\\n        </tr>\\r\\n        </tbody>\\r\\n    </table>\\r\\n</div>\\r\\n<div class=\\\"modal-footer\\\">\\r\\n    <button icon=\\\"ok\\\" class=\\\"btn btn-lg btn-primary btn-square pull-left\\\" type=\\\"button\\\" ng-click=\\\"vm.ok()\\\"></button>\\r\\n</div>\");\n$templateCache.put(\"content-types/content-types-fields.html\",\"<div>\\r\\n\\r\\n    <div class=\\\"modal-header\\\">\\r\\n        <button class=\\\"btn btn-default btn-subtle btn-square pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.close()\\\"><i icon=\\\"remove\\\"></i></button>\\r\\n        <h3 class=\\\"modal-title\\\" translate=\\\"Fields.Title\\\"></h3>\\r\\n    </div>\\r\\n    <div class=\\\"modal-body\\\">\\r\\n        <button icon=\\\"plus\\\" ng-click=\\\"vm.add()\\\" class=\\\"btn btn-primary btn-square\\\"></button>\\r\\n\\r\\n        <!-- Table of content types for editing -->\\r\\n        <table class=\\\"table table-hover table-manage-eav\\\">\\r\\n            <thead>\\r\\n                <tr>\\r\\n                    <th translate=\\\"Fields.Table.Title\\\" class=\\\"mini-btn-1\\\"></th>\\r\\n                    <th translate=\\\"Fields.Table.Name\\\" style=\\\"width: 40%\\\"></th>\\r\\n                    <th translate=\\\"Fields.Table.DataType\\\" style=\\\"width: 20%\\\"></th>\\r\\n                    <th translate=\\\"Fields.Table.InputType\\\" style=\\\"width: 20%\\\"></th>\\r\\n                    <th translate=\\\"Fields.Table.Label\\\" style=\\\"width: 30%\\\"></th>\\r\\n                    <th translate=\\\"Fields.Table.Notes\\\" style=\\\"width: 50%\\\"></th>\\r\\n                    <th translate=\\\"Fields.Table.Sort\\\" class=\\\"mini-btn-2\\\"></th>\\r\\n                    <th translate=\\\"Fields.Table.Action\\\" class=\\\"mini-btn-1\\\"></th>\\r\\n                </tr>\\r\\n            </thead>\\r\\n            <tbody>\\r\\n                <tr ng-repeat=\\\"item in vm.items | orderBy: \\'SortOrder\\'\\\" class=\\\"clickable-row\\\" ng-click=\\\"vm.createOrEditMetadata(item, item.Type)\\\">\\r\\n                    <td stop-event=\\\"click\\\">\\r\\n                        <button type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-style=\\\"(item.IsTitle ? \\'\\' : \\'color: transparent !important\\')\\\" ng-click=\\\"vm.setTitle(item)\\\">\\r\\n                            <i icon=\\\"{{item.IsTitle ? \\'star\\' : \\'star-empty\\'}}\\\"></i>\\r\\n                        </button>\\r\\n                    </td>\\r\\n                    <td class=\\\"clickable\\\"><span tooltip=\\\"{{ \\'Id: \\' + item.Id}}\\\">{{item.StaticName}}</span></td>\\r\\n                    <td class=\\\"text-nowrap clickable\\\">\\r\\n                        {{item.Type}}\\r\\n                    </td>\\r\\n                    <td class=\\\"text-nowrap InputType\\\" stop-event=\\\"click\\\">\\r\\n                        <span class=\\\"clickable\\\" tooltip=\\\"{{ vm.inputTypeTooltip(item.InputType) }}\\\" ng-click=\\\"vm.edit(item)\\\">\\r\\n                            <i icon=\\\"pencil\\\"></i>\\r\\n                            {{item.InputType.substring(item.InputType.indexOf(\\'-\\') + 1, 100)}}\\r\\n                        </span>\\r\\n                    </td>\\r\\n                    <td class=\\\"text-nowrap clickable\\\">\\r\\n                        {{item.Metadata.All.Name}}\\r\\n                    </td>\\r\\n                    <!--<td>-</td>-->\\r\\n                    <td class=\\\"text-nowrap clickable\\\">\\r\\n                        <div class=\\\"hide-overflow-text\\\">\\r\\n                            {{item.Metadata.All.Notes}}\\r\\n                        </div>\\r\\n                    </td>\\r\\n\\r\\n                    <td class=\\\"text-nowrap\\\" stop-event=\\\"click\\\">\\r\\n                        <button icon=\\\"arrow-up\\\" type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-disabled=\\\"$first\\\" ng-click=\\\"vm.moveUp(item)\\\"></button>\\r\\n                        <button icon=\\\"arrow-down\\\" type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-disabled=\\\"$last\\\" ng-click=\\\"vm.moveDown(item)\\\"></button>\\r\\n                    </td>\\r\\n                    <td stop-event=\\\"click\\\">\\r\\n                        <button icon=\\\"remove\\\" type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-click=\\\"vm.tryToDelete(item)\\\"></button>\\r\\n                    </td>\\r\\n                </tr>\\r\\n                <tr ng-if=\\\"!vm.items.length\\\">\\r\\n                    <td colspan=\\\"100\\\" translate=\\\"General.Messages.NothingFound\\\"></td>\\r\\n                </tr>\\r\\n            </tbody>\\r\\n        </table>\\r\\n\\r\\n    </div>\\r\\n\\r\\n\\r\\n</div>\");\n$templateCache.put(\"content-types/content-types.html\",\"<div ng-controller=\\\"List as vm\\\" ng-click=\\\"vm.debug.autoEnableAsNeeded($event)\\\">\\r\\n    <div class=\\\"modal-header\\\">\\r\\n        <h3 class=\\\"modal-title\\\" translate=\\\"ContentTypes.Title\\\"></h3>\\r\\n    </div>\\r\\n    <div class=\\\"modal-body\\\">\\r\\n        <!-- Buttons on top -->\\r\\n        <button title=\\\"{{ \\'General.Buttons.Add\\' | translate }}\\\" type=\\\"button\\\" class=\\\"btn btn-primary btn-square\\\" ng-click=\\\"vm.edit()\\\"><i icon=\\\"plus\\\"></i></button>\\r\\n\\r\\n\\r\\n        <span class=\\\"btn-group\\\" ng-if=\\\"vm.debug.on\\\">\\r\\n            <button title=\\\"{{ \\'General.Buttons.Refresh\\' | translate }}\\\" type=\\\"button\\\" class=\\\"btn btn-warning btn-square\\\" ng-click=\\\"vm.refresh()\\\"><i icon=\\\"repeat\\\"></i></button>\\r\\n            <button title=\\\"todo\\\" type=\\\"button\\\" class=\\\"btn btn-warning btn-icon\\\" ng-click=\\\"vm.createGhost()\\\"><i class=\\\"icon-ghost\\\"></i></button>\\r\\n            <button title=\\\"{{ \\'ContentTypes.Buttons.ChangeScope\\' | translate }}\\\" type=\\\"button\\\" class=\\\"btn btn-warning btn-square\\\" ng-click=\\\"vm.changeScope()\\\"><i icon=\\\"record\\\"></i></button>\\r\\n            <button title=\\\"{{ \\'General.Buttons.System\\' | translate }}\\\" type=\\\"button\\\" class=\\\"btn btn-warning btn-square\\\" ng-click=\\\"vm.liveEval()\\\"><i icon=\\\"flash\\\"></i></button>\\r\\n        </span>\\r\\n        <!-- Table of content types for editing -->\\r\\n        <table class=\\\"table table-hover\\\" style=\\\"table-layout: fixed; width: 100%\\\">\\r\\n            <thead>\\r\\n            <tr>\\r\\n                <!--<th translate=\\\"ContentTypes.TypesTable.Items\\\" class=\\\"col-id\\\"></th>-->\\r\\n                <th translate=\\\"ContentTypes.TypesTable.Name\\\" style=\\\"width: 50%\\\"></th>\\r\\n                <th class=\\\"mini-btn-1\\\"></th>\\r\\n                <th translate=\\\"ContentTypes.TypesTable.Description\\\" style=\\\"width: 50%\\\"></th>\\r\\n                <th translate=\\\"ContentTypes.TypesTable.Fields\\\" class=\\\"mini-btn-2\\\"></th>\\r\\n                <th translate=\\\"ContentTypes.TypesTable.Actions\\\" class=\\\"mini-btn-3\\\"></th>\\r\\n                <th class=\\\"mini-btn-1\\\"> </th>\\r\\n            </tr>\\r\\n            </thead>\\r\\n            <tbody>\\r\\n            <tr ng-if=\\\"vm.items.isLoaded\\\" ng-repeat=\\\"item in vm.items | orderBy:\\'Name\\'\\\" class=\\\"clickable-row\\\" ng-click=\\\"vm.editItems(item)\\\">\\r\\n                <!--<td style=\\\"text-align: center\\\" class=\\\"clickable\\\"> {{item.Items}} </td>-->\\r\\n                <td class=\\\"clickable\\\">\\r\\n                    <span class=\\\"text-nowrap hide-overflow-text\\\" style=\\\"max-width: 400px\\\" tooltip=\\\"{{item.Name}}\\\">{{item.Name}}</span>\\r\\n                </td>\\r\\n                <td class=\\\"clickable\\\" style=\\\"text-align: right\\\">\\r\\n                    <div class=\\\"badge pull-right badge-primary hover-pair\\\" stop-event=\\\"click\\\" ng-click=\\\"vm.addItem(item.StaticName)\\\"><span class=\\\"hover-default\\\">{{item.Items}}</span><span class=\\\"hover-hover icon-plus\\\"></span></div></td>\\r\\n                <td class=\\\"clickable\\\">\\r\\n                    <div class=\\\"text-nowrap hide-overflow-text\\\" style=\\\"max-width: 500px\\\" tooltip=\\\"{{item.Description}}\\\">{{item.Description}}</div>\\r\\n                </td>\\r\\n                <td stop-event=\\\"click\\\">\\r\\n                    <button ng-if=\\\"!item.UsesSharedDef\\\" type=\\\"button\\\" class=\\\"btn btn-xs\\\" style=\\\"width: 60px\\\" ng-click=\\\"vm.editFields(item)\\\">\\r\\n                        <i class=\\\"icon-fields\\\"></i>&nbsp;<span style=\\\"width: 22px; text-align: right\\\">{{item.Fields}}</span>\\r\\n                    </button>\\r\\n                    <button ng-if=\\\"item.UsesSharedDef\\\" tooltip=\\\"{{ \\'ContentTypes.Messages.SharedDefinition\\' | translate:item }}\\\" type=\\\"button\\\" class=\\\"btn btn-default btn-xs\\\" style=\\\"width: 60px\\\">\\r\\n                        <i class=\\\"icon-ghost\\\"></i>&nbsp;<span style=\\\"width: 22px; text-align: right\\\">{{item.Fields}}</span>\\r\\n                    </button>\\r\\n                </td>\\r\\n\\r\\n                <td class=\\\"text-nowrap\\\" stop-event=\\\"click\\\">\\r\\n                    <span class=\\\"btn-group\\\">\\r\\n                        <button tooltip=\\\"{{ \\'General.Buttons.Rename\\' | translate }} - {{  \\'ContentTypes.Messages.Type\\' + (item.UsesSharedDef ? \\'Shared\\' : \\'Own\\')  | translate:item }}\\\" type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-click=\\\"vm.edit(item)\\\">\\r\\n                            <i icon=\\\"heart{{ (item.UsesSharedDef ? \\'-empty\\' : \\'\\') }}\\\"></i>\\r\\n                        </button>\\r\\n                        <button tooltip=\\\"{{ \\'ContentTypes.Buttons.Export\\' | translate }}\\\" type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-click=\\\"vm.openExport(item)\\\"><i icon=\\\"export\\\"></i></button>\\r\\n                        <button tooltip=\\\"{{ \\'ContentTypes.Buttons.Import\\' | translate }}\\\" type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-click=\\\"vm.openImport(item)\\\"><i icon=\\\"import\\\"></i></button>\\r\\n                        <button type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-click=\\\"vm.permissions(item)\\\" ng-if=\\\"vm.isGuid(item.StaticName)\\\"><i icon=\\\"user\\\"></i></button>\\r\\n                    </span>\\r\\n                </td>\\r\\n                <td stop-event=\\\"click\\\">\\r\\n                    <button icon=\\\"remove\\\" type=\\\"button\\\" class=\\\"btn btn-xs\\\" ng-click=\\\"vm.tryToDelete(item)\\\"></button>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr ng-if=\\\"!vm.items.length\\\">\\r\\n                <td colspan=\\\"100\\\">{{ \\'General.Messages.Loading\\' | translate }} / {{ \\'General.Messages.NothingFound\\' | translate }}</td>\\r\\n            </tr>\\r\\n            </tbody>\\r\\n        </table>\\r\\n        <show-debug-availability class=\\\"pull-right\\\"></show-debug-availability>\\r\\n    </div>\\r\\n    <div ng-if=\\\"vm.debug.on\\\">\\r\\n\\r\\n        <h3>Notes / Debug / ToDo</h3>\\r\\n        <ol>\\r\\n            <li>get validators to work on all dialogs</li>\\r\\n        </ol>\\r\\n    </div>\\r\\n</div>\\r\\n\");\n$templateCache.put(\"content-items/content-edit.html\",\"<div class=\\\"modal-header\\\">\\r\\n    <button type=\\\"button\\\" class=\\\"btn btn-default btn-subtle\\\" ng-click=\\\"vm.history()\\\">\\r\\n        <span class=\\\"glyphicon glyphicon-time\\\"> history / todo </span>\\r\\n    </button>\\r\\n    <h3 class=\\\"modal-title\\\">Edit / New Content</h3>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"modal-body\\\">\\r\\n    this is where the edit appears. Would edit entity {{vm.entityId}} or add a {{vm.contentType}} - depending on the mode: {{vm.mode}}\\r\\n    <h3>Use cases</h3>\\r\\n    <ol>\\r\\n        <li>Edit an existing entity with ID</li>\\r\\n        <li>Create a new entity of a certaint content-type, just save and done (like from a \\\"new\\\" button without content-group)</li>\\r\\n        <li>Create a new entity of a certain type and assign it to a metadata thing (guid, int, string)</li>\\r\\n\\r\\n        <li>Create a new entity and put it into a content-group at the right place</li>\\r\\n        <li>Edit content-group: item + presentation </li>\\r\\n        <li>Edit multiple IDs/or new/mix: Edit multiple items with IDs</li>\\r\\n    </ol>\\r\\n\\r\\n    init of 1 edit\\r\\n    - entity-id in storage\\r\\n    - new-type + optional: assignment-id + assignment-type\\r\\n\\r\\n    - array of the above\\r\\n    --- [{id 17}, {type: \\\"person\\\"}, {type: person, asstype: 4, target: 0205}]\\r\\n\\r\\n    - content-group\\r\\n</div>\\r\\n\");\n$templateCache.put(\"content-items/content-items-agnostic.html\",\"<div ng-click=\\\"vm.debug.autoEnableAsNeeded($event)\\\" class=\\\"content-items-agnostic\\\">\\r\\n    <div class=\\\"modal-header\\\">\\r\\n        <button class=\\\"btn btn-default btn-square btn-subtle pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.close()\\\"><i icon=\\\"remove\\\"></i></button>\\r\\n        <h3 class=\\\"modal-title\\\" translate=\\\"Content.Manage.Title\\\"></h3>\\r\\n    </div>\\r\\n    <div class=\\\"modal-body\\\">\\r\\n        <button type=\\\"button\\\" class=\\\"btn btn-primary btn-square\\\" ng-click=\\\"vm.add()\\\"><i icon=\\\"plus\\\"></i></button>\\r\\n\t    <button ng-if=\\\"vm.debug.on\\\" type=\\\"button\\\" class=\\\"btn btn-warning btn-square\\\" ng-click=\\\"vm.refresh()\\\"><i icon=\\\"repeat\\\"></i></button>\\r\\n\\r\\n\t\t<div ag-grid=\\\"vm.gridOptions\\\" class=\\\"ag-grid-wrapper\\\"></div>\\r\\n\t    \\r\\n        <show-debug-availability class=\\\"pull-right\\\" ></show-debug-availability>\\r\\n    </div>\\r\\n</div>\");\n$templateCache.put(\"content-items/content-items.html\",\"<div ng-click=\\\"vm.debug.autoEnableAsNeeded($event)\\\">\\r\\n    <div class=\\\"modal-header\\\">\\r\\n        <button class=\\\"btn btn-default btn-square btn-subtle pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.close()\\\"><i icon=\\\"remove\\\"></i></button>\\r\\n        <h3 class=\\\"modal-title\\\" translate=\\\"Content.Manage.Title\\\"></h3>\\r\\n    </div>\\r\\n    <div class=\\\"modal-body\\\">\\r\\n        <button type=\\\"button\\\" class=\\\"btn btn-primary btn-square\\\" ng-click=\\\"vm.add()\\\"><i icon=\\\"plus\\\"></i></button>\\r\\n        <button ng-if=\\\"vm.debug.on\\\" type=\\\"button\\\" class=\\\"btn btn-warning btn-square\\\" ng-click=\\\"vm.refresh()\\\"><i icon=\\\"repeat\\\"></i></button>\\r\\n\\r\\n        <div style=\\\"overflow: auto\\\">\\r\\n            <table class=\\\"table table-hover table-manage-eav\\\">\\r\\n                <thead>\\r\\n                <tr>\\r\\n                    <th translate=\\\"Content.Manage.Table.Id\\\" class=\\\"col-id\\\"></th>\\r\\n                    <th translate=\\\"Content.Manage.Table.Status\\\" style=\\\"width: 60px\\\"></th>\\r\\n                    <th translate=\\\"Content.Manage.Table.Title\\\" style=\\\"width: 200px\\\"></th>\\r\\n                    <th translate=\\\"Content.Manage.Table.Actions\\\" class=\\\"mini-btn-2\\\"></th>\\r\\n                    <th ng-repeat=\\\"col in vm.dynamicColumns\\\" style=\\\"width: 10%\\\">{{col.StaticName}}</th>\\r\\n                </tr>\\r\\n                </thead>\\r\\n                <tbody>\\r\\n                <tr ng-repeat=\\\"item in vm.items | orderBy: [\\'Id\\',\\'-IsPublished\\'] \\\" class=\\\"clickable-row\\\" ng-click=\\\"vm.edit(item)\\\">\\r\\n                    <td class=\\\"text-nowrap clickable\\\" style=\\\"text-align: right\\\">\\r\\n                        <span tooltip=\\\"Id: {{item.Id}}\\r\\nRepoId: {{item.RepositoryId}}\\r\\nGuid: {{item.Guid}}\\\">{{item.Id}}</span>\\r\\n                    </td>\\r\\n                    <td class=\\\"text-nowrap\\\">\\r\\n                        <span class=\\\"glyphicon\\\" ng-class=\\\"{\\'glyphicon-eye-open\\': item.IsPublished, \\'glyphicon-eye-close\\' : !item.IsPublished}\\\" tooltip=\\\"{{ \\'Content.Publish.\\' + (item.IsPublished ? \\'PnV\\': item.Published ? \\'DoP\\' : \\'D\\') | translate }}\\\"></span>\\r\\n                        <span icon=\\\"{{ item.Draft ? \\'link\\' : item.Published ? \\'link\\' : \\'\\' }}\\\" tooltip=\\\"{{ (item.Draft ? \\'Content.Publish.HD\\' :\\'\\') | translate:\\'{ id: item.Draft.RepositoryId}\\' }}\\r\\n{{ (item.Published ? \\'Content.Publish.HP\\' :\\'\\') | translate }} #{{ item.Published.RepositoryId }}\\\"></span>\\r\\n                        <span ng-if=\\\"item.Metadata\\\" tooltip=\\\"Metadata for type {{ item.Metadata.TargetType}}, id {{ item.Metadata.KeyNumber }}{{ item.Metadata.KeyString }}{{ item.Metadata.KeyGuid }}\\\" icon=\\\"tag\\\"></span>\\r\\n                    </td>\\r\\n                    <td class=\\\"text-nowrap clickable\\\">\\r\\n                        <div class=\\\"hide-overflow-text\\\" style=\\\"height: 20px; width: 200px\\\" tooltip=\\\"{{item.Title}}\\\">\\r\\n                            {{item.Title}}{{ (!item.Title ? \\'Content.Manage.NoTitle\\':\\'\\') | translate }}\\r\\n                        </div>\\r\\n                    </td>\\r\\n                    <td class=\\\"text-nowrap\\\" stop-event=\\\"click\\\">\\r\\n                        <button type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-click=\\\"vm.openDuplicate(item)\\\" tooltip=\\\"{{ \\'General.Buttons.Copy\\' | translate }}\\\"><i icon=\\\"duplicate\\\"></i></button>\\r\\n                        <button type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-click=\\\"vm.tryToDelete(item)\\\" tooltip=\\\"{{ \\'General.Buttons.Delete\\' | translate }}\\\"><i icon=\\\"remove\\\"></i> </button>\\r\\n                    </td>\\r\\n                    <td ng-repeat=\\\"col in vm.dynamicColumns\\\" width=\\\"10%\\\">\\r\\n                        <div style=\\\"height: 20px; max-width: 300px;\\\" class=\\\"hide-overflow-text\\\" tooltip=\\\"{{item[col.StaticName]}}\\\">{{item[col.StaticName].toString().substring(0,25)}}</div>\\r\\n                    </td>\\r\\n\\r\\n                </tr>\\r\\n                <tr ng-if=\\\"!vm.items.length\\\">\\r\\n                    <td colspan=\\\"100\\\" translate=\\\"General.Messages.NothingFound\\\"></td>\\r\\n                </tr>\\r\\n                </tbody>\\r\\n            </table>\\r\\n        </div>\\r\\n        <show-debug-availability class=\\\"pull-right\\\" ></show-debug-availability>\\r\\n    </div>\\r\\n</div>\");\n$templateCache.put(\"content-items/history-details.html\",\"<div>\\r\\n    <div class=\\\"modal-header\\\">\\r\\n        <button class=\\\"btn btn-default btn-subtle btn-square pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.close()\\\">\\r\\n            <span class=\\\"glyphicon glyphicon-remove\\\"></span>\\r\\n        </button>\\r\\n        <h3 class=\\\"modal-title\\\">History Details {{vm.ChangeId}} of {{vm.entityId}}</h3>\\r\\n    </div>\\r\\n    <div class=\\\"modal-body\\\">\\r\\n        <h1>todo</h1>\\r\\n        <table class=\\\"table table-striped table-hover\\\">\\r\\n            <thead>\\r\\n            <tr>\\r\\n                <th>Field</th>\\r\\n                <th>Language</th>\\r\\n                <th>Value</th>\\r\\n                <th>SharedWith</th>\\r\\n            </tr>\\r\\n            </thead>\\r\\n            <tbody>\\r\\n            <tr ng-repeat=\\\"item in vm.items | orderBy:SysCreatedDate:reverse\\\">\\r\\n                <td>{{item.Field}}</td>\\r\\n                <td>{{item.Language}}</td>\\r\\n                <td>{{item.Value}}</td>\\r\\n                <td>{{item.SharedWith}}</td>\\r\\n\\r\\n            </tr>\\r\\n            <tr ng-if=\\\"!vm.items.length\\\">\\r\\n                <td colspan=\\\"100\\\">No History</td>\\r\\n            </tr>\\r\\n            </tbody>\\r\\n        </table>\\r\\n\\r\\n        <button class=\\\"btn btn-primary pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.restore()\\\">\\r\\n            <span class=\\\"glyphicon glyphicon-ok\\\">todo restore</span>\\r\\n        </button>    </div>\\r\\n\\r\\n</div>\");\n$templateCache.put(\"content-items/history.html\",\"<div>\\r\\n    <div class=\\\"modal-header\\\">\\r\\n        <button class=\\\"btn btn-default btn-square btn-subtle pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.close()\\\">\\r\\n            <span class=\\\"glyphicon glyphicon-remove\\\"></span>\\r\\n        </button>\\r\\n        <h3 class=\\\"modal-title\\\">{{ \\\"Content.History.Title\\\" | translate:\\'{ id:vm.entityId }\\' }}History of {{vm.entityId}}</h3>\\r\\n    </div>\\r\\n    <div class=\\\"modal-body\\\">\\r\\n\\r\\n        <table class=\\\"table table-striped table-hover\\\">\\r\\n            <thead>\\r\\n            <tr>\\r\\n                <th translate=\\\"Content.History.Table.Id\\\"></th>\\r\\n                <th translate=\\\"Content.History.Table.When\\\"></th>\\r\\n                <th translate=\\\"Content.History.Table.User\\\"></th>\\r\\n                <th translate=\\\"Content.History.Table.Action\\\"></th>\\r\\n            </tr>\\r\\n            </thead>\\r\\n            <tbody>\\r\\n            <tr ng-repeat=\\\"item in vm.items | orderBy:SysCreatedDate:reverse\\\">\\r\\n                <td><span tooltip=\\\"ChangeId: {{item.ChangeId}}\\\">{{item.VirtualVersion}}</span></td>\\r\\n                <td>{{item.SysCreatedDate.replace(\\\"T\\\", \\\" \\\")}}</td>\\r\\n                <td>{{item.User}}</td>\\r\\n                <td>\\r\\n                    <button type=\\\"button\\\" class=\\\"btn btn-xs\\\" ng-click=\\\"vm.details(item)\\\">\\r\\n                        <span class=\\\"glyphicon glyphicon-search\\\"></span>\\r\\n                    </button>\\r\\n                </td>\\r\\n            </tr>\\r\\n                <tr ng-if=\\\"!vm.items.length\\\">\\r\\n                    <td colspan=\\\"100\\\" translate=\\\"General.Messages.NothingFound\\\"></td>\\r\\n                </tr>\\r\\n            </tbody>\\r\\n        </table>\\r\\n    </div>\\r\\n\\r\\n</div>\");\n$templateCache.put(\"pipelines/pipeline-designer.html\",\"<div class=\\\"ng-cloak\\\">\\r\\n    <div ng-controller=\\\"PipelineDesignerController as vm\\\" ng-click=\\\"vm.debug.autoEnableAsNeeded($event)\\\">\\r\\n        <div id=\\\"pipelineContainer\\\">\\r\\n            <div ng-repeat=\\\"dataSource in pipelineData.DataSources\\\"\\r\\n                 datasource\\r\\n                 guid=\\\"{{dataSource.EntityGuid}}\\\"\\r\\n                 id=\\\"dataSource_{{dataSource.EntityGuid}}\\\"\\r\\n                 class=\\\"dataSource\\\"\\r\\n                 ng-attr-style=\\\"top: {{dataSource.VisualDesignerData.Top}}px; left: {{dataSource.VisualDesignerData.Left}}px\\\">\\r\\n                <div class=\\\"configure\\\" ng-click=\\\"configureDataSource(dataSource)\\\" title=\\\"Configure this DataSource\\\" ng-if=\\\"!dataSource.ReadOnly\\\">\\r\\n                    <span class=\\\"glyphicon glyphicon-list-alt\\\"></span>\\r\\n                </div>\\r\\n                <div class=\\\"name\\\" title=\\\"Click to edit the Name\\\" ng-click=\\\"editName(dataSource)\\\">{{dataSource.Name || \\'(unnamed)\\'}}</div><br />\\r\\n                <div class=\\\"description\\\" title=\\\"Click to edit the Description\\\" ng-click=\\\"editDescription(dataSource)\\\">{{dataSource.Description || \\'(no description)\\'}}</div><br />\\r\\n                <div class=\\\"typename\\\" ng-attr-title=\\\"{{dataSource.PartAssemblyAndType}}\\\">Type: {{dataSource.PartAssemblyAndType | typename: \\'className\\'}}</div>\\r\\n                <div class=\\\"ep\\\" title=\\\"Drag a new Out-Connection from here\\\" ng-if=\\\"!dataSource.ReadOnly\\\">\\r\\n                    <span class=\\\"glyphicon glyphicon-plus-sign\\\"></span>\\r\\n                </div>\\r\\n                <div class=\\\"delete glyphicon glyphicon-remove\\\" title=\\\"Delete this DataSource\\\" ng-click=\\\"remove($index)\\\" ng-if=\\\"!dataSource.ReadOnly\\\"></div>\\r\\n            </div>\\r\\n        </div>\\r\\n        <div class=\\\"actions panel panel-default\\\">\\r\\n            <div class=\\\"panel-heading\\\">\\r\\n                <span class=\\\"pull-left\\\">Actions</span>\\r\\n                <a href=\\\"http://2sxc.org/help\\\" class=\\\"btn btn-info btn-xs pull-right\\\" target=\\\"_blank\\\"><span class=\\\"glyphicon glyphicon-question-sign\\\"></span> Help</a>\\r\\n            </div>\\r\\n            <div class=\\\"panel-body\\\">\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-primary btn-block\\\" title=\\\"Query the Data of this Pipeline\\\" ng-click=\\\"queryPipeline()\\\">\\r\\n                    <span class=\\\"glyphicon glyphicon-play\\\"></span> Query\\r\\n                </button>\\r\\n\\r\\n                <select class=\\\"form-control\\\" ng-model=\\\"addDataSourceType\\\" ng-disabled=\\\"readOnly\\\" ng-change=\\\"addDataSource()\\\" ng-options=\\\"d.ClassName for d in pipelineData.InstalledDataSources | filter: {allowNew: \\'!false\\'} | orderBy: \\'ClassName\\'\\\">\\r\\n                    <option value=\\\"\\\">-- Add DataSource --</option>\\r\\n                </select>\\r\\n                <!--<button type=\\\"button\\\" class=\\\"btn btn-default btn-sm\\\" title=\\\"Clone this Pipeline with all DataSources and Configurations\\\" ng-click=\\\"clonePipeline()\\\" ng-disabled=\\\"!PipelineEntityId\\\"><span class=\\\"glyphicon glyphicon-share-alt\\\"></span> Clone</button>-->\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-default btn-block\\\" ng-click=\\\"editPipelineEntity()\\\"><span class=\\\"glyphicon glyphicon-pencil\\\"></span> Test Parameters</button>\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-primary btn-block\\\" ng-disabled=\\\"readOnly\\\" ng-click=\\\"savePipeline()\\\">\\r\\n                    <span icon=\\\"ok\\\"></span> Save\\r\\n                </button>\\r\\n                <br/>\\r\\n                <br/>\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-info btn-xs\\\" ng-click=\\\"toggleEndpointOverlays()\\\"><span class=\\\"glyphicon glyphicon-info-sign\\\"></span> {{showEndpointOverlays ? \\'Hide\\' : \\'Show\\' }} Overlays</button>\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-info btn-xs\\\" ng-click=\\\"repaint()\\\"><span class=\\\"glyphicon glyphicon-repeat\\\"></span> Repaint</button>\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-info btn-xs\\\" ng-if=\\\"vm.debug.on\\\" ng-click=\\\"toogleDebug()\\\"><span class=\\\"glyphicon glyphicon-info-sign\\\"></span> {{debug ? \\'Hide\\' : \\'Show\\'}} Debug Info</button>\\r\\n\\r\\n                <show-debug-availability class=\\\"pull-right\\\"></show-debug-availability>\\r\\n            </div>\\r\\n        </div>\\r\\n        <toaster-container></toaster-container>\\r\\n        <pre ng-if=\\\"debug\\\">{{pipelineData | json}}</pre>\\r\\n    </div>\\r\\n</div>\\r\\n\");\n$templateCache.put(\"pipelines/pipelines.html\",\"<div ng-click=\\\"vm.debug.autoEnableAsNeeded($event)\\\">\\r\\n    <div class=\\\"modal-header\\\">\\r\\n        <h3 class=\\\"modal-title\\\" translate=\\\"Pipeline.Manage.Title\\\"></h3>\\r\\n    </div>\\r\\n    <div class=\\\"modal-body ng-cloak\\\">\\r\\n        <div translate=\\\"Pipeline.Manage.Intro\\\"></div>\\r\\n        <div>\\r\\n            <button icon=\\\"plus\\\" type=\\\"button\\\" class=\\\"btn btn-primary btn-square\\\" ng-click=\\\"vm.add()\\\"></button>\\r\\n            <span class=\\\"btn-group\\\" ng-if=\\\"vm.debug.on\\\">\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-warning btn-square\\\" ng-click=\\\"vm.refresh()\\\"><i icon=\\\"repeat\\\"></i></button>\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-warning btn-square\\\" ng-click=\\\"vm.liveEval()\\\"><i icon=\\\"flash\\\"></i></button>\\r\\n            </span>\\r\\n            <table class=\\\"table table-hover table-manage-eav\\\">\\r\\n                <thead>\\r\\n                <tr>\\r\\n                    <th translate=\\\"Pipeline.Manage.Table.Id\\\" class=\\\"col-id\\\"></th>\\r\\n                    <th translate=\\\"Pipeline.Manage.Table.Name\\\"></th>\\r\\n                    <th translate=\\\"Pipeline.Manage.Table.Description\\\"></th>\\r\\n                    <th translate=\\\"Pipeline.Manage.Table.Actions\\\" class=\\\"mini-btn-4\\\"></th>\\r\\n                </tr>\\r\\n                </thead>\\r\\n                <tbody>\\r\\n                <tr ng-repeat=\\\"pipeline in vm.pipelines | orderBy:\\'Name\\'\\\" class=\\\"clickable-row\\\" ng-click=\\\"vm.design(pipeline)\\\">\\r\\n                    <td class=\\\"clickable\\\">{{pipeline.Id}}</td>\\r\\n                    <td class=\\\"clickable\\\">{{pipeline.Name}}</td>\\r\\n                    <td class=\\\"clickable\\\">{{pipeline.Description}}</td>\\r\\n                    <td class=\\\"text-nowrap mini-btn-4\\\" stop-event=\\'click\\'>\\r\\n                        <span class=\\\"btn-group\\\">\\r\\n                            <button title=\\\"{{ \\'General.Buttons.Edit\\' | translate }}\\\" class=\\\"btn btn-xs\\\" ng-click=\\\"vm.edit(pipeline)\\\"><i icon=\\\"cog\\\"></i></button>\\r\\n                            <button title=\\\"{{ \\'General.Buttons.Copy\\' | translate }}\\\" type=\\\"button\\\" class=\\\"btn btn-xs\\\" ng-click=\\\"vm.clone(pipeline)\\\"><i icon=\\\"duplicate\\\"></i></button>\\r\\n                            <button title=\\\"{{ \\'General.Buttons.Permissions\\' | translate }}\\\" type=\\\"button\\\" class=\\\"btn btn-xs\\\" ng-click=\\\"vm.permissions(pipeline)\\\"><i icon=\\\"user\\\"></i></button>\\r\\n                        </span>\\r\\n                        <button title=\\\"{{ \\'General.Buttons.Delete\\' | translate }}\\\" type=\\\"button\\\" class=\\\"btn btn-xs\\\" ng-click=\\\"vm.delete(pipeline)\\\"><i icon=\\\"remove\\\"></i></button>\\r\\n                    </td>\\r\\n                </tr>\\r\\n                <tr ng-if=\\\"!vm.pipelines.length\\\">\\r\\n                    <td colspan=\\\"100\\\" translate=\\\"General.Messages.NothingFound\\\"></td>\\r\\n                </tr>\\r\\n                </tbody>\\r\\n            </table>\\r\\n        </div>\\r\\n\\r\\n        <show-debug-availability class=\\\"pull-right\\\"></show-debug-availability>\\r\\n    </div>\\r\\n\\r\\n</div>\");\n$templateCache.put(\"pipelines/query-stats.html\",\"<div class=\\\"modal-header\\\">\\r\\n    <button icon=\\\"remove\\\" class=\\\"btn pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.close()\\\"></button>\\r\\n    <h3 class=\\\"modal-title\\\" translate=\\\"Pipeline.Stats.Title\\\"></h3>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"modal-body\\\">\\r\\n    <div translate=\\\"Pipeline.Stats.Intro\\\"></div>\\r\\n\\r\\n    <div>\\r\\n        <h3 translate=\\\"Pipeline.Stats.ParamTitle\\\"></h3>\\r\\n        <div translate=\\\"Pipeline.Stats.ExecutedIn\\\" translate-values=\\\"{ ms: vm.timeUsed, ticks: vm.ticksUsed }\\\"></div>\\r\\n        <div>\\r\\n            <ul>\\r\\n                <li ng-repeat=\\\"param in vm.testParameters\\\">{{param}}</li>\\r\\n            </ul>\\r\\n        </div>\\r\\n    </div>\\r\\n\\r\\n    <div>\\r\\n        <h3 translate=\\\"Pipeline.Stats.QueryTitle\\\"></h3>\\r\\n        <pre>{{vm.result | json}}</pre>\\r\\n    </div>\\r\\n    <div>\\r\\n        <h3 translate=\\\"Pipeline.Stats.SourcesAndStreamsTitle\\\"></h3>\\r\\n        <h4 translate=\\\"Pipeline.Stats.Sources.Title\\\"></h4>\\r\\n        <table>\\r\\n            <tr>\\r\\n                <th translate=\\\"Pipeline.Stats.Sources.Guid\\\"></th>\\r\\n                <th translate=\\\"Pipeline.Stats.Sources.Type\\\"></th>\\r\\n                <th translate=\\\"Pipeline.Stats.Sources.Config\\\"></th>\\r\\n            </tr>\\r\\n            <tr ng-repeat=\\\"s in vm.sources\\\">\\r\\n                <td tooltip=\\\"{{s}}\\\"><pre>{{s.Guid.substring(0, 13)}}...</pre></td>\\r\\n                <td>{{s.Type}}</td>\\r\\n                <td tooltip=\\\"{{s.Configuration}}\\\">\\r\\n                    <ol>\\r\\n                        <li ng-repeat=\\\"(key, value) in s.Configuration\\\"><b>{{key}}</b>=<em>{{value}}</em></li>\\r\\n                    </ol>\\r\\n                </td>\\r\\n            </tr>\\r\\n        </table>\\r\\n\\r\\n        <h4 translate=\\\"Pipeline.Stats.Streams.Title\\\"></h4>\\r\\n        <table>\\r\\n            <tr>\\r\\n                <th translate=\\\"Pipeline.Stats.Streams.Source\\\"></th>\\r\\n                <th translate=\\\"Pipeline.Stats.Streams.Target\\\"></th>\\r\\n                <th translate=\\\"Pipeline.Stats.Streams.Items\\\"></th>\\r\\n                <th translate=\\\"Pipeline.Stats.Streams.Error\\\"></th>\\r\\n            </tr>\\r\\n            <tr ng-repeat=\\\"sr in vm.streams\\\">\\r\\n                <td><pre>{{sr.Source.substring(0, 13) + \\\":\\\" + sr.SourceOut}}</pre></td>\\r\\n                <td><pre>{{sr.Target.substring(0, 13) + \\\":\\\" + sr.TargetIn}}</pre></td>\\r\\n                <td><span>{{sr.Count}}</span></td>\\r\\n                <td><span>{{sr.Error}}</span></td>\\r\\n            </tr>\\r\\n        </table>\\r\\n\\r\\n    </div>\\r\\n</div>\");\n$templateCache.put(\"permissions/permissions.html\",\"    <div class=\\\"modal-header\\\">\\r\\n        <button class=\\\"btn btn-default btn-square pull-right\\\" type=\\\"button\\\" ng-click=\\\"vm.close()\\\"><i icon=\\\"remove\\\"></i></button>\\r\\n        <h3 class=\\\"modal-title\\\" translate=\\\"Permissions.Title\\\"></h3>\\r\\n    </div>\\r\\n    <div class=\\\"modal-body\\\">\\r\\n\\r\\n        <button type=\\\"button\\\" class=\\\"btn btn-primar btn-square\\\" ng-click=\\\"vm.add()\\\"><i icon=\\\"plus\\\"></i></button>\\r\\n        <button ng-if=\\\"vm.debug.on\\\" type=\\\"button\\\" class=\\\"btn btn-square\\\" ng-click=\\\"vm.refresh()\\\"><i icon=\\\"repeat\\\"></i></button>\\r\\n\\r\\n        <table class=\\\"table table-striped table-hover table-manage-eav\\\">\\r\\n            <thead>\\r\\n            <tr>\\r\\n                <th translate=\\\"Permissions.Table.Id\\\" style=\\\"width: 60px\\\"></th>\\r\\n                <th translate=\\\"Permissions.Table.Name\\\" style=\\\"width: 33%\\\"></th>\\r\\n                <th translate=\\\"Permissions.Table.Condition\\\" style=\\\"width: 33%\\\"></th>\\r\\n                <th translate=\\\"Permissions.Table.Grant\\\" style=\\\"width: 33%\\\"></th>\\r\\n                <th translate=\\\"Permissions.Table.Actions\\\" style=\\\"width: 40px\\\"></th>\\r\\n            </tr>\\r\\n            </thead>\\r\\n            <tbody>\\r\\n            <tr ng-repeat=\\\"item in vm.items | orderBy:\\'Title\\'\\\" class=\\\"clickable-row\\\" ng-click=\\\"vm.edit(item)\\\">\\r\\n                <td class=\\\"clickable\\\">{{item.Id}}</td>\\r\\n                <td class=\\\"clickable\\\">{{item.Title}}</td>\\r\\n                <td class=\\\"clickable\\\">{{item.Condition}}</td>\\r\\n                <td class=\\\"clickable\\\">{{item.Grant}}</td>\\r\\n                <td class=\\\"text-nowrap\\\" stop-event=\\\"click\\\">\\r\\n                    <button icon=\\\"remove\\\" type=\\\"button\\\" class=\\\"btn btn-xs btn-square\\\" ng-click=\\\"vm.tryToDelete(item)\\\"></button>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr ng-if=\\\"!vm.items.length\\\">\\r\\n                <td colspan=\\\"100\\\" translate=\\\"General.Messages.NothingFound\\\"></td>\\r\\n            </tr>\\r\\n            </tbody>\\r\\n        </table>\\r\\n    </div>\");}]);"],"sourceRoot":"/source/"}