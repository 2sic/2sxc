!function(){angular.module("ContentExportApp",["EavAdminUi","EavDirectives","EavConfiguration","EavServices","ContentHelperFilters","ContentFormlyTypes"])}(),function(){function e(e,t,n,a,i,r,o,l,s,d){var u=this;u.formValues={};var c=Array.isArray(n)&&n.length>0,p="Selection";u.formFields=[{key:"AppId",type:"hidden",defaultValue:e},{key:"DefaultLanguage",type:"hidden",defaultValue:s("isoLangCode")(o.defaultLanguage)},{key:"ContentType",type:"hidden",defaultValue:t},{key:"Language",type:"select",expressionProperties:{"templateOptions.label":"'Content.Export.Fields.Language.Label' | translate","templateOptions.options":function(){var e=[{name:d.instant("Content.Export.Fields.Language.Options.All"),value:""}];return angular.forEach(o.languages,function(t){var n=s("isoLangCode")(t.key);e.push({name:n,value:n})}),e}},defaultValue:""},{key:"RecordExport",type:"radio",expressionProperties:{"templateOptions.label":"'Content.Export.Fields.RecordExport.Label' | translate","templateOptions.options":function(){var e=[{name:d.instant("Content.Export.Fields.RecordExport.Options.Blank"),value:"Blank"},{name:d.instant("Content.Export.Fields.RecordExport.Options.All"),value:"All"}];return c&&e.push({name:d.instant("Content.Export.Fields.RecordExport.Options.Selection",{count:n.length}),value:p}),e}},defaultValue:c?p:"All"},{key:"LanguageReferences",type:"radio",expressionProperties:{"templateOptions.label":"'Content.Export.Fields.LanguageReferences.Label' | translate","templateOptions.disabled":function(){return"Blank"===u.formValues.RecordExport},"templateOptions.options":function(){return[{name:d.instant("Content.Export.Fields.LanguageReferences.Options.Link"),value:"Link"},{name:d.instant("Content.Export.Fields.LanguageReferences.Options.Resolve"),value:"Resolve"}]}},defaultValue:"Link"},{key:"ResourcesReferences",type:"radio",expressionProperties:{"templateOptions.label":"'Content.Export.Fields.ResourcesReferences.Label' | translate","templateOptions.disabled":function(){return"Blank"===u.formValues.RecordExport},"templateOptions.options":function(){return[{name:d.instant("Content.Export.Fields.ResourcesReferences.Options.Link"),value:"Link"},{name:d.instant("Content.Export.Fields.ResourcesReferences.Options.Resolve"),value:"Resolve"}]}},defaultValue:"Link"}],u.exportContent=function(){a.exportContent(u.formValues,c&&u.formValues.RecordExport===p?n:null)},u.close=function(){l.dismiss("cancel")}}e.$inject=["appId","contentType","itemIds","contentExportService","eavAdminDialogs","eavConfig","languages","$uibModalInstance","$filter","$translate"],angular.module("ContentExportApp").controller("ContentExport",e)}(),function(){function e(e,t){function n(e,n){var a=t.getUrlPrefix("api")+"/eav/ContentExport/ExportContent",i=n?"&selectedids="+n.join():"",r=a+"?appId="+e.AppId+"&language="+e.Language+"&defaultLanguage="+e.DefaultLanguage+"&contentType="+e.ContentType+"&recordExport="+e.RecordExport+"&resourcesReferences="+e.ResourcesReferences+"&languageReferences="+e.LanguageReferences+i;window.open(r,"_blank","")}var a={exportContent:n};return a}e.$inject=["$http","eavConfig"],angular.module("ContentExportApp").factory("contentExportService",e)}(),function(){angular.module("ContentFormlyTypes",["naif.base64","formly","formlyBootstrap","ui.bootstrap"])}(),function(){angular.module("ContentFormlyTypes").config(["formlyConfigProvider",function(e){var t=e;t.setType({name:"file",template:"<span class='btn btn-default btn-square btn-file'><span class='glyphicon glyphicon-open'></span><input type='file' ng-model='model[options.key]' base-sixty-four-input /></span> <span ng-if='model[options.key]'>{{model[options.key].filename}}</span>",wrapper:["bootstrapLabel","bootstrapHasError"]}),t.setType({name:"hidden",template:"<input style='display:none' ng-model='model[options.key]' />",wrapper:["bootstrapLabel","bootstrapHasError"]})}])}(),function(){angular.module("ContentHelperFilters",[]),angular.module("ContentHelperFilters").filter("isoLangCode",function(){return function(e){return 5!=e.length?e:e.substring(0,2).toLowerCase()+"-"+e.substring(3,5).toUpperCase()}})}(),function(){angular.module("ContentImportApp",["EavAdminUi","EavDirectives","EavConfiguration","EavServices","ContentHelperFilters","ContentFormlyTypes"])}(),function(){function e(e,t,n,a,i,r,o,l,s,d){var u=this;u.debug=o,u.formValues={},u.formFields=[{key:"AppId",type:"hidden",defaultValue:e},{key:"DefaultLanguage",type:"hidden",defaultValue:s("isoLangCode")(r.defaultLanguage)},{key:"ContentType",type:"hidden",defaultValue:t},{key:"File",type:"file",templateOptions:{required:!0},expressionProperties:{"templateOptions.label":"'Content.Import.Fields.File.Label' | translate"}},{key:"ResourcesReferences",type:"radio",expressionProperties:{"templateOptions.label":"'Content.Import.Fields.ResourcesReferences.Label' | translate","templateOptions.options":function(){return[{name:d.instant("Content.Import.Fields.ResourcesReferences.Options.Keep"),value:"Keep"},{name:d.instant("Content.Import.Fields.ResourcesReferences.Options.Resolve"),value:"Resolve"}]}},defaultValue:"Keep"},{key:"ClearEntities",type:"radio",expressionProperties:{"templateOptions.label":"'Content.Import.Fields.ClearEntities.Label' | translate","templateOptions.options":function(){return[{name:d.instant("Content.Import.Fields.ClearEntities.Options.None"),value:"None"},{name:d.instant("Content.Import.Fields.ClearEntities.Options.All"),value:"All"}]}},defaultValue:"None"}],u.viewStates={Waiting:0,Default:1,Evaluated:2,Imported:3},u.viewStateSelected=u.viewStates.Default,u.evaluationResult={},u.importResult={},u.evaluateContent=function(){return u.viewStateSelected=u.viewStates.Waiting,n.evaluateContent(u.formValues).then(function(e){u.evaluationResult=e.data,u.viewStateSelected=u.viewStates.Evaluated})},u.importContent=function(){return u.viewStateSelected=u.viewStates.Waiting,n.importContent(u.formValues).then(function(e){u.importResult=e.data,u.viewStateSelected=u.viewStates.Imported})},u.reset=function(){u.formValues={},u.evaluationResult={},u.importResult={}},u.back=function(){u.viewStateSelected=u.viewStates.Default},u.close=function(){u.viewStateSelected=u.viewStates.Default,l.dismiss("cancel")}}e.$inject=["appId","contentType","contentImportService","eavAdminDialogs","eavConfig","languages","debugState","$uibModalInstance","$filter","$translate"],angular.module("ContentImportApp").controller("ContentImport",e)}(),function(){function e(e){function t(t){return e.post("eav/ContentImport/EvaluateContent",{AppId:t.AppId,DefaultLanguage:t.DefaultLanguage,ContentType:t.ContentType,ContentBase64:t.File.base64,ResourcesReferences:t.ResourcesReferences,ClearEntities:t.ClearEntities})}function n(t){return e.post("eav/ContentImport/ImportContent",{AppId:t.AppId,DefaultLanguage:t.DefaultLanguage,ContentType:t.ContentType,ContentBase64:t.File.base64,ResourcesReferences:t.ResourcesReferences,ClearEntities:t.ClearEntities})}var a={evaluateContent:t,importContent:n};return a}e.$inject=["$http"],angular.module("ContentImportApp").factory("contentImportService",e)}(),function(){function e(e,t,n,a,i){var r=this;r.mode=e,r.entityId=t,r.contentType=n,r.TestMessage="Test message the controller is binding correctly...",r.history=function(){return a.openItemHistory(r.entityId)},r.close=function(){i.dismiss("cancel")}}e.$inject=["mode","entityId","contentType","eavAdminDialogs","$uibModalInstance"],angular.module("ContentEditApp",["EavServices","EavAdminUi"]).controller("EditContentItem",e)}(),function(){"use strict";function e(e,t,n,a,i,r,o,l,s,d,u,c,p){function m(){L=e(n,a),d.all([h(),L.getColumns()]).then(function(e){var t=I(e[1].data);R.gridOptions.api.setColumnDefs(t);var n=R.gridOptions.api.gridPanel.eBodyContainer.clientWidth,a=R.gridOptions.api.gridPanel.eBodyViewport.clientWidth;a>n&&g(n);var i=p.get();R.gridOptions.api.setFilterModel(i)})}function v(){var e=R.gridOptions.api.getFilterModel();console.log("current filter: ",e),alert("check console for filter information")}function g(e){var t=s.getTop().value.modalDomEl,n=t.children();n.css("width",e+47+"px")}function f(){i.openItemNew(a,h)}function b(){var e=null,t=!1,r=R.gridOptions.api.getFilterModel();for(var o in r)if(r.hasOwnProperty(o)){t=!0;break}return t&&(e=[],R.gridOptions.api.forEachNodeAfterFilterAndSort(function(t){e.push(t.data.Id)}),0===e.length&&(e=null)),i.openContentExport(n,a,null,e)}function y(e){i.openItemEditWithEntityId(e.data.Id,h)}function h(){var e={},t={};return R.gridOptions.api&&(e=R.gridOptions.api.getSortModel(),t=R.gridOptions.api.getFilterModel()),L.liveListSourceRead().then(function(n){R.gridOptions.api.setRowData(n.data),R.gridOptions.api.setSortModel(e),R.gridOptions.api.setFilterModel(t)})}function I(e){var t=N;return angular.forEach(e,function(e){if(e.IsTitle)return void(N[2].eavAttribute=e);var n={eavAttribute:e,headerName:e.StaticName,field:e.StaticName,cellRenderer:D,filterParams:{cellRenderer:P}};switch(e.Type){case"Entity":try{n.allowMultiValue=e.Metadata.Entity.AllowMultiValue}catch(a){n.allowMultiValue=!0}n.cellRenderer=k,n.valueGetter=T;break;case"DateTime":try{n.useTimePicker=e.Metadata.DateTime.UseTimePicker}catch(a){n.useTimePicker=!1}n.valueGetter=E;break;case"Boolean":n.valueGetter=C;break;case"Number":n.filter="number"}t.push(n)}),t}function T(e){var t=e.data[e.colDef.field];return 0===t.length?null:t.map(function(e){return e._Title})}function S(e){return[e.data.IsPublished?"is published":"is not published",e.data.Metadata?"is metadata":"is not metadata"]}function E(e){var t=e.data[e.colDef.field];return t?e.colDef.useTimePicker?t.substr(0,19).replace("T"," "):t.substr(0,10):null}function C(e){var t=e.data[e.colDef.field];return"boolean"!=typeof t?null:t.toString()}function D(e){if("string"!=typeof e.value||null===e.value)return e.value;var t=w(e.value);return'<span ng-non-bindable><span title="'+t+'">'+t+"</span></span>"}function P(e){return D(e)||"(empty)"}function w(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function k(e){if(!Array.isArray(e.value))return null;var t=w(e.value.join(", ")),n='<span title="'+t+'">';return e.colDef.allowMultiValue&&(n+='<span class="badge badge-primary">'+e.value.length+"</span> "),n+=t+"</span>"}function A(e){c.tryDeleteAndAskForce(a,e._RepositoryId,e._Title).then(h)}function O(e){var t=[{ContentTypeName:a,DuplicateEntity:e.Id}];i.openEditItems(t,L.liveListReload)}function x(){l.dismiss("cancel")}var L,R=angular.extend(this,{debug:o,gridOptions:{enableSorting:!0,enableFilter:!0,rowHeight:39,colWidth:155,headerHeight:38,angularCompileRows:!0},add:f,refresh:h,openExport:b,tryToDelete:A,openDuplicate:O,close:x,debugFilter:v}),N=[{headerName:"ID",field:"Id",width:50,template:'<span tooltip-append-to-body="true" uib-tooltip="Id: {{data.Id}}\nRepoId: {{data._RepositoryId}}\nGuid: {{data.Guid}}" ng-bind="data.Id"></span>',cellClass:"clickable",filter:"number",onCellClicked:y},{headerName:"Status",field:"IsPublished",width:75,suppressSorting:!0,template:"<span class=\"glyphicon\" ng-class=\"{'glyphicon-eye-open': data.IsPublished, 'glyphicon-eye-close' : !data.IsPublished}\" tooltip-append-to-body=\"true\" uib-tooltip=\"{{ 'Content.Publish.' + (data.IsPublished ? 'PnV': data.IsPublishedEntity ? 'DoP' : 'D') | translate }}\"></span> <span icon=\"{{ data.DraftEntity || data.PublishedEntity ? 'link' : '' }}\" tooltip-append-to-body=\"true\" uib-tooltip=\"{{ (data.DraftEntity ? 'Content.Publish.HD' :'') | translate:'{ id: data.DraftEntity._RepositoryId }' }} {{ data.DraftEntity._RepositoryId }}\n{{ (data.PublishedEntity ? 'Content.Publish.HP' :'') | translate }} {{ data.PublishedEntity._RepositoryId }}\"></span> <span ng-if=\"data.Metadata\" tooltip-append-to-body=\"true\" uib-tooltip=\"Metadata for type {{ data.Metadata.TargetType}}, id {{ data.Metadata.KeyNumber }}{{ data.Metadata.KeyString }}{{ data.Metadata.KeyGuid }}\" icon=\"tag\"></span>",valueGetter:S},{headerName:"Title",field:"_Title",width:216,cellClass:"clickable",template:"<span tooltip-append-to-body=\"true\" uib-tooltip=\"{{data._Title}}\" ng-bind=\"data._Title + ' ' + ((!data._Title ? 'Content.Manage.NoTitle':'') | translate)\"></span>",filter:"text",onCellClicked:y},{headerName:"",width:70,suppressSorting:!0,suppressMenu:!0,template:'<button type="button" class="btn btn-xs btn-square" ng-click="vm.openDuplicate(data)" tooltip-append-to-body="true" uib-tooltip="{{ \'General.Buttons.Copy\' | translate }}"><i icon="duplicate"></i></button> <button type="button" class="btn btn-xs btn-square" ng-click="vm.tryToDelete(data, false)" tooltip-append-to-body="true" uib-tooltip="{{ \'General.Buttons.Delete\' | translate }}"><i icon="remove"></i> </button>'}];m()}e.$inject=["contentItemsSvc","eavConfig","appId","contentType","eavAdminDialogs","toastr","debugState","$uibModalInstance","$uibModalStack","$q","$translate","entitiesSvc","agGridFilters"],angular.module("ContentItemsAppAgnostic",["EavConfiguration","EavAdminUi","EavServices"]).controller("ContentItemsList",e)}(),function(){"use strict";angular.module("ContentItemsAppAgnostic").factory("agGridFilters",function(){return{get:function(){if(!window.$2sxc)return{};var e=window.$2sxc.urlParams.get("filters"),t=null;if(!e)return{};"="===e.charAt(e.length-1)&&(e=atob(e));try{t=JSON.parse(e),console.log("found filters for this list:",t)}catch(n){console.log("can't parse json with filters from url: ",e)}if(!t)return{};t.IsPublished===!0?t.IsPublished=["is published"]:t.IsPublished===!1&&console.warn("filter ispublished = false is not implemented yet"),"undefined"!=typeof t.IsMetadata&&(Array.isArray(t.IsPublished)||(t.IsPublished=[]),t.IsPublished.push(t.IsMetadata?"is metadata":"is not metadata"),delete t.IsMetadata);for(var a in t)t.hasOwnProperty(a)&&"number"==typeof t[a]&&(t[a]={filter:t[a],type:1});return console.log("will try to apply filter: ",t),t}}})}(),function(){function e(e,t,n,a,i){var r=this,o=n(e,t);r.entityId=t,r.items=o.liveList(),r.close=function(){a.dismiss("cancel")},r.details=function(e){i.open({animation:!0,templateUrl:"content-items/history-details.html",controller:"HistoryDetails",controllerAs:"vm",resolve:{changeId:function(){return e.ChangeId},dataSvc:function(){return o}}})}}function t(e,t,n){var a=this;alert("not implemented yet");var i=t;i.getVersionDetails(e).then(function(e){alert(e.data),a.items=e.data}),a.close=function(){n.dismiss("cancel")}}e.$inject=["appId","entityId","historySvc","$uibModalInstance","$uibModal"],t.$inject=["changeId","dataSvc","$uibModalInstance"],angular.module("HistoryApp",["EavServices","EavConfiguration","eavTemplates"]).controller("History",e).controller("HistoryDetails",t)}(),function(){angular.module("ContentTypesApp",["EavServices","EavAdminUi","EavDirectives"]).constant("license",{createdBy:"2sic internet solutions",license:"MIT"})}(),function(){function contentTypeListController(contentTypeSvc,eavAdminDialogs,appId,debugState,$translate,eavConfig){var vm=this,svc=contentTypeSvc(appId);vm.debug=debugState,vm.items=svc.liveList(),vm.refresh=svc.liveListReload,vm.tryToDelete=function(e){$translate("General.Questions.Delete",{target:"'"+e.Name+"' ("+e.Id+")"}).then(function(t){confirm(t)&&svc["delete"](e)})},vm.edit=function(e){void 0===e&&(e=svc.newItem()),eavAdminDialogs.openContentTypeEdit(e,vm.refresh)},vm.createGhost=function(){var e=window.prompt("to create a ghost content-type enter source static name / id - this is a very advanced operation - read more about it on 2sxc.org/help?tag=ghost");e&&svc.createGhost(e)},vm.editFields=function(e){eavAdminDialogs.openContentTypeFields(e,vm.refresh)},vm.editItems=function(e){eavAdminDialogs.openContentItems(svc.appId,e.StaticName,e.Id,vm.refresh)},vm.addItem=function(e){eavAdminDialogs.openItemNew(e,vm.refresh)},vm.liveEval=function admin(){$translate("General.Questions.SystemInput").then(function(msg){var inp=prompt(msg);inp&&eval(inp)})},vm.changeScope=function(){$translate("ContentTypes.Buttons.ChangeScopeQuestion").then(function(e){var t=prompt(e);t&&svc.setScope(t)})},vm.isGuid=function(e){var t=new RegExp(/[a-f0-9]{8}(?:-[a-f0-9]{4}){3}-[a-f0-9]{12}/i);return t.test(e)},vm.permissions=function(e){return eavAdminDialogs.openPermissionsForGuid(svc.appId,e.StaticName,vm.refresh)},vm.openExport=function(e){return eavAdminDialogs.openContentExport(svc.appId,e.StaticName,vm.refresh)},vm.openImport=function(e){return eavAdminDialogs.openContentImport(svc.appId,e.StaticName,vm.refresh)},vm.createOrEditMetadata=function(e){var t=[vm.createItemDefinition(e,"ContentType")];eavAdminDialogs.openEditItems(t,svc.liveListReload)},vm.createItemDefinition=function(e,t){var n="ContentType Metadata";return e.Metadata?{EntityId:e.Metadata.Id,Title:n}:{ContentTypeName:t,Metadata:{Key:e.StaticName,KeyType:"string",TargetType:eavConfig.metadataOfContentType},Title:n,Prefill:{Label:e.Name,Description:e.Description}}}}contentTypeListController.$inject=["contentTypeSvc","eavAdminDialogs","appId","debugState","$translate","eavConfig"],angular.module("ContentTypesApp").controller("List",contentTypeListController)}(),function(){function e(e,t,n,a,i,r){var o=this,l=n(e);o.debug=a,o.item=t,o.item.ChangeStaticName=!1,o.item.NewStaticName=o.item.StaticName,o.ok=function(){l.save(t).then(function(){r.close(o.item)})},o.close=function(){r.dismiss("cancel")}}e.$inject=["appId","item","contentTypeSvc","debugState","$translate","$uibModalInstance"],angular.module("ContentTypesApp").controller("Edit",e)}(),function(){function e(e,t,n,a,i){var r=this;r.items=[n],r.types=t.types.liveList(),r.allInputTypes=t.getInputTypesList(),r.resetSubTypes=function(e){e.InputType=e.Type.toLowerCase()+"-default"},r.ok=function(){t.updateInputType(r.items[0]),i.close()},r.close=function(){i.dismiss("cancel")}}e.$inject=["appId","svc","item","$filter","$uibModalInstance"],angular.module("ContentTypesApp").controller("FieldEdit",e)}(),function(){function e(e,t,n,a){var i=this,r=t.newItem;i.items=[r(),r(),r(),r(),r(),r(),r(),r(),r(),r()],i.item=t.newItem(),i.types=t.types.liveList(),i.allInputTypes=t.getInputTypesList(),i.resetSubTypes=function(e){e.InputType=e.Type.toLowerCase()+"-default"},i.ok=function(){for(var e=i.items,n=[],r=0;r<e.length;r++)e[r].StaticName&&n.push(e[r]);t.addMany(n,0),a.close()},i.close=function(){a.dismiss("cancel")}}e.$inject=["appId","svc","$filter","$uibModalInstance"],angular.module("ContentTypesApp").controller("FieldsAdd",e)}(),function(){function e(e,t,n,a,i,r,o,l,s,d){var u=this,c=t(e,n);u.close=function(){a.dismiss("cancel")},u.items=c.liveList(),u.orderList=function(){var e=[];return u.items.map(function(t,n){e.push(t.Id)}),e},u.treeOptions={dropped:function(){u.dragEnabled=!1,c.reOrder(u.orderList()).then(function(){u.dragEnabled=!0})}},u.dragEnabled=!0,u.add=function(){i.open({animation:!0,templateUrl:"content-types/content-types-fields-add.html",controller:"FieldsAdd",controllerAs:"vm",size:"lg",resolve:{svc:function(){return c}}})},u.edit=function(e){i.open({animation:!0,templateUrl:"content-types/content-types-field-edit.html",controller:"FieldEdit",controllerAs:"vm",size:"lg",resolve:{svc:function(){return c},item:function(){return e}}})},u.inputTypeTooltip=function(e){return"unknown"!==e?e:"unknown means it's using an old definition for input-types - edit it to use the new definition"},u.setTitle=c.setTitle,u.tryToDelete=function(e){return e.IsTitle?l(["General.Messages.CantDelete","General.Terms.Title"],{target:"{0}"}).then(function(e){alert(e["General.Messages.CantDelete"].replace("{0}",e["General.Terms.Title"]))}):l("General.Questions.Delete",{target:"'"+e.StaticName+"' ("+e.Id+")"}).then(function(t){confirm(t)&&c["delete"](e)})},u.rename=function(e){l("General.Questions.Rename",{target:"'"+e.StaticName+"' ("+e.Id+")"}).then(function(t){var n=prompt(t);n&&c.rename(e,n)})},u.createOrEditMetadata=function(e,t){var n=[u.createItemDefinition(e,"All"),u.createItemDefinition(e,t),u.createItemDefinition(e,e.InputType)];r.openEditItems(n,c.liveListReload)},u.createItemDefinition=function(e,t){var n="All"===t?l.instant("DataType.All.Title"):t;return void 0!==e.Metadata[t]?{EntityId:e.Metadata[t].Id,Title:n}:{ContentTypeName:"@"+t,Metadata:{Key:e.Id,KeyType:"number",TargetType:s.metadataOfAttribute},Title:n,Prefill:{Name:e.StaticName}}}}e.$inject=["appId","contentTypeFieldSvc","contentType","$uibModalInstance","$uibModal","eavAdminDialogs","$filter","$translate","eavConfig","$scope"],angular.module("ContentTypesApp").controller("FieldList",e)}(),function(){angular.module("EavDirectives",[]).directive("icon",function(){return{restrict:"A",replace:!1,transclude:!1,link:function(e,t,n){var a=n.icon;t.addClass("glyphicon glyphicon-"+a)}}}).directive("stopEvent",function(){return{restrict:"A",link:function(e,t,n){n&&n.stopEvent&&t.bind(n.stopEvent,function(e){e.stopPropagation()})}}}).directive("showDebugAvailability",["eavConfig",function(e){return{restrict:"E",scope:{},template:'<span class="debug-indicator low-priority" ng-class=\'{ "debug-enabled": debugState.on }\' uib-tooltip="{{ \'AdvancedMode.Info.Available\' | translate }} \n'+e.versionInfo+"\" ng-click='askForLogging()'>&pi;</span><br/>",controller:["$scope","debugState","toastr",function(e,t,n){function a(){var e=prompt("enable extended logging? type desired duration in minutes:",1);null!==e&&void 0!==e&&t.enableExtendedLogging(e).then(function(e){console.log(e.data),n.info(e.data,{timeOut:1e3})})}e.debugState=t,e.askForLogging=function(){t.on&&a()}}]}}])}(),function(){function e(e,t,n,a,i,r){var o=this,l=e(a,i);o.edit=function(e){t.openItemEditWithEntityId(e.Id,l.liveListReload)},o.add=function(){t.openMetadataNew(a,"entity",l.PermissionTargetGuid,l.ctName,l.liveListReload)},o.items=l.liveList(),o.refresh=l.liveListReload,o.tryToDelete=function(e){confirm("Delete '"+e.Title+"' ("+e.Id+") ?")&&l["delete"](e.Id)},o.close=function(){r.dismiss("cancel")}}e.$inject=["permissionsSvc","eavAdminDialogs","eavConfig","appId","targetGuid","$uibModalInstance"],angular.module("PermissionsApp",["EavServices","EavConfiguration","EavAdminUi"]).controller("PermissionList",e)}(),angular.module("PipelineDesigner",["PipelineDesigner.filters","ngResource","EavConfiguration","EavServices","eavTemplates","eavNgSvcs","EavAdminUi","eavEditEntity"]).directive("datasource",["$timeout",function(e){return{restrict:"A",link:function(t,n){e(function(){t.makeDataSource(t.dataSource,n)}),t.$last===!0&&e(function(){t.$emit("ngRepeatFinished")})}}}]),angular.module("PipelineDesigner.filters",[]).filter("typename",function(){return function(e,t){var n=e.match(/[^,\s]+/g);switch(t){case"classFullName":if(n)return n[0];break;case"className":if(n){var a=n[0].match(/[^\.]+/g);return a[a.length-1]}}return e}}),function(){function e(e){var t=document.documentElement,n=e.getBoundingClientRect(),a=n.top+window.pageYOffset-t.clientTop,i=n.left+window.pageXOffset-t.clientLeft;return{top:a,left:i}}angular.module("PipelineDesigner").controller("PipelineDesignerController",["appId","pipelineId","$scope","pipelineService","$location","debugState","$timeout","ctrlS","$filter","toastrWithHttpErrorHandling","eavAdminDialogs","$log","eavConfig","$q","getUrlParamMustRefactor",function(t,n,a,i,r,o,l,s,d,u,c,p,m,v,g){"use strict";function f(){y.saveShortcut=s(function(){y.savePipeline()})}function b(e,t){var n,a,i=/^\[module:moduleid\]=([0-9]*)$/gim,r=t.warnings=[];try{n=e.Pipeline.TestParameters;var o=i.exec(n);o&&0!==o.length||r.push("Your test values has no moduleid specified. You probably want to check your test-values."),a=o[1];var l=g("mid");a!==l&&r.push("Your test moduleid ("+a+") is different from the current moduleid ("+l+"). You probably want to check your test-values.")}catch(s){}}var y=this;y.debug=o,y.warnings=[];var h=u,I=h.info("This shouldn't take long","Please wait...");f(),a.readOnly=!0,a.dataSourcesCount=0,a.dataSourceIdPrefix="dataSource_",a.debug=!1,a.PipelineEntityId=n,i.setAppId(t),a.findDataSourceOfElement=function(e){var t=e.attributes.guid.value,n=a.pipelineData.DataSources,i=d("filter")(n,{EntityGuid:t})[0];return i},i.getPipeline(a.PipelineEntityId).then(function(e){a.pipelineData=e,a.PipelineEntityId&&1!==a.pipelineData.DataSources.length?(a.readOnly=!e.Pipeline.AllowEdit,h.clear(I),h.info(a.readOnly?"This pipeline is read only":"You can now design the Pipeline. \nNote that there are still a few UI bugs.\nVisit 2sxc.org/help for more.","Ready",{autoDismiss:!0})):(a.readOnly=!1,P()),b(a.pipelineData,y)},function(e){h.error(e,"Loading Pipeline failed")}),jsPlumb.ready(function(){a.jsPlumbInstance=jsPlumb.getInstance({Connector:["Bezier",{curviness:70}],HoverPaintStyle:{lineWidth:4,strokeStyle:"#216477",outlineWidth:2,outlineColor:"white"},PaintStyle:{lineWidth:4,strokeStyle:"#61B7CF",joinstyle:"round",outlineColor:"white",outlineWidth:2},Container:"pipelineContainer"}),a.jsPlumbInstance.bind("connectionDetached",function(e){if(e.targetId===a.dataSourceIdPrefix+"Out"){var t=angular.element(e.target),n=a.findDataSourceOfElement(t).dataSource.Definition().In,i=e.targetEndpoint.getOverlay("endpointLabel").label;-1===n.indexOf(i)&&l(function(){a.jsPlumbInstance.deleteEndpoint(e.targetEndpoint)})}}),a.jsPlumbInstance.bind("connection",function(e){if(a.connectionsInitialized)for(var t=0,n=function(t){var n=t.getOverlay("endpointLabel").getLabel();n===o&&e.targetEndpoint.id!==t.id&&angular.element(t.canvas).hasClass("targetEndpoint")&&(s=t)};;){t++;var i="Please name the Stream";t>1&&(i+=". Ensure the name is not used by any other Stream on this DataSource.");var r=e.targetEndpoint.getOverlay("endpointLabel"),o=prompt(i,r.getLabel());if(o){r.setLabel(o);var l=a.jsPlumbInstance.getEndpoints(e.target.id),s=null;if(angular.forEach(l,n),!s)break}}})});var T=function(e){return[["Label",{id:"endpointLabel",location:[.5,e?-.5:1.5],label:"Default",cssClass:"noselect "+(e?"endpointSourceLabel":"endpointTargetLabel"),events:{dblclick:function(e){if(!a.readOnly){var t=prompt("Rename Stream",e.label);t&&e.setLabel(t)}}}}]]},S={paintStyle:{fillStyle:"transparent",radius:10,lineWidth:0},cssClass:"sourceEndpoint",maxConnections:-1,isSource:!0,anchor:["Continuous",{faces:["top"]}],overlays:T(!0)},E={paintStyle:{fillStyle:"transparent",radius:10,lineWidth:0},cssClass:"targetEndpoint",maxConnections:1,isTarget:!0,anchor:["Continuous",{faces:["bottom"]}],overlays:T(!1),dropOptions:{hoverClass:"hover",activeClass:"active"}};a.makeDataSource=function(e,t){a.jsPlumbInstance.batch(function(){a.readOnly||a.jsPlumbInstance.draggable(t,{grid:[20,20],drag:a.dataSourceDrag});var n=e.Definition();if(null!==n){if(angular.forEach(n.Out,function(e){C(t,e,!1)}),angular.forEach(n.In,function(e){C(t,e,!0)}),n.In){var i=E;i.maxConnections=-1,a.jsPlumbInstance.makeTarget(t,i)}a.jsPlumbInstance.makeSource(t,S,{filter:".ep .glyphicon"})}}),a.dataSourcesCount++};var C=function(e,t,n){if(!e.length)return void p.error({message:"Element not found",selector:e.selector});console.log(e);var i=a.findDataSourceOfElement(e[0]),r=e[0].id+(n?"_in_":"_out_")+t,o={uuid:r,enabled:!i.ReadOnly||"Out"==i.EntityGuid},l=a.jsPlumbInstance.addEndpoint(e,n?E:S,o);l.getOverlay("endpointLabel").setLabel(t)};a.connectionsInitialized=!1,a.$on("ngRepeatFinished",function(){a.connectionsInitialized||(a.jsPlumbInstance.batch(function(){D(a.pipelineData.Pipeline.StreamWiring)}),a.repaint(),a.connectionsInitialized=!0)});var D=function(e){angular.forEach(e,function(e){var t=a.dataSourceIdPrefix+e.From,n=t+"_out_"+e.Out,i=a.dataSourceIdPrefix+e.To,r=i+"_in_"+e.In;a.jsPlumbInstance.getEndpoint(n)||C(jsPlumb.getSelector("#"+t),e.Out,!1),a.jsPlumbInstance.getEndpoint(r)||C(jsPlumb.getSelector("#"+i),e.In,!0);try{a.jsPlumbInstance.connect({uuids:[n,r]})}catch(o){p.error({message:"Connection failed",from:n,to:r})}})},P=function(){var e=m.pipelineDesigner.defaultPipeline.dataSources;angular.forEach(e,function(e){a.addDataSource(e.partAssemblyAndType,e.visualDesignerData,!1,e.entityGuid)});var t=a.$on("ngRepeatFinished",function(){a.connectionsInitialized=!1,D(m.pipelineDesigner.defaultPipeline.streamWiring),a.connectionsInitialized=!0,t()})};a.addDataSource=function(e,t,n,r){e||(e=a.addDataSourceType.PartAssemblyAndType,a.addDataSourceType=null),t||(t={Top:100,Left:100});var o={VisualDesignerData:t,Name:d("typename")(e,"className"),Description:"",PartAssemblyAndType:e,EntityGuid:r||"unsaved"+(a.dataSourcesCount+1)};o=angular.extend(o,i.getNewDataSource(a.pipelineData,o)),a.pipelineData.DataSources.push(o),n!==!1&&a.savePipeline()},a.remove=function(e){var t=a.pipelineData.DataSources[e];if(confirm('Delete DataSource "'+(t.Name||"(unnamed)")+'"?')){var n=a.dataSourceIdPrefix+t.EntityGuid;a.jsPlumbInstance.selectEndpoints({element:n}).remove(),a.pipelineData.DataSources.splice(e,1)}},a.editName=function(e){if(!e.ReadOnly){var t=prompt("Rename DataSource",e.Name);t&&t.trim()&&(e.Name=t.trim())}},a.editDescription=function(e){if(!e.ReadOnly){var t=prompt("Edit Description",e.Description);t&&t.trim()&&(e.Description=t.trim())}},a.dataSourceDrag=function(t){var n=e(t.el),i=a.findDataSourceOfElement(t.el);a.$apply(function(){i.VisualDesignerData.Top=Math.round(n.top),i.VisualDesignerData.Left=Math.round(n.left)})},a.configureDataSource=function(e){return e.ReadOnly?void 0:w(e)?void i.editDataSourcePart(e,a.pipelineData.InstalledDataSources):void a.savePipeline()};var w=function(e){return-1===e.EntityGuid.indexOf("unsaved")};a.showEndpointOverlays=!0,a.toggleEndpointOverlays=function(){a.showEndpointOverlays=!a.showEndpointOverlays;var e=a.jsPlumbInstance.selectEndpoints();a.showEndpointOverlays?e.showOverlays():e.hideOverlays()},a.editPipelineEntity=function(){a.savePipeline().then(function(){y.saveShortcut.unbind(),c.openEditItems([{EntityId:a.PipelineEntityId}],function(){i.getPipeline(a.PipelineEntityId).then(A).then(y.saveShortcut.rebind)})})};var k=function(){var e=[];angular.forEach(a.jsPlumbInstance.getAllConnections(),function(t){e.push({From:t.sourceId.substr(a.dataSourceIdPrefix.length),Out:t.endpoints[0].getOverlay("endpointLabel").label,To:t.targetId.substr(a.dataSourceIdPrefix.length),In:t.endpoints[1].getOverlay("endpointLabel").label})}),a.pipelineData.Pipeline.StreamWiring=e;var t=[];a.jsPlumbInstance.selectEndpoints({target:a.dataSourceIdPrefix+"Out"}).each(function(e){t.push(e.getOverlay("endpointLabel").label)}),a.pipelineData.Pipeline.StreamsOut=t.join(",")};y.savePipeline=a.savePipeline=function(e){h.info("This shouldn't take long","Saving...");a.readOnly=!0,k();var t=v.defer();return"undefined"==typeof e&&(e=A),i.savePipeline(a.pipelineData.Pipeline,a.pipelineData.DataSources).then(e,function(e){h.error(e,"Save Pipeline failed"),a.readOnly=!1,t.reject()}).then(function(){t.resolve()}),t.promise};var A=function(e){a.pipelineData.Pipeline=e.Pipeline,a.pipelineData.TestParameters=e.TestParameters,a.PipelineEntityId=e.Pipeline.EntityId,r.search("PipelineId",e.Pipeline.EntityId),a.readOnly=!e.Pipeline.AllowEdit,a.pipelineData.DataSources=e.DataSources,i.postProcessDataSources(a.pipelineData),h.clear(),h.success("Pipeline "+e.Pipeline.EntityId+" saved and loaded","Saved",{autoDismiss:!0}),a.jsPlumbInstance.reset(),a.connectionsInitialized=!1,b(a.pipelineData,y)};a.repaint=function(){a.jsPlumbInstance.repaintEverything()},a.toogleDebug=function(){a.debug=!a.debug},a.queryPipeline=function(e){var t=function(){h.info("Running Query ..."),i.queryPipeline(a.PipelineEntityId).then(function(e){h.clear();var t=c.CreateResolve({testParams:a.pipelineData.Pipeline.TestParameters,result:e});c.OpenModal("pipelines/query-stats.html","QueryStats as vm","lg",t),l(function(){n(e)}),p.debug(e)},function(e){h.error(e,"Query failed")})},n=function(e){angular.forEach(e.Streams,function(e){var t=a.dataSourceIdPrefix+e.Source,n=a.dataSourceIdPrefix+e.Target;"00000000-0000-0000-0000-000000000000"===e.Target&&(n=a.dataSourceIdPrefix+"Out");var i=t+"_out_"+e.SourceOut,r=n+"_in_"+e.TargetIn,o=a.jsPlumbInstance.getEndpoint(i),l=!1;o&&angular.forEach(o.connections,function(t){return t.endpoints[1].getUuid()===r?(t.setLabel({
label:e.Count.toString(),cssClass:"streamEntitiesCount"}),void(l=!0)):void 0}),l||p.error("Stream not found",e,o)})};e?a.savePipeline().then(t):t()},a.clonePipeline=function(){if(confirm("Clone Pipeline "+a.PipelineEntityId+"?")){var e=function(){return i.clonePipeline(a.PipelineEntityId)},t=function(e){return i.getPipeline(e.EntityId)};a.savePipeline(null).then(e).then(t).then(A)}}}])}(),angular.module("PipelineManagement",["EavServices","EavConfiguration","eavNgSvcs","EavAdminUi"]).controller("PipelineManagement",["$uibModalInstance","appId","pipelineService","debugState","eavAdminDialogs","eavConfig",function($uibModalInstance,appId,pipelineService,debugState,eavAdminDialogs,eavConfig){var vm=this;vm.debug=debugState,vm.appId=appId,pipelineService.setAppId(appId),vm.refresh=function(){vm.pipelines=pipelineService.getPipelines(appId)},vm.refresh(),vm["delete"]=function(e){confirm('Delete Pipeline "'+e.Name+'" ('+e.Id+")?")&&pipelineService.deletePipeline(e.Id).then(function(){vm.refresh()},function(e){alert(e)})},vm.clone=function(e){pipelineService.clonePipeline(e.Id).then(function(){vm.refresh()},function(e){alert(e)})},vm.permissions=function(e){return eavAdminDialogs.openPermissionsForGuid(appId,e.Guid)},vm.add=function(){var e=[{ContentTypeName:"DataPipeline",Prefill:{TestParameters:eavConfig.pipelineDesigner.testParameters}}];eavAdminDialogs.openEditItems(e,vm.refresh)},vm.edit=function(e){eavAdminDialogs.openItemEditWithEntityId(e.Id,vm.refresh)},vm.design=function(e){return eavAdminDialogs.editPipeline(vm.appId,e.Id,vm.refresh)},vm.liveEval=function admin(){var inp=prompt("This is for very advanced operations. Only use this if you know what you're doing. \n\n Enter admin commands:");inp&&eval(inp)},vm.close=function(){$uibModalInstance.dismiss("cancel")}}]),function(){angular.module("PipelineDesigner").controller("QueryStats",["testParams","result","$uibModalInstance",function(e,t,n){var a=this,i=t;a.testParameters=e.split("\n"),a.timeUsed=i.QueryTimer.Milliseconds,a.ticksUsed=i.QueryTimer.Ticks,a.result=i.Query,a.sources=i.Sources,a.streams=i.Streams,a.connections="todo",a.close=function(){n.dismiss("cancel")}}])}(),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length),t-=e.length;var a=n.lastIndexOf(e,t);return-1!==a&&a===t}),angular.module("EavServices",["ng","EavConfiguration","pascalprecht.translate","ngResource","ngAnimate","toastr"]),angular.module("EavServices").factory("contentItemsSvc",["$http","entitiesSvc","metadataSvc","svcCreator",function(e,t,n,a){return function(n,i){var r={};return r.contentType=i,r.appId=n,r=angular.extend(r,a.implementLiveList(function(){return e.get("eav/entities/GetAllOfTypeForAdmin",{params:{appId:r.appId,contentType:r.contentType}})})),r["delete"]=function(e,n){return t["delete"](r.contentType,e,n)},r.getColumns=function(){return e.get("eav/contenttype/getfields/",{params:{appid:r.appId,staticName:r.contentType}})},r}}]),angular.module("EavServices").factory("contentTypeSvc",["$http","eavConfig","svcCreator",function(e,t,n){return function(a,i){var r={};return r.scope=i||t.contentType.defaultScope,r.appId=a,r.retrieveContentTypes=function(){return e.get("eav/contenttype/get/",{params:{appid:r.appId,scope:r.scope}})},r=angular.extend(r,n.implementLiveList(r.retrieveContentTypes)),r.getDetails=function(t,n){return e.get("eav/contenttype/GetSingle",angular.extend({},n,{params:{appid:r.appId,contentTypeStaticName:t}}))},r.newItem=function(){return{StaticName:"",Name:"",Description:"",Scope:t.contentType.defaultScope}},r.save=function(t){return e.post("eav/contenttype/save/",t,{params:{appid:r.appId}}).then(r.liveListReload)},r["delete"]=function(t){return e.get("eav/contenttype/delete",{params:{appid:r.appId,staticName:t.StaticName}}).then(r.liveListReload)},r.setScope=function(e){r.scope=e,r.liveListReload()},r.createGhost=function(t){return e.get("eav/contenttype/createghost",{params:{appid:r.appId,sourceStaticName:t}}).then(r.liveListReload)},r}}]),angular.module("EavServices").factory("contentTypeFieldSvc",["$http","eavConfig","svcCreator","$filter",function(e,t,n,a){return function(t,i){var r={};return r.appId=t,r.contentType=i,r.typeListRetrieve=function(){return e.get("eav/contenttype/datatypes/",{params:{appid:r.appId}})},r._inputTypesList=[],r.getInputTypesList=function(){return r._inputTypesList.length>0?r._inputTypesList:(e.get("eav/contenttype/inputtypes/",{params:{appid:r.appId}}).then(function(e){function t(e,t){var n={dataType:e.Type.substring(0,e.Type.indexOf("-")),inputType:e.Type,label:e.Label,description:e.Description};r._inputTypesList.push(n)}angular.forEach(e.data,t),r._inputTypesList=a("orderBy")(r._inputTypesList,["dataType","inputType"])}),r._inputTypesList)},r.getFields=function(){return e.get("eav/contenttype/getfields",{params:{appid:r.appId,staticName:r.contentType.StaticName}}).then(function(e){if(e.data)for(var t=0;t<e.data.length;t++){var n=e.data[t];if(n.Metadata){var a=n.Metadata,i=a.All,r=a[n.Type],o=a[n.InputType];a.merged=angular.merge({},i,r,o)}}return e})},r=angular.extend(r,n.implementLiveList(r.getFields)),r.types=n.implementLiveList(r.typeListRetrieve),r.reOrder=function(t){return console.log(t),e.get("eav/contenttype/reorder",{params:{appid:r.appId,contentTypeId:r.contentType.Id,newSortOrder:JSON.stringify(t)}}).then(r.liveListReload)},r["delete"]=function(t){return e.get("eav/contenttype/delete",{params:{appid:r.appId,contentTypeId:r.contentType.Id,attributeId:t.Id}}).then(r.liveListReload)},r.addMany=function(t,n){return e.get("eav/contenttype/addfield/",{params:t[n]}).then(function(){t.length===++n?r.liveListReload():r.addMany(t,n)})},r.add=function(t){return e.get("eav/contenttype/addfield/",{params:t}).then(r.liveListReload)},r.newItemCount=0,r.newItem=function(){return{AppId:r.appId,ContentTypeId:r.contentType.Id,Id:0,Type:"String",InputType:"string-default",StaticName:"",IsTitle:0===r.liveList().length,SortOrder:r.liveList().length+r.newItemCount++}},r["delete"]=function(t){if(t.IsTitle)throw"Can't delete Title";return e.get("eav/contenttype/deletefield",{params:{appid:r.appId,contentTypeId:r.contentType.Id,attributeId:t.Id}}).then(r.liveListReload)},r.updateInputType=function(t){return e.get("eav/contenttype/updateinputtype",{params:{appid:r.appId,attributeId:t.Id,field:t.StaticName,inputType:t.InputType}}).then(r.liveListReload)},r.setTitle=function(t){return e.get("eav/contenttype/setTitle",{params:{appid:r.appId,contentTypeId:r.contentType.Id,attributeId:t.Id}}).then(r.liveListReload)},r.rename=function(t,n){return e.get("eav/contenttype/rename",{params:{appid:r.appId,contentTypeId:r.contentType.Id,attributeId:t.Id,newName:n}}).then(r.liveListReload)},r}}]),angular.module("EavServices").factory("ctrlS",["$window",function(e){function t(t){var n={_event:null,_action:null,_isbound:!1,detectCtrlSAndExcecute:function(e){if(83===e.keyCode&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)){if(null===n._action)return console.log("can't do anything on ctrl+S, no action registered");e.preventDefault(),n._action()}},bind:function(t){n._action=t,n._isbound=!0,n._event=e.addEventListener("keydown",n.detectCtrlSAndExcecute,!1)},unbind:function(){e.removeEventListener("keydown",n.detectCtrlSAndExcecute),n._isbound=!1},rebind:function(){if(null===n._action)throw"can't rebind, as it was never initially bound";if(!n._isbound)throw"can't rebind, as it's still bound";n.bind(n._action)}};return n.bind(t),n}return t}]),angular.module("EavServices").factory("debugState",["$translate","toastr","$http",function(e,t,n){var a={on:!1};return a.toggle=function(){a.on=!a.on,t.clear(a.toast),a.toast=t.info(e.instant("AdvancedMode.Info.Turn"+(a.on?"On":"Off")),{timeOut:3e3})},a.autoEnableAsNeeded=function(e){e=window.event||e;var t=navigator.platform.match("Mac")?e.metaKey:e.ctrlKey;t&&!e.alreadySwitchedDebugState&&(a.toggle(),e.alreadySwitchedDebugState=!0)},a.enableExtendedLogging=function(e){return n.get("app-sys/system/extendedlogging",{params:{duration:e}})},a}]),angular.module("EavServices").factory("dragClass",function(){return document.addEventListener("dragover",function(){this===document&&document.body.classList.add("eav-dragging")}),document.addEventListener("dragleave",function(){this===document&&document.body.classList.remove("eav-dragging")}),{}}),angular.module("EavAdminUi",["ng","ui.bootstrap","EavServices","eavTemplates","PermissionsApp","ContentItemsAppAgnostic","PipelineManagement","ContentImportApp","ContentExportApp","HistoryApp"]).factory("eavAdminDialogs",["$uibModal","eavConfig","$window","entitiesSvc","contentTypeSvc","appId",function(e,t,n,a,i,r){var o={};return o.openContentItems=function(e,t,n,a){var i=o.CreateResolve({appId:e,contentType:t,contentTypeId:n});return o.OpenModal("content-items/content-items-agnostic.html","ContentItemsList as vm","fullscreen",i,a)},o.openContentImport=function(e,t,n){var a=o.CreateResolve({appId:e,contentType:t});return o.OpenModal("content-import-export/content-import.html","ContentImport as vm","lg",a,n)},o.openContentExport=function(e,t,n,a){var i=o.CreateResolve({appId:e,contentType:t,itemIds:a});return o.OpenModal("content-import-export/content-export.html","ContentExport as vm","lg",i,n)},o.openContentTypeEdit=function(e,t){var n=o.CreateResolve({item:e});return o.OpenModal("content-types/content-types-edit.html","Edit as vm","",n,t)},o.openContentTypeFields=function(e,t){var n=o.CreateResolve({contentType:e});return o.OpenModal("content-types/content-types-fields.html","FieldList as vm","xlg",n,t)},o.openContentTypeFieldsOfItems=function(e,t){return a.getManyForEditing(r,e).then(function(e){var n=e.data[0].Header.ContentTypeName,a=i(r);return a.getDetails(n).then(function(e){return o.openContentTypeFields(e.data,t)})})},o.openItemNew=function(e,t){return o.openEditItems([{ContentTypeName:e}],t,{partOfPage:!1})},o.openItemEditWithEntityId=function(e,t){return o.openEditItems([{EntityId:e}],t,{partOfPage:!1})},o.openEditItems=function(e,t,n){var a=angular.extend({items:e},n||{});a.partOfPage=Boolean(a.partOfPage),a.publishing=a.publishing||null,console.log("openEditItems: partOfPage: "+a.partOfPage," publishing: "+a.publishing);var i=o.CreateResolve(a);return o.OpenModal("form/main-form.html","EditEntityWrapperCtrl as vm","ent-edit",i,t)},o.openItemHistory=function(e,t){return o.OpenModal("content-items/history.html","History as vm","lg",o.CreateResolve({entityId:e}),t)},o.openMetadataNew=function(e,n,a,i,r){var l={};switch(n){case"entity":l.Key=a,l.KeyType="guid",l.TargetType=t.metadataOfEntity;break;case"attribute":l.Key=a,l.KeyType="number",l.TargetType=t.metadataOfAttribute;break;default:throw"targetType unknown, only accepts entity or attribute for now"}var s=[{ContentTypeName:i,Metadata:l}];o.openEditItems(s,r,{partOfPage:!1})},o.openPermissionsForGuid=function(e,t,n){var a=o.CreateResolve({appId:e,targetGuid:t});return o.OpenModal("permissions/permissions.html","PermissionList as vm","lg",a,n)},o.editPipeline=function(e,t,a){var i=o.derivedUrl({dialog:"pipeline-designer",pipelineId:t});n.open(i)},o.derivedUrl=function(e){var t=window.location.href;for(var n in e)e.hasOwnProperty(n)&&(t=o.replaceOrAddOneParam(t,n,e[n]));return t},o.replaceOrAddOneParam=function(e,t,n){var a=new RegExp("("+t+"=).*?(&)","i"),i=a.test(e)?e.replace(a,"$1"+n+"$2"):e+"&"+t+"="+n;return i},o._attachCallbacks=function(e,t){return"undefined"==typeof t?null:("function"==typeof t&&(t={close:t}),e.result.then(t.success||t.close,t.error||t.close,t.notify||t.close))},o.openModalComponent=function(t,n,a,i){var r=e.open({component:t,resolve:o.CreateResolve(a),size:n});return o._attachCallbacks(r,i)},o.OpenModal=function(t,n,a,i,r){var l=n.indexOf(" as "),s=l>0?n.substring(l+4):null;l>0&&(n=n.substring(0,l));var d=e.open({animation:!0,templateUrl:t,controller:n,controllerAs:s,size:a,resolve:i});return o._attachCallbacks(d,r)},o.CreateResolve=function(){var e={},t=arguments[0];for(var n in t)t.hasOwnProperty(n)&&(e[n]=o._create1Resolve(t[n]));return e},o._create1Resolve=function(e){return function(){return e}},o}]),angular.module("eavNgSvcs",["ng"]).config(["$locationProvider",function(e){e.html5Mode({enabled:!0,requireBase:!1})}]),angular.module("EavServices").service("fileType",function(){var e={};return e.iconPrefix="eav-icon-",e.defaultIcon="file",e.checkImgRegEx=/(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*\.(?:jpg|jpeg|gif|png))(?:\?([^#]*))?(?:#(.*))?/i,e.extensions={doc:"file-word",docx:"file-word",xls:"file-excel",xlsx:"file-excel",ppt:"file-powerpoint",pptx:"file-powerpoint",pdf:"file-pdf",mp3:"file-audio",avi:"file-video",mpg:"file-video",mpeg:"file-video",mov:"file-video",mp4:"file-video",zip:"file-archive",rar:"file-archive",txt:"file-text",html:"file-code",css:"file-code",xml:"file-code",xsl:"file-code",vcf:"user"},e.getExtension=function(e){return e.substr(e.lastIndexOf(".")+1).toLowerCase()},e.getIconClass=function(t){return e.iconPrefix+(e.extensions[e.getExtension(t)]||e.defaultIcon)},e.isKnownType=function(t){return-1!==e.extensions.indexOf[e.getExtension(t)]},e.isImage=function(t){return e.checkImgRegEx.test(t)},e}),angular.module("EavServices").factory("historySvc",["$http","svcCreator",function(e,t){return function(n,a){var i={appId:n,entityId:a};return i=angular.extend(i,t.implementLiveList(function(){return e.get("eav/entities/history",{params:{appId:i.appId,entityId:i.entityId}}).then(function(e){for(var t=e.data,n=0;n<t.length;n++)t[n].VirtualVersion=t.length-n;return e})})),i.getVersionDetails=function(t){return e.get("eav/entities/historydetails",{params:{appId:i.appId,entityId:i.entityId,changeId:t}})},i}}]),function(){angular.module("EavServices").config(["$translateProvider","languages","$translatePartialLoaderProvider",function(e,t,n){e.preferredLanguage(t.currentLanguage.split("-")[0]).useSanitizeValueStrategy("escapeParameters").fallbackLanguage(t.fallbackLanguage).useLoader("$translatePartialLoader",{urlTemplate:t.i18nRoot+"{part}-{lang}.js"}).useLoaderCache(!0),n.addPart("admin").addPart("edit")}]).run(["$rootScope","$translate",function(e,t){e.$on("$translatePartialLoaderStructureChanged",function(){t.refresh()})}])}(),function(){function e(e){return window.$2sxc?window.$2sxc.urlParams.get(e):t(e)}function t(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)","i"),n=t.exec(location.search);if(null===n){var a=new RegExp("[#&]"+e+"=([^&#]*)","i");n=a.exec(location.hash)}if(null===n){var i=window.location.pathname.match(new RegExp("/"+e+"/([^/]+)","i"));null!==i&&i.length>1&&(n=i.reverse()[0])}else n=n[1];return null===n?"":decodeURIComponent(n.replace(/\+/g," "))}angular.module("InitParametersFromUrl",[]).factory("appId",function(){return e("appId")}).factory("zoneId",function(){return e("zoneId")}).factory("entityId",function(){return e("entityid")}).factory("contentTypeName",function(){return e("contenttypename")}).factory("pipelineId",function(){return e("pipelineId")}).factory("dialog",function(){return e("dialog")}).factory("$uibModalInstance",function(){return null}).factory("getUrlParamMustRefactor",function(){return e})}(),angular.module("EavServices").factory("latinizeText",function(){return function(e){var t={"Á":"A","Ă":"A","Ắ":"A","Ặ":"A","Ằ":"A","Ẳ":"A","Ẵ":"A","Ǎ":"A","Â":"A","Ấ":"A","Ậ":"A","Ầ":"A","Ẩ":"A","Ẫ":"A","Ä":"Ae","Ǟ":"A","Ȧ":"A","Ǡ":"A","Ạ":"A","Ȁ":"A","À":"A","Ả":"A","Ȃ":"A","Ā":"A","Ą":"A","Å":"A","Ǻ":"A","Ḁ":"A","Ⱥ":"A","Ã":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ḃ":"B","Ḅ":"B","Ɓ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ć":"C","Č":"C","Ç":"C","Ḉ":"C","Ĉ":"C","Ċ":"C","Ƈ":"C","Ȼ":"C","Ď":"D","Ḑ":"D","Ḓ":"D","Ḋ":"D","Ḍ":"D","Ɗ":"D","Ḏ":"D","ǲ":"D","ǅ":"D","Đ":"D","Ƌ":"D","Ǳ":"DZ","Ǆ":"DZ","É":"E","Ĕ":"E","Ě":"E","Ȩ":"E","Ḝ":"E","Ê":"E","Ế":"E","Ệ":"E","Ề":"E","Ể":"E","Ễ":"E","Ḙ":"E","Ë":"E","Ė":"E","Ẹ":"E","Ȅ":"E","È":"E","Ẻ":"E","Ȇ":"E","Ē":"E","Ḗ":"E","Ḕ":"E","Ę":"E","Ɇ":"E","Ẽ":"E","Ḛ":"E","Ꝫ":"ET","Ḟ":"F","Ƒ":"F","Ǵ":"G","Ğ":"G","Ǧ":"G","Ģ":"G","Ĝ":"G","Ġ":"G","Ɠ":"G","Ḡ":"G","Ǥ":"G","Ḫ":"H","Ȟ":"H","Ḩ":"H","Ĥ":"H","Ⱨ":"H","Ḧ":"H","Ḣ":"H","Ḥ":"H","Ħ":"H","Í":"I","Ĭ":"I","Ǐ":"I","Î":"I","Ï":"I","Ḯ":"I","İ":"I","Ị":"I","Ȉ":"I","Ì":"I","Ỉ":"I","Ȋ":"I","Ī":"I","Į":"I","Ɨ":"I","Ĩ":"I","Ḭ":"I","Ꝺ":"D","Ꝼ":"F","Ᵹ":"G","Ꞃ":"R","Ꞅ":"S","Ꞇ":"T","Ꝭ":"IS","Ĵ":"J","Ɉ":"J","Ḱ":"K","Ǩ":"K","Ķ":"K","Ⱪ":"K","Ꝃ":"K","Ḳ":"K","Ƙ":"K","Ḵ":"K","Ꝁ":"K","Ꝅ":"K","Ĺ":"L","Ƚ":"L","Ľ":"L","Ļ":"L","Ḽ":"L","Ḷ":"L","Ḹ":"L","Ⱡ":"L","Ꝉ":"L","Ḻ":"L","Ŀ":"L","Ɫ":"L","ǈ":"L","Ł":"L","Ǉ":"LJ","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ń":"N","Ň":"N","Ņ":"N","Ṋ":"N","Ṅ":"N","Ṇ":"N","Ǹ":"N","Ɲ":"N","Ṉ":"N","Ƞ":"N","ǋ":"N","Ñ":"N","Ǌ":"NJ","Ó":"O","Ŏ":"O","Ǒ":"O","Ô":"O","Ố":"O","Ộ":"O","Ồ":"O","Ổ":"O","Ỗ":"O","Öe":"O","Ȫ":"O","Ȯ":"O","Ȱ":"O","Ọ":"O","Ő":"O","Ȍ":"O","Ò":"O","Ỏ":"O","Ơ":"O","Ớ":"O","Ợ":"O","Ờ":"O","Ở":"O","Ỡ":"O","Ȏ":"O","Ꝋ":"O","Ꝍ":"O","Ō":"O","Ṓ":"O","Ṑ":"O","Ɵ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Õ":"O","Ṍ":"O","Ṏ":"O","Ȭ":"O","Ƣ":"OI","Ꝏ":"OO","Ɛ":"E","Ɔ":"O","Ȣ":"OU","Ṕ":"P","Ṗ":"P","Ꝓ":"P","Ƥ":"P","Ꝕ":"P","Ᵽ":"P","Ꝑ":"P","Ꝙ":"Q","Ꝗ":"Q","Ŕ":"R","Ř":"R","Ŗ":"R","Ṙ":"R","Ṛ":"R","Ṝ":"R","Ȑ":"R","Ȓ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꜿ":"C","Ǝ":"E","Ś":"S","Ṥ":"S","Š":"S","Ṧ":"S","Ş":"S","Ŝ":"S","Ș":"S","Ṡ":"S","Ṣ":"S","Ṩ":"S","Ť":"T","Ţ":"T","Ṱ":"T","Ț":"T","Ⱦ":"T","Ṫ":"T","Ṭ":"T","Ƭ":"T","Ṯ":"T","Ʈ":"T","Ŧ":"T","Ɐ":"A","Ꞁ":"L","Ɯ":"M","Ʌ":"V","Ꜩ":"TZ","Ú":"U","Ŭ":"U","Ǔ":"U","Û":"U","Ṷ":"U","Ü":"Ue","Ǘ":"U","Ǚ":"U","Ǜ":"U","Ǖ":"U","Ṳ":"U","Ụ":"U","Ű":"U","Ȕ":"U","Ù":"U","Ủ":"U","Ư":"U","Ứ":"U","Ự":"U","Ừ":"U","Ử":"U","Ữ":"U","Ȗ":"U","Ū":"U","Ṻ":"U","Ų":"U","Ů":"U","Ũ":"U","Ṹ":"U","Ṵ":"U","Ꝟ":"V","Ṿ":"V","Ʋ":"V","Ṽ":"V","Ꝡ":"VY","Ẃ":"W","Ŵ":"W","Ẅ":"W","Ẇ":"W","Ẉ":"W","Ẁ":"W","Ⱳ":"W","Ẍ":"X","Ẋ":"X","Ý":"Y","Ŷ":"Y","Ÿ":"Y","Ẏ":"Y","Ỵ":"Y","Ỳ":"Y","Ƴ":"Y","Ỷ":"Y","Ỿ":"Y","Ȳ":"Y","Ɏ":"Y","Ỹ":"Y","Ź":"Z","Ž":"Z","Ẑ":"Z","Ⱬ":"Z","Ż":"Z","Ẓ":"Z","Ȥ":"Z","Ẕ":"Z","Ƶ":"Z","Ĳ":"IJ","Œ":"OE","ᴀ":"A","ᴁ":"AE","ʙ":"B","ᴃ":"B","ᴄ":"C","ᴅ":"D","ᴇ":"E","ꜰ":"F","ɢ":"G","ʛ":"G","ʜ":"H","ɪ":"I","ʁ":"R","ᴊ":"J","ᴋ":"K","ʟ":"L","ᴌ":"L","ᴍ":"M","ɴ":"N","ᴏ":"O","ɶ":"OE","ᴐ":"O","ᴕ":"OU","ᴘ":"P","ʀ":"R","ᴎ":"N","ᴙ":"R","ꜱ":"S","ᴛ":"T","ⱻ":"E","ᴚ":"R","ᴜ":"U","ᴠ":"V","ᴡ":"W","ʏ":"Y","ᴢ":"Z","á":"a","ă":"a","ắ":"a","ặ":"a","ằ":"a","ẳ":"a","ẵ":"a","ǎ":"a","â":"a","ấ":"a","ậ":"a","ầ":"a","ẩ":"a","ẫ":"a","ä":"ae","ǟ":"a","ȧ":"a","ǡ":"a","ạ":"a","ȁ":"a","à":"a","ả":"a","ȃ":"a","ā":"a","ą":"a","ᶏ":"a","ẚ":"a","å":"a","ǻ":"a","ḁ":"a","ⱥ":"a","ã":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ḃ":"b","ḅ":"b","ɓ":"b","ḇ":"b","ᵬ":"b","ᶀ":"b","ƀ":"b","ƃ":"b","ɵ":"o","ć":"c","č":"c","ç":"c","ḉ":"c","ĉ":"c","ɕ":"c","ċ":"c","ƈ":"c","ȼ":"c","ď":"d","ḑ":"d","ḓ":"d","ȡ":"d","ḋ":"d","ḍ":"d","ɗ":"d","ᶑ":"d","ḏ":"d","ᵭ":"d","ᶁ":"d","đ":"d","ɖ":"d","ƌ":"d","ı":"i","ȷ":"j","ɟ":"j","ʄ":"j","ǳ":"dz","ǆ":"dz","é":"e","ĕ":"e","ě":"e","ȩ":"e","ḝ":"e","ê":"e","ế":"e","ệ":"e","ề":"e","ể":"e","ễ":"e","ḙ":"e","ë":"e","ė":"e","ẹ":"e","ȅ":"e","è":"e","ẻ":"e","ȇ":"e","ē":"e","ḗ":"e","ḕ":"e","ⱸ":"e","ę":"e","ᶒ":"e","ɇ":"e","ẽ":"e","ḛ":"e","ꝫ":"et","ḟ":"f","ƒ":"f","ᵮ":"f","ᶂ":"f","ǵ":"g","ğ":"g","ǧ":"g","ģ":"g","ĝ":"g","ġ":"g","ɠ":"g","ḡ":"g","ᶃ":"g","ǥ":"g","ḫ":"h","ȟ":"h","ḩ":"h","ĥ":"h","ⱨ":"h","ḧ":"h","ḣ":"h","ḥ":"h","ɦ":"h","ẖ":"h","ħ":"h","ƕ":"hv","í":"i","ĭ":"i","ǐ":"i","î":"i","ï":"i","ḯ":"i","ị":"i","ȉ":"i","ì":"i","ỉ":"i","ȋ":"i","ī":"i","į":"i","ᶖ":"i","ɨ":"i","ĩ":"i","ḭ":"i","ꝺ":"d","ꝼ":"f","ᵹ":"g","ꞃ":"r","ꞅ":"s","ꞇ":"t","ꝭ":"is","ǰ":"j","ĵ":"j","ʝ":"j","ɉ":"j","ḱ":"k","ǩ":"k","ķ":"k","ⱪ":"k","ꝃ":"k","ḳ":"k","ƙ":"k","ḵ":"k","ᶄ":"k","ꝁ":"k","ꝅ":"k","ĺ":"l","ƚ":"l","ɬ":"l","ľ":"l","ļ":"l","ḽ":"l","ȴ":"l","ḷ":"l","ḹ":"l","ⱡ":"l","ꝉ":"l","ḻ":"l","ŀ":"l","ɫ":"l","ᶅ":"l","ɭ":"l","ł":"l","ǉ":"lj","ſ":"s","ẜ":"s","ẛ":"s","ẝ":"s","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ᵯ":"m","ᶆ":"m","ń":"n","ň":"n","ņ":"n","ṋ":"n","ȵ":"n","ṅ":"n","ṇ":"n","ǹ":"n","ɲ":"n","ṉ":"n","ƞ":"n","ᵰ":"n","ᶇ":"n","ɳ":"n","ñ":"n","ǌ":"nj","ó":"o","ŏ":"o","ǒ":"o","ô":"o","ố":"o","ộ":"o","ồ":"o","ổ":"o","ỗ":"o","ö":"oe","ȫ":"o","ȯ":"o","ȱ":"o","ọ":"o","ő":"o","ȍ":"o","ò":"o","ỏ":"o","ơ":"o","ớ":"o","ợ":"o","ờ":"o","ở":"o","ỡ":"o","ȏ":"o","ꝋ":"o","ꝍ":"o","ⱺ":"o","ō":"o","ṓ":"o","ṑ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","õ":"o","ṍ":"o","ṏ":"o","ȭ":"o","ƣ":"oi","ꝏ":"oo","ɛ":"e","ᶓ":"e","ɔ":"o","ᶗ":"o","ȣ":"ou","ṕ":"p","ṗ":"p","ꝓ":"p","ƥ":"p","ᵱ":"p","ᶈ":"p","ꝕ":"p","ᵽ":"p","ꝑ":"p","ꝙ":"q","ʠ":"q","ɋ":"q","ꝗ":"q","ŕ":"r","ř":"r","ŗ":"r","ṙ":"r","ṛ":"r","ṝ":"r","ȑ":"r","ɾ":"r","ᵳ":"r","ȓ":"r","ṟ":"r","ɼ":"r","ᵲ":"r","ᶉ":"r","ɍ":"r","ɽ":"r","ↄ":"c","ꜿ":"c","ɘ":"e","ɿ":"r","ß":"ss","ś":"s","ṥ":"s","š":"s","ṧ":"s","ş":"s","ŝ":"s","ș":"s","ṡ":"s","ṣ":"s","ṩ":"s","ʂ":"s","ᵴ":"s","ᶊ":"s","ȿ":"s","ɡ":"g","ᴑ":"o","ᴓ":"o","ᴝ":"u","ť":"t","ţ":"t","ṱ":"t","ț":"t","ȶ":"t","ẗ":"t","ⱦ":"t","ṫ":"t","ṭ":"t","ƭ":"t","ṯ":"t","ᵵ":"t","ƫ":"t","ʈ":"t","ŧ":"t","ᵺ":"th","ɐ":"a","ᴂ":"ae","ǝ":"e","ᵷ":"g","ɥ":"h","ʮ":"h","ʯ":"h","ᴉ":"i","ʞ":"k","ꞁ":"l","ɯ":"m","ɰ":"m","ᴔ":"oe","ɹ":"r","ɻ":"r","ɺ":"r","ⱹ":"r","ʇ":"t","ʌ":"v","ʍ":"w","ʎ":"y","ꜩ":"tz","ú":"u","ŭ":"u","ǔ":"u","û":"u","ṷ":"u","ü":"ue","ǘ":"u","ǚ":"u","ǜ":"u","ǖ":"u","ṳ":"u","ụ":"u","ű":"u","ȕ":"u","ù":"u","ủ":"u","ư":"u","ứ":"u","ự":"u","ừ":"u","ử":"u","ữ":"u","ȗ":"u","ū":"u","ṻ":"u","ų":"u","ᶙ":"u","ů":"u","ũ":"u","ṹ":"u","ṵ":"u","ᵫ":"ue","ꝸ":"um","ⱴ":"v","ꝟ":"v","ṿ":"v","ʋ":"v","ᶌ":"v","ⱱ":"v","ṽ":"v","ꝡ":"vy","ẃ":"w","ŵ":"w","ẅ":"w","ẇ":"w","ẉ":"w","ẁ":"w","ⱳ":"w","ẘ":"w","ẍ":"x","ẋ":"x","ᶍ":"x","ý":"y","ŷ":"y","ÿ":"y","ẏ":"y","ỵ":"y","ỳ":"y","ƴ":"y","ỷ":"y","ỿ":"y","ȳ":"y","ẙ":"y","ɏ":"y","ỹ":"y","ź":"z","ž":"z","ẑ":"z","ʑ":"z","ⱬ":"z","ż":"z","ẓ":"z","ȥ":"z","ẕ":"z","ᵶ":"z","ᶎ":"z","ʐ":"z","ƶ":"z","ɀ":"z","ﬀ":"ff","ﬃ":"ffi","ﬄ":"ffl","ﬁ":"fi","ﬂ":"fl","ĳ":"ij","œ":"oe","ﬆ":"st","ₐ":"a","ₑ":"e","ᵢ":"i","ⱼ":"j","ₒ":"o","ᵣ":"r","ᵤ":"u","ᵥ":"v","ₓ":"x"};return e.replace(/[^A-Za-z0-9\[\] ]/g,function(e){return t[e]||e})}}),angular.module("EavServices").factory("metadataSvc",["$http","appId",function(e,t){var n={};return n.getMetadata=function(n,a,i){return e.get("eav/metadata/getassignedentities",{params:{appId:t,assignmentObjectTypeId:n,keyType:"guid",key:a,contentType:i}})},n}]),angular.module("EavServices").factory("permissionsSvc",["$http","eavConfig","entitiesSvc","metadataSvc","svcCreator","contentTypeSvc",function(e,t,n,a,i,r){var o=t;return function(e,t){var l={PermissionTargetGuid:t,ctName:"PermissionConfiguration",ctId:0,EntityAssignment:o.metadataOfEntity,ctSvc:r(e)};return l=angular.extend(l,i.implementLiveList(function(){return a.getMetadata(l.EntityAssignment,l.PermissionTargetGuid,l.ctName).then(l.updateLiveAll)})),l.ctSvc.getDetails(l.ctName).then(function(e){l.ctId=e.data.Id}),l["delete"]=function(e){return n["delete"](l.ctName,e).then(l.liveListReload)},l}}]),angular.module("EavServices").factory("pipelineService",["$resource","$q","$filter","eavConfig","$http","contentTypeSvc","metadataSvc","eavAdminDialogs","appId",function(e,t,n,a,i,r,o,l,s){"use strict";var d={};d.pipelineResource=e("eav/PipelineDesigner/:action"),d.entitiesResource=e("eav/Entities/:action"),d.appId=0,console.log("ok"),d.getDataSourceDefinitionProperty=function(e,t){var a=n("filter")(e.InstalledDataSources,function(e){return e.PartAssemblyAndType===t.PartAssemblyAndType})[0];if(!a)throw"DataSource Definition not found: "+t.PartAssemblyAndType;return a};var u=function(e){e.DataSources.push({Name:a.pipelineDesigner.outDataSource.name,Description:a.pipelineDesigner.outDataSource.description,EntityGuid:"Out",PartAssemblyAndType:a.pipelineDesigner.outDataSource.className,VisualDesignerData:a.pipelineDesigner.outDataSource.visualDesignerData,ReadOnly:!0}),angular.forEach(e.DataSources,function(t){t.Definition=function(){return d.getDataSourceDefinitionProperty(e,t)},t.ReadOnly=t.ReadOnly||!e.Pipeline.AllowEdit,t.VisualDesignerData=t.VisualDesignerData||{Top:50,Left:50}})};return angular.extend(d,{getPipeline:function(e){var n=t.defer(),i=d.pipelineResource.get({action:"GetPipeline",id:e,appId:d.appId}),r=d.pipelineResource.query({action:"GetInstalledDataSources"});return t.all([i.$promise,r.$promise]).then(function(t){var i=JSON.parse(angular.toJson(t[0]));i.InstalledDataSources=JSON.parse(angular.toJson(t[1])),e||(i.Pipeline={AllowEdit:"True"}),i.InstalledDataSources.push({PartAssemblyAndType:a.pipelineDesigner.outDataSource.className,ClassName:a.pipelineDesigner.outDataSource.className,In:a.pipelineDesigner.outDataSource["in"],Out:null,allowNew:!1}),u(i),n.resolve(i)},function(e){n.reject(e)}),n.promise},postProcessDataSources:function(e){n("filter")(e.DataSources,function(e){return"Out"===e.EntityGuid})[0]||u(e)},getNewDataSource:function(e,t){return{Definition:function(){return d.getDataSourceDefinitionProperty(e,t)}}},savePipeline:function(e,n){if(!d.appId)return t.reject("appId must be set to save a Pipeline");var a=[];return angular.forEach(n,function(e){var t=angular.copy(e);delete t.ReadOnly,a.push(t)}),d.pipelineResource.save({action:"SavePipeline",appId:d.appId,Id:e.EntityId},{pipeline:e,dataSources:a}).$promise},clonePipeline:function(e){return d.pipelineResource.get({action:"ClonePipeline",appId:d.appId,Id:e}).$promise},editDataSourcePart:function(e,t){var a=n("filter")(t,{PartAssemblyAndType:e.PartAssemblyAndType},!0)[0];console.log(a);var i=a&&a.ContentType?a.ContentType:"|Config "+n("typename")(e.PartAssemblyAndType,"classFullName"),d=4,u=e.EntityGuid;o.getMetadata(d,u,i).then(function(e){var t=e.data;t.length?l.openItemEditWithEntityId(t[0].Id):r(s,"System").getDetails(i,{ignoreErrors:!0}).success(function(){var e=[{ContentTypeName:i,Metadata:{TargetType:d,KeyType:"guid",Key:u}}];l.openEditItems(e)}).error(function(){alert("Server reports error - this usually means that this data-source doesn't have any configuration")})})}}),angular.extend(d,{queryPipeline:function(e){return d.pipelineResource.get({action:"QueryPipeline",appId:d.appId,id:e}).$promise},setAppId:function(e){d.appId=e},getPipelines:function(){return d.entitiesResource.query({action:"GetEntities",appId:d.appId,contentType:"DataPipeline"})},deletePipeline:function(e){return d.pipelineResource.get({action:"DeletePipeline",appId:d.appId,id:e}).$promise}}),d}]),angular.module("EavServices").factory("svcCreator",["toastr","$translate","$timeout",function(e,t,n){var a={};return a.implementLiveList=function(a,i){var r={};return r.disableToastr=!!i,r.liveListCache=[],r.liveListCache.isLoaded=!1,r.liveList=function(){return 0!==r.liveListCache.length||r.liveListCache.isLoaded||r.liveListReload(),r.liveListCache},r._liveListUpdateWithResult=function(t){r.msg.isOpened?e.clear(r.msg):n(300).then(function(){e.clear(r.msg)}),r.liveListCache.length=0;for(var a=0;a<t.data.length;a++)r.liveListCache.push(t.data[a]);return r.liveListCache.isLoaded=!0,t},r.liveListSourceRead=a,r.liveListReload=function(){return t("General.Messages.Loading").then(function(t){r.msg=e.info(t)}),r.liveListSourceRead().then(r._liveListUpdateWithResult)},r.liveListReset=function(){r.liveListCache=[]},r},a}]),angular.module("EavServices").config(["toastrConfig",function(e){angular.extend(e,{autoDismiss:!1,containerId:"toast-container",maxOpened:5,newestOnTop:!0,positionClass:"toast-top-right",preventDuplicates:!1,preventOpenDuplicates:!1,target:"body"})}]).factory("toastrWithHttpErrorHandling",["toastr",function(e){return e.originalError=e.error,e.error=function(t,n,a){var i;t&&t.data&&t.data.Message?(i=t.data.Message,t.data.ExceptionMessage&&(i+="\n"+t.data.ExceptionMessage)):i=t,e.originalError(i,n,a)},e}]).factory("saveToastr",["toastr","$translate",function(e,t){function n(n){var a=e.info(t.instant("Message.Saving"));return n.then(function(n){return e.clear(a),e.success(t.instant("Message.Saved"),{timeOut:3e3}),n},function(n){return e.clear(a),e.error(t.instant("Message.ErrorWhileSaving")),n})}return n}]).factory("promiseToastr",["toastrWithHttpErrorHandling","$translate",function(e,t){function n(n,a,i,r,o,l,s){var d=e,u=d.info(t.instant(a));return n.then(function(e){return d.clear(u),d.success(t.instant(i),{timeOut:l||1e3}),e},function(e){return d.clear(u),d.error(e,t.instant(r)),e})}return n}]),angular.module("eavTemplates",[]).run(["$templateCache",function(e){e.put("content-import-export/content-export.html",'\r\n<div class="modal-header">\r\n    <button class="btn btn-default btn-square btn-subtle pull-right" type="button" icon="remove" ng-click="vm.close()"></button>\r\n    <h3 class="modal-title" translate="Content.Export.Title">cc</h3>\r\n</div>\r\n\r\n<div class="modal-body">\r\n    <div translate="Content.Export.Help"></div>\r\n    <formly-form form="vm.form" model="vm.formValues" fields="vm.formFields">\r\n    </formly-form>\r\n</div>\r\n\r\n<div class="modal-footer">\r\n    <button type="button" class="btn btn-primary pull-left" ng-click="vm.exportContent()" translate="Content.Export.Commands.Export"></button>\r\n</div>'),e.put("content-import-export/content-import.html",'<div ng-click="vm.debug.autoEnableAsNeeded($event)">\r\n    <!-- HEADER -->\r\n    <div class="modal-header">\r\n        <button class="btn btn-default btn-square btn-subtle pull-right" type="button" icon="remove" ng-click="vm.close()"></button>\r\n        <h3 class="modal-title"><span  translate="Content.Import.Title"></span> <span ng-show="vm.viewStateSelected > 0" translate="Content.Import.TitleSteps" translate-values="{step: vm.viewStateSelected}"></span></h3>\r\n    </div>\r\n    <!-- END HEADER -->\r\n\r\n    <div ng-switch="vm.viewStateSelected">\r\n\r\n        <!-- FORM -->\r\n        <div ng-switch-when="1">\r\n            <div class="modal-body">\r\n                <div translate="Content.Import.Help"></div>\r\n                <formly-form form="vm.form" model="vm.formValues" fields="vm.formFields"></formly-form>\r\n                <div class="text-warning" translate="Content.Import.Messages.BackupContentBefore"></div>\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button type="button" class="btn btn-primary pull-left" ng-click="vm.evaluateContent()" ng-disabled="!vm.formValues.File || !vm.formValues.File.filename" translate="Content.Import.Commands.Preview"></button>\r\n            </div>\r\n        </div>\r\n        <!-- END FORM -->\r\n\r\n\r\n        <!-- WAITING -->\r\n        <div ng-switch-when="0">\r\n            <div class="modal-body"> {{\'Content.Import.Messages.WaitingForResponse\' | translate}}\r\n            </div>\r\n        </div>\r\n        <!-- END WAITING -->\r\n\r\n\r\n        <!-- EVALUATION RESULT -->\r\n        <div ng-switch-when="2">\r\n            <div class="modal-body">\r\n                <!-- DETAILS / STATISTICS -->\r\n                <div ng-if="vm.evaluationResult.Succeeded">\r\n                    <h4 translate="Content.Import.Evaluation.Detail.Title" translate-values="{filename: vm.formValues.File.filename}"></h4>\r\n                    <h5 translate="Content.Import.Evaluation.Detail.File.Title"></h5>\r\n                    <ul>\r\n                        <li translate="Content.Import.Evaluation.Detail.File.ElementCount" translate-values="{count: vm.evaluationResult.Detail.DocumentElementsCount}"></li>\r\n                        <li translate="Content.Import.Evaluation.Detail.File.LanguageCount" translate-values="{count: vm.evaluationResult.Detail.LanguagesInDocumentCount}"></li>\r\n                        <li translate="Content.Import.Evaluation.Detail.File.Attributes" translate-values="{count: vm.evaluationResult.Detail.AttributeNamesInDocument.length, attributes: vm.evaluationResult.Detail.AttributeNamesInDocument.join(\', \')}"></li>\r\n                    </ul>\r\n                    <h5 translate="Content.Import.Evaluation.Detail.Entities.Title"></h5>\r\n                    <ul>\r\n                        <li translate="Content.Import.Evaluation.Detail.Entities.Create" translate-values="{count: vm.evaluationResult.Detail.AmountOfEntitiesCreated}"></li>\r\n                        <li translate="Content.Import.Evaluation.Detail.Entities.Update" translate-values="{count: vm.evaluationResult.Detail.AmountOfEntitiesUpdated}"></li>\r\n                        <li translate="Content.Import.Evaluation.Detail.Entities.Delete" translate-values="{count: vm.evaluationResult.Detail.AmountOfEntitiesDeleted}"></li>\r\n                        <li translate="Content.Import.Evaluation.Detail.Entities.AttributesIgnored" translate-values="{count: vm.evaluationResult.Detail.AttributeNamesNotImported.length, attributes: vm.evaluationResult.Detail.AttributeNamesNotImported.join(\', \')}"></li>\r\n                    </ul>\r\n                    <div class="text-warning" translate="Content.Import.Messages.ImportCanTakeSomeTime"></div>\r\n                </div>\r\n                <!-- END DETAILS / STATISTICS -->\r\n                <!-- ERRORS -->\r\n                <div ng-if="!vm.evaluationResult.Succeeded">\r\n                    <h4 translate="Content.Import.Evaluation.Error.Title" translate-values="{filename: vm.formValues.File.filename}"></h4>\r\n                    <ul>\r\n                        <li ng-repeat="error in vm.evaluationResult.Detail">\r\n                            <div><span translate="Content.Import.Evaluation.Error.Codes.{{error.ErrorCode}}"></span></div>\r\n                            <div ng-if="error.ErrorDetail"><i translate="Content.Import.Evaluation.Error.Detail" translate-values="{detail: error.ErrorDetail}"></i>\r\n                            </div>\r\n                            <div ng-if="error.LineNumber"><i translate=Content.Import.Evaluation.Error.LineNumber" translate-values="{number: error.LineNumber}"></i>\r\n                            </div>\r\n                            <div ng-if="error.LineDetail"><i translate="Content.Import.Evaluation.Error.LineDetail" translate-values="{detail: error.LineDetail}"></i>\r\n                            </div>\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n                <!-- END ERRORS -->\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button type="button" class="btn pull-left" ng-click="vm.back()" icon="arrow-left"></button>\r\n                <button type="button" class="btn btn-default pull-left" ng-click="vm.importContent()" translate="Content.Import.Commands.Import" ng-disabled="!vm.evaluationResult.Succeeded"></button>\r\n            </div>\r\n        </div>\r\n        <!-- END EVALUATION RESULT -->\r\n\r\n\r\n        <!-- IMPORT RESULT -->\r\n        <div ng-switch-when="3">\r\n            <div class="modal-body">\r\n                <span ng-show="vm.importResult.Succeeded" translate="Content.Import.Messages.ImportSucceeded"></span>\r\n                <span ng-hide="vm.importResult.Succeeded" translate="Content.Import.Messages.ImportFailed"></span>\r\n            </div>\r\n        </div>\r\n        <!-- END IMPORT RESULT -->\r\n\r\n        <div ng-if="vm.debug.on">\r\n            <h3>Debug infos</h3>\r\n            <pre>{{vm.formValues | json}}</pre>\r\n        </div>\r\n    </div>\r\n</div>'),
e.put("content-items/content-edit.html",'<div class="modal-header">\r\n    <button type="button" class="btn btn-default btn-subtle" ng-click="vm.history()">\r\n        <span class="glyphicon glyphicon-time"> history / todo </span>\r\n    </button>\r\n    <h3 class="modal-title">Edit / New Content</h3>\r\n</div>\r\n\r\n<div class="modal-body">\r\n    this is where the edit appears. Would edit entity {{vm.entityId}} or add a {{vm.contentType}} - depending on the mode: {{vm.mode}}\r\n    <h3>Use cases</h3>\r\n    <ol>\r\n        <li>Edit an existing entity with ID</li>\r\n        <li>Create a new entity of a certaint content-type, just save and done (like from a "new" button without content-group)</li>\r\n        <li>Create a new entity of a certain type and assign it to a metadata thing (guid, int, string)</li>\r\n\r\n        <li>Create a new entity and put it into a content-group at the right place</li>\r\n        <li>Edit content-group: item + presentation </li>\r\n        <li>Edit multiple IDs/or new/mix: Edit multiple items with IDs</li>\r\n    </ol>\r\n\r\n    init of 1 edit\r\n    - entity-id in storage\r\n    - new-type + optional: assignment-id + assignment-type\r\n\r\n    - array of the above\r\n    --- [{id 17}, {type: "person"}, {type: person, asstype: 4, target: 0205}]\r\n\r\n    - content-group\r\n</div>\r\n'),e.put("content-items/content-items-agnostic.html",'<div ng-click="vm.debug.autoEnableAsNeeded($event)" class="content-items-agnostic">\r\n    <div class="modal-header">\r\n        <button class="btn btn-default btn-square btn-subtle pull-right" type="button" ng-click="vm.close()"><i icon="remove"></i></button>\r\n        <h3 class="modal-title" translate="Content.Manage.Title"></h3>\r\n    </div>\r\n    <div class="modal-body">\r\n        <button type="button" class="btn btn-primary btn-square" ng-click="vm.add()"><i icon="plus"></i></button>\r\n        <button type="button"\r\n                class="btn btn-default btn-square"\r\n                uib-tooltip="{{ \'ContentTypes.Buttons.Export\' | translate }}"\r\n                ng-click="vm.openExport()">\r\n            <i icon="export"></i>\r\n        </button>\r\n	    <button ng-if="vm.debug.on" type="button" class="btn btn-warning btn-square" ng-click="vm.refresh()"><i icon="repeat"></i></button>\r\n        <button ng-if="vm.debug.on" type="button" class="btn btn-warning btn-square" ng-click="vm.debugFilter()"><i icon="filter"></i></button>\r\n\r\n		<div ag-grid="vm.gridOptions" class="ag-grid-wrapper"></div>\r\n	    \r\n        <show-debug-availability class="pull-right" ></show-debug-availability>\r\n    </div>\r\n</div>'),e.put("content-items/history-details.html",'<div>\r\n    <div class="modal-header">\r\n        <button class="btn btn-default btn-subtle btn-square pull-right" type="button" ng-click="vm.close()">\r\n            <span class="glyphicon glyphicon-remove"></span>\r\n        </button>\r\n        <h3 class="modal-title">History Details {{vm.ChangeId}} of {{vm.entityId}}</h3>\r\n    </div>\r\n    <div class="modal-body">\r\n        <h1>todo</h1>\r\n        <table class="table table-striped table-hover">\r\n            <thead>\r\n            <tr>\r\n                <th>Field</th>\r\n                <th>Language</th>\r\n                <th>Value</th>\r\n                <th>SharedWith</th>\r\n            </tr>\r\n            </thead>\r\n            <tbody>\r\n            <tr ng-repeat="item in vm.items | orderBy:SysCreatedDate:reverse">\r\n                <td>{{item.Field}}</td>\r\n                <td>{{item.Language}}</td>\r\n                <td>{{item.Value}}</td>\r\n                <td>{{item.SharedWith}}</td>\r\n\r\n            </tr>\r\n            <tr ng-if="!vm.items.length">\r\n                <td colspan="100">No History</td>\r\n            </tr>\r\n            </tbody>\r\n        </table>\r\n\r\n        <button class="btn btn-primary pull-right" type="button" ng-click="vm.restore()">\r\n            <span class="glyphicon glyphicon-ok">todo restore</span>\r\n        </button>    </div>\r\n\r\n</div>'),e.put("content-items/history.html",'<div>\r\n    <div class="modal-header">\r\n        <button class="btn btn-default btn-square btn-subtle pull-right" type="button" ng-click="vm.close()">\r\n            <span class="glyphicon glyphicon-remove"></span>\r\n        </button>\r\n        <h3 class="modal-title">{{ "Content.History.Title" | translate:\'{ id:vm.entityId }\' }}History of {{vm.entityId}}</h3>\r\n    </div>\r\n    <div class="modal-body">\r\n\r\n        <table class="table table-striped table-hover">\r\n            <thead>\r\n            <tr>\r\n                <th translate="Content.History.Table.Id"></th>\r\n                <th translate="Content.History.Table.When"></th>\r\n                <th translate="Content.History.Table.User"></th>\r\n                <th translate="Content.History.Table.Action"></th>\r\n            </tr>\r\n            </thead>\r\n            <tbody>\r\n            <tr ng-repeat="item in vm.items | orderBy:SysCreatedDate:reverse">\r\n                <td><span uib-tooltip="ChangeId: {{item.ChangeId}}">{{item.VirtualVersion}}</span></td>\r\n                <td>{{item.SysCreatedDate.replace("T", " ")}}</td>\r\n                <td>{{item.User}}</td>\r\n                <td>\r\n                    <button type="button" class="btn btn-xs" ng-click="vm.details(item)">\r\n                        <span class="glyphicon glyphicon-search"></span>\r\n                    </button>\r\n                </td>\r\n            </tr>\r\n                <tr ng-if="!vm.items.length">\r\n                    <td colspan="100" translate="General.Messages.NothingFound"></td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n    </div>\r\n\r\n</div>'),e.put("content-types/content-types-edit.html",'<div ng-click="vm.debug.autoEnableAsNeeded($event)">\r\n    <div class="modal-header">\r\n        <button class="btn btn-default btn-square btn-subtle pull-right" type="button" ng-click="vm.close()"><i icon="remove"></i></button>\r\n        <h3 class="modal-title" translate="ContentTypeEdit.Title"></h3>\r\n    </div>\r\n\r\n    <div class="modal-body">\r\n        {{ "ContentTypeEdit.Name" | translate }}: <br />\r\n        <input ng-model="vm.item.Name" class="input-lg" />\r\n        <br />\r\n        {{ "ContentTypeEdit.Description" | translate }}: <br />\r\n        <input ng-model="vm.item.Description" class="input-lg"/><br/>\r\n\r\n        <div>\r\n            {{ "ContentTypeEdit.Scope" | translate }}: <br />\r\n            <span ng-if="vm.debug.on">\r\n                <div class="alert alert-danger">the scope should almost never be changed - <a href="http://2sxc.org/help?tag=scope" _target="_blank">see help</a></div>\r\n            </span>\r\n            <input ng-disabled="!vm.debug.on" ng-model="vm.item.Scope" class="input-lg" />\r\n        </div>\r\n\r\n        <div ng-if="vm.debug.on" class="alert-danger">\r\n            <h3>Static Name</h3>\r\n            <input type="checkbox" class="input-lg" ng-model="vm.item.ChangeStaticName"/> Really edit StaticName??? - this is usually a very bad idea\r\n            <br/>\r\n            <input ng-model="vm.item.NewStaticName" ng-disabled="!vm.item.ChangeStaticName" class="input-lg"/>\r\n        </div>\r\n        <div ng-if="vm.debug.on" class="alert-danger">\r\n            <h3>Shared Content Type (Ghost)</h3>\r\n            <div>Note: this can\'t be edited in the UI, for now if you really know what you\'re doing, do it in the DB</div>\r\n            <div>Uses Type Definition of: {{vm.item.SharedDefId}}</div> \r\n        </div>\r\n    </div>\r\n    <div class="modal-footer">\r\n        <button class="btn btn-primary btn-square pull-left btn-lg" type="button" ng-click="vm.ok()"><i icon="ok"></i></button>\r\n        <show-debug-availability class="pull-right" style="margin-top: 20px;"></show-debug-availability>\r\n    </div>\r\n</div>'),e.put("content-types/content-types-field-edit.html",'<div class="modal-header">\r\n    <button icon="remove" class="btn btn-default btn-square btn-subtle pull-right" type="button" ng-click="vm.close()"></button>\r\n    <h3 class="modal-title" translate="Fields.TitleEdit"></h3>\r\n</div>\r\n<div class="modal-body">\r\n    <table class="table table-hover table-manage-eav">\r\n        <thead>\r\n        <tr>\r\n            <th translate="Fields.Table.Name" style="width: 33%"></th>\r\n            <th translate="Fields.Table.DataType" style="width: 33%">Data Type</th>\r\n            <th translate="Fields.Table.InputType" style="width: 33%">Input Type</th>\r\n        </tr>\r\n        </thead>\r\n        <tbody>\r\n        <tr ng-repeat="item in vm.items">\r\n            <td>\r\n                <input ng-model="item.StaticName" ng-required="true" class="input-lg" style="width: 100%" disabled="disabled"/>\r\n            </td>\r\n            <td>\r\n                <input ng-model="item.Type" disabled="disabled" class="input-lg" style="width: 100%"/>\r\n            </td>\r\n            <td>\r\n                <select class="input-lg" ng-model="item.InputType" style="width: 100%"\r\n                        uib-tooltip="{{ (vm.allInputTypes | filter: { inputType: item.InputType})[0].description }}"\r\n                        ng-options="o.inputType as o.label for o in vm.allInputTypes | filter: {dataType: item.Type.toLowerCase() } ">\r\n                </select>\r\n\r\n            </td>\r\n        </tr>\r\n        </tbody>\r\n    </table>\r\n</div>\r\n<div class="modal-footer">\r\n    <button icon="ok" class="btn btn-lg btn-primary btn-square pull-left" type="button" ng-click="vm.ok()"></button>\r\n</div>'),e.put("content-types/content-types-fields-add.html",'<div class="modal-header">\r\n    <button icon="remove" class="btn btn-default btn-square btn-subtle pull-right" type="button" ng-click="vm.close()"></button>\r\n    <h3 class="modal-title" translate="Fields.TitleEdit"></h3>\r\n</div>\r\n<div class="modal-body">\r\n    <table class="table table-hover table-manage-eav">\r\n        <thead>\r\n        <tr>\r\n            <th translate="Fields.Table.Name" style="width: 33%"></th>\r\n            <th translate="Fields.Table.DataType" style="width: 33%">Data Type</th>\r\n            <th translate="Fields.Table.InputType" style="width: 33%">Input Type</th>\r\n        </tr>\r\n        </thead>\r\n        <tbody>\r\n        <tr ng-repeat="item in vm.items">\r\n            <td>\r\n                <input ng-model="item.StaticName" ng-required="true" class="input-lg" style="width: 100%"/>\r\n            </td>\r\n            <td>\r\n                <select class="input-lg" ng-model="item.Type" style="width: 100%"\r\n                        uib-tooltip="{{ \'DataType.\' + item.Type + \'.Explanation\' | translate }}"\r\n                        ng-options="o as \'DataType.\' + o + \'.Choice\' | translate for o in vm.types | orderBy: \'toString()\' "\r\n                        ng-change="vm.resetSubTypes(item)">\r\n                    <option>-- select --</option>\r\n                </select>\r\n            </td>\r\n            <td>\r\n                <select class="input-lg" ng-model="item.InputType" style="width: 100%"\r\n                        uib-tooltip="{{ (vm.allInputTypes | filter: { inputType: item.InputType})[0].description }}"\r\n                        ng-options="o.inputType as o.label for o in vm.allInputTypes | filter: {dataType: item.Type.toLowerCase() } ">\r\n                </select>\r\n\r\n            </td>\r\n        </tr>\r\n        </tbody>\r\n    </table>\r\n</div>\r\n<div class="modal-footer">\r\n    <button icon="ok" class="btn btn-lg btn-primary btn-square pull-left" type="button" ng-click="vm.ok()"></button>\r\n</div>'),e.put("content-types/content-types-fields.html",'<div>\r\n\r\n    <div class="modal-header">\r\n        <button class="btn btn-default btn-subtle btn-square pull-right" type="button" ng-click="vm.close()"><i icon="remove"></i></button>\r\n        <h3 class="modal-title" translate="Fields.Title"></h3>\r\n    </div>\r\n    <div class="modal-body">\r\n        <button icon="plus" ng-click="vm.add()" class="btn btn-primary btn-square"></button>\r\n\r\n        <!-- Table of content types for editing -->\r\n        <table ui-tree="vm.treeOptions" data-drag-enabled="vm.dragEnabled" ui-tree-nodes ng-model="vm.items" class="table table-hover table-manage-eav eav-admin-field-list">\r\n            <thead>\r\n                <tr>\r\n                    <th class="mini-btn-1"></th>\r\n                    <th translate="Fields.Table.Title" class="mini-btn-1"></th>\r\n                    <th translate="Fields.Table.Name" style="width: 35%"></th>\r\n                    <th translate="Fields.Table.DataType" style="width: 20%"></th>\r\n                    <th translate="Fields.Table.InputType" style="width: 20%"></th>\r\n                    <th translate="Fields.Table.Label" style="width: 30%"></th>\r\n                    <th translate="Fields.Table.Notes" style="width: 50%"></th>\r\n                    <!--<th translate="Fields.Table.Sort" class="mini-btn-2"></th>-->\r\n                    <th translate="Fields.Table.Action" class="mini-btn-2"></th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <tr ng-repeat="item in vm.items track by $id(item)" ui-tree-node class="clickable-row" ng-click="vm.createOrEditMetadata(item, item.Type)" ng-class="[ \'type-\' + item.Type.toLowerCase(), \'subtype-\' + item.InputType.substring(item.InputType.indexOf(\'-\') + 1, 100)]">\r\n                    <td ui-tree-handle><i class="glyphicon glyphicon-sort"></i></td>\r\n                    <td stop-event="click">\r\n                        <button type="button" class="btn btn-xs btn-square" ng-style="(item.IsTitle ? \'\' : \'color: transparent !important\')" ng-click="vm.setTitle(item)">\r\n                            <i icon="{{item.IsTitle ? \'star\' : \'star-empty\'}}"></i>\r\n                        </button>\r\n                    </td>\r\n                    <td class="clickable"><span uib-tooltip="{{ \'Id: \' + item.Id}}">{{item.StaticName}}</span></td>\r\n                    <td class="text-nowrap clickable">\r\n                        {{item.Type}}\r\n                    </td>\r\n                    <td class="text-nowrap InputType" stop-event="click">\r\n                        <span class="clickable" uib-tooltip="{{ vm.inputTypeTooltip(item.InputType) }}" ng-click="vm.edit(item)">\r\n                            <i icon="pencil"></i>\r\n                            {{item.InputType.substring(item.InputType.indexOf(\'-\') + 1, 100)}}\r\n                        </span>\r\n                    </td>\r\n                    <td class="text-nowrap clickable">\r\n                        {{item.Metadata.All.Name}}\r\n                    </td>\r\n                    <!--<td>-</td>-->\r\n                    <td class="text-nowrap clickable">\r\n                        <div class="hide-overflow-text">\r\n                            {{item.Metadata.All.Notes}}\r\n                        </div>\r\n                    </td>\r\n\r\n                    <!--<td class="text-nowrap" stop-event="click">\r\n                        <button icon="arrow-up" type="button" class="btn btn-xs btn-square" ng-disabled="$first" ng-click="vm.moveUp(item)"></button>\r\n                        <button icon="arrow-down" type="button" class="btn btn-xs btn-square" ng-disabled="$last" ng-click="vm.moveDown(item)"></button>\r\n                    </td>-->\r\n                    <td stop-event="click">\r\n                        <button icon="cog" type="button" class="btn btn-xs btn-square" ng-click="vm.rename(item)"></button>\r\n                        <button icon="remove" type="button" class="btn btn-xs btn-square" ng-click="vm.tryToDelete(item)"></button>\r\n                    </td>\r\n                </tr>\r\n                <tr ng-if="!vm.items.length">\r\n                    <td colspan="100" translate="General.Messages.NothingFound"></td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n\r\n        <!--Ordered  {{vm.orderList()}} Test-->\r\n    </div>\r\n\r\n\r\n</div>'),e.put("content-types/content-types.html",'<div ng-controller="List as vm" ng-click="vm.debug.autoEnableAsNeeded($event)">\r\n    <div class="modal-header">\r\n        <h3 class="modal-title" translate="ContentTypes.Title"></h3>\r\n    </div>\r\n    <div class="modal-body">\r\n        <!-- Buttons on top -->\r\n        <button title="{{ \'General.Buttons.Add\' | translate }}" type="button" class="btn btn-primary btn-square" ng-click="vm.edit()"><i icon="plus"></i></button>\r\n\r\n\r\n        <span class="btn-group" ng-if="vm.debug.on">\r\n            <button title="{{ \'General.Buttons.Refresh\' | translate }}" type="button" class="btn btn-warning btn-square" ng-click="vm.refresh()"><i icon="repeat"></i></button>\r\n            <button title="todo" type="button" class="btn btn-warning btn-icon" ng-click="vm.createGhost()"><i class="eav-icon-ghost"></i></button>\r\n            <button title="{{ \'ContentTypes.Buttons.ChangeScope\' | translate }}" type="button" class="btn btn-warning btn-square" ng-click="vm.changeScope()"><i icon="record"></i></button>\r\n            <button title="{{ \'General.Buttons.System\' | translate }}" type="button" class="btn btn-warning btn-square" ng-click="vm.liveEval()"><i icon="flash"></i></button>\r\n        </span>\r\n        <!-- Table of content types for editing -->\r\n        <table class="table table-hover" style="table-layout: fixed; width: 100%">\r\n            <thead>\r\n            <tr>\r\n                <!--<th translate="ContentTypes.TypesTable.Items" class="col-id"></th>-->\r\n                <th translate="ContentTypes.TypesTable.Name" style="width: 50%"></th>\r\n                <th class="mini-btn-1"></th>\r\n                <th translate="ContentTypes.TypesTable.Description" style="width: 50%"></th>\r\n                <th translate="ContentTypes.TypesTable.Fields" class="mini-btn-2"></th>\r\n                <th translate="ContentTypes.TypesTable.Actions" class="mini-btn-5"></th>\r\n                <th class="mini-btn-1"> </th>\r\n            </tr>\r\n            </thead>\r\n            <tbody>\r\n            <tr ng-if="vm.items.isLoaded" ng-repeat="item in vm.items | orderBy:\'Name\'" class="clickable-row" ng-click="vm.editItems(item)">\r\n                <!--<td style="text-align: center" class="clickable"> {{item.Items}} </td>-->\r\n                <td class="clickable">\r\n                    <span class="text-nowrap hide-overflow-text" style="max-width: 400px" uib-tooltip="{{item.Label}} ({{item.Name}})">{{item.Label}} <span ng-if="item.Name != item.Label">({{item.Name}})</span></span>\r\n                </td>\r\n                <td class="clickable" style="text-align: right">\r\n                    <div class="badge pull-right badge-primary hover-pair" stop-event="click" ng-click="vm.addItem(item.StaticName)"><span class="hover-default">{{item.Items}}</span><span class="hover-hover eav-icon-plus"></span></div></td>\r\n                <td class="clickable">\r\n                    <div class="text-nowrap hide-overflow-text" style="max-width: 500px" uib-tooltip="{{item.Description}}">{{item.Description}}</div>\r\n                </td>\r\n                <td stop-event="click">\r\n                    <button ng-if="!item.UsesSharedDef" type="button" class="btn btn-xs" style="width: 60px" ng-click="vm.editFields(item)">\r\n                        <i class="eav-icon-fields"></i>&nbsp;<span style="width: 22px; text-align: right">{{item.Fields}}</span>\r\n                    </button>\r\n                    <button ng-if="item.UsesSharedDef" uib-tooltip="{{ \'ContentTypes.Messages.SharedDefinition\' | translate:item }}" type="button" class="btn btn-default btn-xs" style="width: 60px">\r\n                        <i class="eav-icon-ghost"></i>&nbsp;<span style="width: 22px; text-align: right">{{item.Fields}}</span>\r\n                    </button>\r\n                </td>\r\n\r\n                <td class="text-nowrap" stop-event="click">\r\n                    <span class="btn-group">\r\n                        <button uib-tooltip="{{ \'General.Buttons.Rename\' | translate }} - {{  \'ContentTypes.Messages.Type\' + (item.UsesSharedDef ? \'Shared\' : \'Own\')  | translate:item }}" type="button" class="btn btn-xs btn-square" ng-click="vm.edit(item)">\r\n                            <i icon="heart{{ (item.UsesSharedDef ? \'-empty\' : \'\') }}"></i>\r\n                        </button>\r\n                        <button uib-tooltip="{{ \'General.Buttons.Metadata\' | translate }}" type="button" class="btn btn-xs btn-square" ng-click="vm.createOrEditMetadata(item)">\r\n                            <i class="eav-icon-tag"></i>\r\n                        </button>\r\n                        <button uib-tooltip="{{ \'ContentTypes.Buttons.Export\' | translate }}" type="button" class="btn btn-xs btn-square" ng-click="vm.openExport(item)">\r\n                            <i icon="export"></i>\r\n                        </button>\r\n                        <button uib-tooltip="{{ \'ContentTypes.Buttons.Import\' | translate }}" type="button" class="btn btn-xs btn-square" ng-click="vm.openImport(item)">\r\n                            <i icon="import"></i>\r\n                        </button>\r\n                        <button type="button" class="btn btn-xs btn-square" ng-click="vm.permissions(item)" ng-if="vm.isGuid(item.StaticName)">\r\n                            <i icon="user"></i>\r\n                        </button>\r\n                    </span>\r\n                </td>\r\n                <td stop-event="click">\r\n                    <button icon="remove" type="button" class="btn btn-xs" ng-click="vm.tryToDelete(item)"></button>\r\n                </td>\r\n            </tr>\r\n            <tr ng-if="!vm.items.length">\r\n                <td colspan="100">{{ \'General.Messages.Loading\' | translate }} / {{ \'General.Messages.NothingFound\' | translate }}</td>\r\n            </tr>\r\n            </tbody>\r\n        </table>\r\n        <show-debug-availability class="pull-right"></show-debug-availability>\r\n    </div>\r\n    <div ng-if="vm.debug.on">\r\n\r\n        <h3>Notes / Debug / ToDo</h3>\r\n        <ol>\r\n            <li>get validators to work on all dialogs</li>\r\n        </ol>\r\n    </div>\r\n</div>\r\n'),e.put("permissions/permissions.html",'    <div class="modal-header">\r\n        <button class="btn btn-default btn-square pull-right" type="button" ng-click="vm.close()"><i icon="remove"></i></button>\r\n        <h3 class="modal-title" translate="Permissions.Title"></h3>\r\n    </div>\r\n    <div class="modal-body">\r\n\r\n        <button type="button" class="btn btn-primar btn-square" ng-click="vm.add()"><i icon="plus"></i></button>\r\n        <button ng-if="vm.debug.on" type="button" class="btn btn-square" ng-click="vm.refresh()"><i icon="repeat"></i></button>\r\n\r\n        <table class="table table-striped table-hover table-manage-eav">\r\n            <thead>\r\n            <tr>\r\n                <th translate="Permissions.Table.Id" style="width: 60px"></th>\r\n                <th translate="Permissions.Table.Name" style="width: 33%"></th>\r\n                <th translate="Permissions.Table.Condition" style="width: 33%"></th>\r\n                <th translate="Permissions.Table.Grant" style="width: 33%"></th>\r\n                <th translate="Permissions.Table.Actions" style="width: 40px"></th>\r\n            </tr>\r\n            </thead>\r\n            <tbody>\r\n            <tr ng-repeat="item in vm.items | orderBy:\'Title\'" class="clickable-row" ng-click="vm.edit(item)">\r\n                <td class="clickable">{{item.Id}}</td>\r\n                <td class="clickable">{{item.Title}}</td>\r\n                <td class="clickable">{{item.Condition}}</td>\r\n                <td class="clickable">{{item.Grant}}</td>\r\n                <td class="text-nowrap" stop-event="click">\r\n                    <button icon="remove" type="button" class="btn btn-xs btn-square" ng-click="vm.tryToDelete(item)"></button>\r\n                </td>\r\n            </tr>\r\n            <tr ng-if="!vm.items.length">\r\n                <td colspan="100" translate="General.Messages.NothingFound"></td>\r\n            </tr>\r\n            </tbody>\r\n        </table>\r\n    </div>'),e.put("pipelines/pipeline-designer.html",'<div class="ng-cloak">\r\n    <div ng-controller="PipelineDesignerController as vm" ng-click="vm.debug.autoEnableAsNeeded($event)">\r\n        <div id="pipelineContainer">\r\n            <div ng-repeat="dataSource in pipelineData.DataSources"\r\n                 datasource\r\n                 guid="{{dataSource.EntityGuid}}"\r\n                 id="dataSource_{{dataSource.EntityGuid}}"\r\n                 class="dataSource"\r\n                 ng-attr-style="top: {{dataSource.VisualDesignerData.Top}}px; left: {{dataSource.VisualDesignerData.Left}}px">\r\n                <div class="configure" ng-click="configureDataSource(dataSource)" title="Configure this DataSource" ng-if="!dataSource.ReadOnly">\r\n                    <span class="glyphicon glyphicon-list-alt"></span>\r\n                </div>\r\n                <div class="name noselect" title="Click to edit the Name" ng-click="editName(dataSource)">{{dataSource.Name || \'(unnamed)\'}}</div><br />\r\n                <div class="description noselect" title="Click to edit the Description" ng-click="editDescription(dataSource)">{{dataSource.Description || \'(no description)\'}}</div><br />\r\n                <div class="typename" ng-attr-title="{{dataSource.PartAssemblyAndType}}">Type: {{dataSource.PartAssemblyAndType | typename: \'className\'}}</div>\r\n                <div class="ep" title="Drag a new Out-Connection from here" ng-if="!dataSource.ReadOnly">\r\n                    <span class="glyphicon glyphicon-plus-sign"></span>\r\n                </div>\r\n                <div class="delete glyphicon glyphicon-remove" title="Delete this DataSource" ng-click="remove($index)" ng-if="!dataSource.ReadOnly"></div>\r\n            </div>\r\n        </div>\r\n        <div class="actions panel panel-default">\r\n            <div class="panel-heading">\r\n                <span class="pull-left">Actions</span>\r\n                <a href="http://2sxc.org/help" class="btn btn-info btn-xs pull-right" target="_blank"><span class="glyphicon glyphicon-question-sign"></span> Help</a>\r\n            </div>\r\n            <div class="panel-body">\r\n                <div class="btn-group" role="group" style="width: 100%">\r\n                    <button type="button" class="btn btn-primary btn-block"\r\n                            title="Query the Data of this Pipeline. Note that it doesn\'t save changes - so if you have unexpected behaviour after rewiring - save first"\r\n                            ng-click="queryPipeline(save)"\r\n                            style="width: 65%">\r\n                        <span class="glyphicon glyphicon-play"></span> Query\r\n                    </button>\r\n                    <button type="button" class="btn btn-primary btn-block" title="Save & Query"\r\n                            ng-click="queryPipeline(true)"\r\n                            style="width: 35%; margin-top: 4px">\r\n                        <span icon="ok"></span> &amp;\r\n                        <span class="glyphicon glyphicon-play"></span>\r\n                    </button>\r\n                </div>\r\n\r\n                <select class="form-control" ng-model="addDataSourceType" ng-disabled="readOnly" ng-change="addDataSource()" ng-options="d.ClassName for d in pipelineData.InstalledDataSources | filter: {allowNew: \'!false\'} | orderBy: \'ClassName\'">\r\n                    <option value="">-- Add DataSource --</option>\r\n                </select>\r\n                <!--<button type="button" class="btn btn-default btn-sm" title="Clone this Pipeline with all DataSources and Configurations" ng-click="clonePipeline()" ng-disabled="!PipelineEntityId"><span class="glyphicon glyphicon-share-alt"></span> Clone</button>-->\r\n                <button type="button" class="btn btn-default btn-block" ng-click="editPipelineEntity()"><span class="glyphicon glyphicon-pencil"></span> Test Parameters</button>\r\n                <button type="button" class="btn btn-primary btn-block" ng-disabled="readOnly" ng-click="savePipeline()">\r\n                    <span icon="ok"></span> Save\r\n                </button>\r\n                <br/>\r\n\r\n                <!-- show warnings if detected -->\r\n                <div ng-if="vm.warnings.length">\r\n                    <div><strong>Warnings</strong></div>\r\n                    <ol>\r\n                        <li ng-repeat="warn in vm.warnings">{{warn}}</li>\r\n                    </ol>\r\n                    <br />\r\n                </div>\r\n                <br/>\r\n                <button type="button" class="btn btn-info btn-xs" ng-click="toggleEndpointOverlays()"><span class="glyphicon glyphicon-info-sign"></span> {{showEndpointOverlays ? \'Hide\' : \'Show\' }} Overlays</button>\r\n                <button type="button" class="btn btn-info btn-xs" ng-click="repaint()"><span class="glyphicon glyphicon-repeat"></span> Repaint</button>\r\n                <button type="button" class="btn btn-info btn-xs" ng-if="vm.debug.on" ng-click="toogleDebug()"><span class="glyphicon glyphicon-info-sign"></span> {{debug ? \'Hide\' : \'Show\'}} Debug Info</button>\r\n\r\n                <show-debug-availability class="pull-right"></show-debug-availability>\r\n            </div>\r\n        </div>\r\n        <toaster-container></toaster-container>\r\n        <pre ng-if="debug">{{pipelineData | json}}</pre>\r\n    </div>\r\n</div>\r\n'),e.put("pipelines/pipelines.html",'<div ng-click="vm.debug.autoEnableAsNeeded($event)">\r\n    <div class="modal-header">\r\n        <h3 class="modal-title" translate="Pipeline.Manage.Title"></h3>\r\n    </div>\r\n    <div class="modal-body ng-cloak">\r\n        <div translate="Pipeline.Manage.Intro"></div>\r\n        <div>\r\n            <button icon="plus" type="button" class="btn btn-primary btn-square" ng-click="vm.add()"></button>\r\n            <span class="btn-group" ng-if="vm.debug.on">\r\n                <button type="button" class="btn btn-warning btn-square" ng-click="vm.refresh()"><i icon="repeat"></i></button>\r\n                <button type="button" class="btn btn-warning btn-square" ng-click="vm.liveEval()"><i icon="flash"></i></button>\r\n            </span>\r\n            <table class="table table-hover table-manage-eav">\r\n                <thead>\r\n                <tr>\r\n                    <th translate="Pipeline.Manage.Table.Id" class="col-id"></th>\r\n                    <th translate="Pipeline.Manage.Table.Name"></th>\r\n                    <th translate="Pipeline.Manage.Table.Description"></th>\r\n                    <th translate="Pipeline.Manage.Table.Actions" class="mini-btn-4"></th>\r\n                </tr>\r\n                </thead>\r\n                <tbody>\r\n                <tr ng-repeat="pipeline in vm.pipelines | orderBy:\'Name\'" class="clickable-row" ng-click="vm.design(pipeline)">\r\n                    <td class="clickable">{{pipeline.Id}}</td>\r\n                    <td class="clickable">{{pipeline.Name}}</td>\r\n                    <td class="clickable">{{pipeline.Description}}</td>\r\n                    <td class="text-nowrap mini-btn-4" stop-event=\'click\'>\r\n                        <span class="btn-group">\r\n                            <button title="{{ \'General.Buttons.Edit\' | translate }}" class="btn btn-xs" ng-click="vm.edit(pipeline)"><i icon="cog"></i></button>\r\n                            <button title="{{ \'General.Buttons.Copy\' | translate }}" type="button" class="btn btn-xs" ng-click="vm.clone(pipeline)"><i icon="duplicate"></i></button>\r\n                            <button title="{{ \'General.Buttons.Permissions\' | translate }}" type="button" class="btn btn-xs" ng-click="vm.permissions(pipeline)"><i icon="user"></i></button>\r\n                        </span>\r\n                        <button title="{{ \'General.Buttons.Delete\' | translate }}" type="button" class="btn btn-xs" ng-click="vm.delete(pipeline)"><i icon="remove"></i></button>\r\n                    </td>\r\n                </tr>\r\n                <tr ng-if="!vm.pipelines.length">\r\n                    <td colspan="100" translate="General.Messages.NothingFound"></td>\r\n                </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n\r\n        <show-debug-availability class="pull-right"></show-debug-availability>\r\n    </div>\r\n\r\n</div>'),
e.put("pipelines/query-stats.html",'<div class="modal-header">\r\n    <button icon="remove" class="btn pull-right" type="button" ng-click="vm.close()"></button>\r\n    <h3 class="modal-title" translate="Pipeline.Stats.Title"></h3>\r\n</div>\r\n\r\n<div class="modal-body">\r\n    <div translate="Pipeline.Stats.Intro"></div>\r\n\r\n    <div>\r\n        <h3 translate="Pipeline.Stats.ParamTitle"></h3>\r\n        <div translate="Pipeline.Stats.ExecutedIn" translate-values="{ ms: vm.timeUsed, ticks: vm.ticksUsed }"></div>\r\n        <div>\r\n            <ul>\r\n                <li ng-repeat="param in vm.testParameters">{{param}}</li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n\r\n    <div>\r\n        <h3 translate="Pipeline.Stats.QueryTitle"></h3>\r\n        <pre>{{vm.result | json}}</pre>\r\n    </div>\r\n    <div>\r\n        <h3 translate="Pipeline.Stats.SourcesAndStreamsTitle"></h3>\r\n        <h4 translate="Pipeline.Stats.Sources.Title"></h4>\r\n        <table>\r\n            <tr>\r\n                <th translate="Pipeline.Stats.Sources.Guid"></th>\r\n                <th translate="Pipeline.Stats.Sources.Type"></th>\r\n                <th translate="Pipeline.Stats.Sources.Config"></th>\r\n            </tr>\r\n            <tr ng-repeat="s in vm.sources">\r\n                <td uib-tooltip="{{s}}"><pre>{{s.Guid.substring(0, 13)}}...</pre></td>\r\n                <td>{{s.Type}}</td>\r\n                <td uib-tooltip="{{s.Configuration}}">\r\n                    <ol>\r\n                        <li ng-repeat="(key, value) in s.Configuration"><b>{{key}}</b>=<em>{{value}}</em></li>\r\n                    </ol>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n\r\n        <h4 translate="Pipeline.Stats.Streams.Title"></h4>\r\n        <table>\r\n            <tr>\r\n                <th translate="Pipeline.Stats.Streams.Source"></th>\r\n                <th translate="Pipeline.Stats.Streams.Target"></th>\r\n                <th translate="Pipeline.Stats.Streams.Items"></th>\r\n                <th translate="Pipeline.Stats.Streams.Error"></th>\r\n            </tr>\r\n            <tr ng-repeat="sr in vm.streams">\r\n                <td><pre>{{sr.Source.substring(0, 13) + ":" + sr.SourceOut}}</pre></td>\r\n                <td><pre>{{sr.Target.substring(0, 13) + ":" + sr.TargetIn}}</pre></td>\r\n                <td><span>{{sr.Count}}</span></td>\r\n                <td><span>{{sr.Error}}</span></td>\r\n            </tr>\r\n        </table>\r\n\r\n    </div>\r\n</div>')}]);